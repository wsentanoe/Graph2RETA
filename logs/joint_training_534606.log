Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 1999,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.706 | lsd:0.895 | ed:1.182 | hr@1:0.601 | hr@2:0.827 | hr@3:0.876 | acc@1:0.601 | acc@2:0.53 | acc@3:0.475 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-07 12:14:19] INFO (nni/MainThread) Intermediate result: 0.7056101814912482  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.64	mae: 19.33	mape: 69.47%	acc@10: 37.04%	acc@20: 60.37%	acc@30: 78.89%	
[2023-12-07 12:14:19] INFO (nni/MainThread) Intermediate result: 24.639089203882417  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.754 | lsd:0.75 | ed:1.047 | hr@1:0.625 | hr@2:0.854 | hr@3:0.902 | acc@1:0.625 | acc@2:0.562 | acc@3:0.521 | Best krc: 0.706 | Best epoch: 0
best model saved
[2023-12-07 12:14:50] INFO (nni/MainThread) Intermediate result: 0.7538151776805034  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 22.85	mae: 17.92	mape: 93.87%	acc@10: 37.78%	acc@20: 63.7%	acc@30: 83.15%	
[2023-12-07 12:14:50] INFO (nni/MainThread) Intermediate result: 22.85199712508812  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.694 | ed:0.99 | hr@1:0.633 | hr@2:0.859 | hr@3:0.907 | acc@1:0.633 | acc@2:0.579 | acc@3:0.54 | Best krc: 0.754 | Best epoch: 1
best model saved
[2023-12-07 12:15:20] INFO (nni/MainThread) Intermediate result: 0.7662943615195474  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 23.75	mae: 18.4	mape: 113.45%	acc@10: 35.43%	acc@20: 63.7%	acc@30: 82.96%	
[2023-12-07 12:15:20] INFO (nni/MainThread) Intermediate result: 23.753779175932394  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.674 | ed:0.986 | hr@1:0.633 | hr@2:0.862 | hr@3:0.908 | acc@1:0.633 | acc@2:0.58 | acc@3:0.542 | Best krc: 0.766 | Best epoch: 2
best model saved
[2023-12-07 12:15:50] INFO (nni/MainThread) Intermediate result: 0.7721162550546024  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 23.28	mae: 17.98	mape: 118.14%	acc@10: 36.11%	acc@20: 65.74%	acc@30: 83.15%	
[2023-12-07 12:15:50] INFO (nni/MainThread) Intermediate result: 23.280594847878547  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.754 | lsd:0.721 | ed:1.033 | hr@1:0.627 | hr@2:0.858 | hr@3:0.907 | acc@1:0.627 | acc@2:0.571 | acc@3:0.526 | Best krc: 0.772 | Best epoch: 3
[2023-12-07 12:16:20] INFO (nni/MainThread) Intermediate result: 0.7542847788497111  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 23.04	mae: 17.82	mape: 119.94%	acc@10: 36.37%	acc@20: 66.3%	acc@30: 83.33%	
[2023-12-07 12:16:20] INFO (nni/MainThread) Intermediate result: 23.037576575507906  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.676 | ed:1.005 | hr@1:0.627 | hr@2:0.862 | hr@3:0.911 | acc@1:0.627 | acc@2:0.572 | acc@3:0.533 | Best krc: 0.772 | Best epoch: 3
[2023-12-07 12:16:49] INFO (nni/MainThread) Intermediate result: 0.7630727859324276  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 22.38	mae: 17.42	mape: 119.51%	acc@10: 36.67%	acc@20: 66.85%	acc@30: 84.2%	
[2023-12-07 12:16:49] INFO (nni/MainThread) Intermediate result: 22.380580736765282  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.673 | ed:0.992 | hr@1:0.639 | hr@2:0.863 | hr@3:0.909 | acc@1:0.639 | acc@2:0.584 | acc@3:0.541 | Best krc: 0.772 | Best epoch: 3
[2023-12-07 12:17:18] INFO (nni/MainThread) Intermediate result: 0.7688331383915118  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 21.89	mae: 17.06	mape: 118.36%	acc@10: 37.25%	acc@20: 67.88%	acc@30: 84.6%	
[2023-12-07 12:17:18] INFO (nni/MainThread) Intermediate result: 21.89381532248296  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.674 | ed:1.01 | hr@1:0.632 | hr@2:0.863 | hr@3:0.91 | acc@1:0.632 | acc@2:0.574 | acc@3:0.534 | Best krc: 0.772 | Best epoch: 3
[2023-12-07 12:17:48] INFO (nni/MainThread) Intermediate result: 0.7646605036285841  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 21.51	mae: 16.8	mape: 117.68%	acc@10: 37.36%	acc@20: 68.06%	acc@30: 85.19%	
[2023-12-07 12:17:48] INFO (nni/MainThread) Intermediate result: 21.511545558055104  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.689 | ed:0.989 | hr@1:0.639 | hr@2:0.861 | hr@3:0.907 | acc@1:0.639 | acc@2:0.578 | acc@3:0.536 | Best krc: 0.772 | Best epoch: 3
[2023-12-07 12:18:17] INFO (nni/MainThread) Intermediate result: 0.7683864015302581  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 21.21	mae: 16.6	mape: 117.14%	acc@10: 37.57%	acc@20: 68.44%	acc@30: 85.72%	
[2023-12-07 12:18:17] INFO (nni/MainThread) Intermediate result: 21.209433878942214  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.708 | ed:1.035 | hr@1:0.625 | hr@2:0.859 | hr@3:0.904 | acc@1:0.625 | acc@2:0.57 | acc@3:0.523 | Best krc: 0.772 | Best epoch: 3
[2023-12-07 12:18:47] INFO (nni/MainThread) Intermediate result: 0.7585480227718969  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 20.94	mae: 16.47	mape: 117.09%	acc@10: 37.44%	acc@20: 68.56%	acc@30: 86.41%	
[2023-12-07 12:18:47] INFO (nni/MainThread) Intermediate result: 20.943256887721834  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.718 | ed:1.004 | hr@1:0.638 | hr@2:0.862 | hr@3:0.905 | acc@1:0.638 | acc@2:0.581 | acc@3:0.539 | Best krc: 0.772 | Best epoch: 3
[2023-12-07 12:19:17] INFO (nni/MainThread) Intermediate result: 0.7653135919773435  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 20.59	mae: 16.23	mape: 115.9%	acc@10: 37.88%	acc@20: 69.19%	acc@30: 87.1%	
[2023-12-07 12:19:17] INFO (nni/MainThread) Intermediate result: 20.58626074736949  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.686 | ed:0.993 | hr@1:0.634 | hr@2:0.863 | hr@3:0.909 | acc@1:0.634 | acc@2:0.578 | acc@3:0.537 | Best krc: 0.772 | Best epoch: 3
[2023-12-07 12:19:47] INFO (nni/MainThread) Intermediate result: 0.7662676567792441  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 20.27	mae: 15.99	mape: 114.46%	acc@10: 38.61%	acc@20: 69.69%	acc@30: 87.65%	
[2023-12-07 12:19:47] INFO (nni/MainThread) Intermediate result: 20.27140981150172  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.755 | lsd:0.715 | ed:1.034 | hr@1:0.624 | hr@2:0.854 | hr@3:0.903 | acc@1:0.624 | acc@2:0.563 | acc@3:0.522 | Best krc: 0.772 | Best epoch: 3
[2023-12-07 12:20:17] INFO (nni/MainThread) Intermediate result: 0.7553324639376235  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 20.08	mae: 15.87	mape: 114.18%	acc@10: 38.58%	acc@20: 69.89%	acc@30: 88.03%	
[2023-12-07 12:20:17] INFO (nni/MainThread) Intermediate result: 20.083881182795196  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.673 | ed:0.97 | hr@1:0.641 | hr@2:0.864 | hr@3:0.911 | acc@1:0.641 | acc@2:0.583 | acc@3:0.548 | Best krc: 0.772 | Best epoch: 3
[2023-12-07 12:20:46] INFO (nni/MainThread) Intermediate result: 0.7700915311671761  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 19.9	mae: 15.78	mape: 114.02%	acc@10: 38.49%	acc@20: 70.0%	acc@30: 88.47%	
[2023-12-07 12:20:46] INFO (nni/MainThread) Intermediate result: 19.900827016511364  (Index 27)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701947628.91286731701947628.912887
best model loaded !!!
krc:0.76 | lsd:0.529 | ed:1.029 | hr@1:0.639 | hr@2:0.9 | hr@3:0.931 | acc@1:0.639 | acc@2:0.593 | acc@3:0.536 |

-------------------------------------------------------------
Best epoch for G2R:  3
Best epoch for ETPA:  13
graph2route_pd Evaluation in test: krc:0.76 | lsd:0.529 | ed:1.029 | hr@1:0.639 | hr@2:0.9 | hr@3:0.931 | acc@1:0.639 | acc@2:0.593 | acc@3:0.536 |
RankPETA Evaluation in test: rmse: 18.26	mae: 15.27	mape: 136.8%	acc@10: 35.86%	acc@20: 71.31%	acc@30: 93.67%	
