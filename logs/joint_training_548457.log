Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 1999,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.684 | lsd:0.981 | ed:1.247 | hr@1:0.584 | hr@2:0.819 | hr@3:0.867 | acc@1:0.584 | acc@2:0.511 | acc@3:0.452 | Best krc: -1 | Best epoch: -1
best model saved
[2024-01-10 06:52:58] INFO (nni/MainThread) Intermediate result: 0.6844203541361389  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.18	mae: 18.93	mape: 69.44%	acc@10: 38.89%	acc@20: 61.48%	acc@30: 78.89%	
[2024-01-10 06:52:58] INFO (nni/MainThread) Intermediate result: 24.181726993954676  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.684 | ed:1.034 | hr@1:0.624 | hr@2:0.859 | hr@3:0.91 | acc@1:0.624 | acc@2:0.564 | acc@3:0.526 | Best krc: 0.684 | Best epoch: 0
best model saved
[2024-01-10 06:54:50] INFO (nni/MainThread) Intermediate result: 0.7633889768913816  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 21.62	mae: 16.74	mape: 80.99%	acc@10: 42.96%	acc@20: 66.67%	acc@30: 84.63%	
[2024-01-10 06:54:50] INFO (nni/MainThread) Intermediate result: 21.61766749972852  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.681 | ed:1.002 | hr@1:0.634 | hr@2:0.86 | hr@3:0.911 | acc@1:0.634 | acc@2:0.573 | acc@3:0.539 | Best krc: 0.763 | Best epoch: 1
best model saved
[2024-01-10 06:56:40] INFO (nni/MainThread) Intermediate result: 0.7661469082020022  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 21.72	mae: 16.74	mape: 95.62%	acc@10: 42.47%	acc@20: 67.16%	acc@30: 84.81%	
[2024-01-10 06:56:40] INFO (nni/MainThread) Intermediate result: 21.72413249650995  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.699 | ed:1.013 | hr@1:0.633 | hr@2:0.854 | hr@3:0.904 | acc@1:0.633 | acc@2:0.571 | acc@3:0.526 | Best krc: 0.766 | Best epoch: 2
[2024-01-10 06:58:32] INFO (nni/MainThread) Intermediate result: 0.7625231873504721  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 21.73	mae: 16.78	mape: 103.67%	acc@10: 41.11%	acc@20: 67.59%	acc@30: 84.72%	
[2024-01-10 06:58:32] INFO (nni/MainThread) Intermediate result: 21.733833799849904  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.672 | ed:1.008 | hr@1:0.637 | hr@2:0.86 | hr@3:0.91 | acc@1:0.637 | acc@2:0.572 | acc@3:0.537 | Best krc: 0.766 | Best epoch: 2
[2024-01-10 07:00:23] INFO (nni/MainThread) Intermediate result: 0.7654303930211231  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 20.58	mae: 15.94	mape: 100.75%	acc@10: 42.37%	acc@20: 70.22%	acc@30: 86.3%	
[2024-01-10 07:00:23] INFO (nni/MainThread) Intermediate result: 20.584503012930487  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.68 | ed:0.988 | hr@1:0.64 | hr@2:0.861 | hr@3:0.914 | acc@1:0.64 | acc@2:0.577 | acc@3:0.547 | Best krc: 0.766 | Best epoch: 2
best model saved
[2024-01-10 07:02:15] INFO (nni/MainThread) Intermediate result: 0.7704953363370505  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 19.78	mae: 15.36	mape: 99.25%	acc@10: 43.58%	acc@20: 71.85%	acc@30: 87.59%	
[2024-01-10 07:02:15] INFO (nni/MainThread) Intermediate result: 19.78205408344568  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.671 | ed:0.955 | hr@1:0.657 | hr@2:0.863 | hr@3:0.913 | acc@1:0.657 | acc@2:0.592 | acc@3:0.561 | Best krc: 0.77 | Best epoch: 5
best model saved
[2024-01-10 07:04:07] INFO (nni/MainThread) Intermediate result: 0.7816994843404986  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 19.07	mae: 14.86	mape: 97.24%	acc@10: 44.13%	acc@20: 73.12%	acc@30: 88.84%	
[2024-01-10 07:04:07] INFO (nni/MainThread) Intermediate result: 19.069258348965175  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.789 | lsd:0.637 | ed:0.948 | hr@1:0.674 | hr@2:0.868 | hr@3:0.913 | acc@1:0.674 | acc@2:0.61 | acc@3:0.572 | Best krc: 0.782 | Best epoch: 6
best model saved
[2024-01-10 07:05:58] INFO (nni/MainThread) Intermediate result: 0.7892548770117638  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 18.63	mae: 14.57	mape: 96.74%	acc@10: 44.49%	acc@20: 73.66%	acc@30: 89.72%	
[2024-01-10 07:05:58] INFO (nni/MainThread) Intermediate result: 18.62827266632994  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.788 | lsd:0.652 | ed:0.934 | hr@1:0.682 | hr@2:0.862 | hr@3:0.913 | acc@1:0.682 | acc@2:0.614 | acc@3:0.575 | Best krc: 0.789 | Best epoch: 7
[2024-01-10 07:07:49] INFO (nni/MainThread) Intermediate result: 0.7882548778045061  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.44	mae: 14.5	mape: 97.78%	acc@10: 43.99%	acc@20: 73.58%	acc@30: 90.12%	
[2024-01-10 07:07:49] INFO (nni/MainThread) Intermediate result: 18.442919838138035  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.785 | lsd:0.679 | ed:0.951 | hr@1:0.67 | hr@2:0.863 | hr@3:0.912 | acc@1:0.67 | acc@2:0.61 | acc@3:0.572 | Best krc: 0.789 | Best epoch: 7
[2024-01-10 07:09:40] INFO (nni/MainThread) Intermediate result: 0.7854779915383326  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.13	mae: 14.25	mape: 96.77%	acc@10: 44.85%	acc@20: 74.37%	acc@30: 90.56%	
[2024-01-10 07:09:40] INFO (nni/MainThread) Intermediate result: 18.12700855650572  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.797 | lsd:0.668 | ed:0.919 | hr@1:0.693 | hr@2:0.862 | hr@3:0.913 | acc@1:0.693 | acc@2:0.624 | acc@3:0.586 | Best krc: 0.789 | Best epoch: 7
best model saved
[2024-01-10 07:11:33] INFO (nni/MainThread) Intermediate result: 0.7968630601774458  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 17.84	mae: 14.09	mape: 96.44%	acc@10: 44.65%	acc@20: 74.88%	acc@30: 91.18%	
[2024-01-10 07:11:33] INFO (nni/MainThread) Intermediate result: 17.843566401953353  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.795 | lsd:0.634 | ed:0.929 | hr@1:0.686 | hr@2:0.865 | hr@3:0.919 | acc@1:0.686 | acc@2:0.617 | acc@3:0.585 | Best krc: 0.797 | Best epoch: 10
[2024-01-10 07:13:25] INFO (nni/MainThread) Intermediate result: 0.7950637229780212  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.54	mae: 13.85	mape: 95.07%	acc@10: 45.52%	acc@20: 75.65%	acc@30: 91.57%	
[2024-01-10 07:13:25] INFO (nni/MainThread) Intermediate result: 17.53638609758446  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.804 | lsd:0.614 | ed:0.9 | hr@1:0.704 | hr@2:0.867 | hr@3:0.921 | acc@1:0.704 | acc@2:0.633 | acc@3:0.597 | Best krc: 0.797 | Best epoch: 10
best model saved
[2024-01-10 07:15:17] INFO (nni/MainThread) Intermediate result: 0.8037778862702345  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.34	mae: 13.71	mape: 94.59%	acc@10: 45.81%	acc@20: 76.1%	acc@30: 91.97%	
[2024-01-10 07:15:17] INFO (nni/MainThread) Intermediate result: 17.33684696849474  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.793 | lsd:0.674 | ed:0.951 | hr@1:0.707 | hr@2:0.863 | hr@3:0.911 | acc@1:0.707 | acc@2:0.627 | acc@3:0.589 | Best krc: 0.804 | Best epoch: 12
[2024-01-10 07:17:08] INFO (nni/MainThread) Intermediate result: 0.7927321327233877  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.25	mae: 13.69	mape: 95.09%	acc@10: 45.71%	acc@20: 76.08%	acc@30: 92.25%	
[2024-01-10 07:17:08] INFO (nni/MainThread) Intermediate result: 17.25025801435729  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.802 | lsd:0.617 | ed:0.936 | hr@1:0.71 | hr@2:0.872 | hr@3:0.916 | acc@1:0.71 | acc@2:0.637 | acc@3:0.59 | Best krc: 0.804 | Best epoch: 12
[2024-01-10 07:18:59] INFO (nni/MainThread) Intermediate result: 0.8017301379085375  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.07	mae: 13.55	mape: 94.32%	acc@10: 46.17%	acc@20: 76.54%	acc@30: 92.44%	
[2024-01-10 07:18:59] INFO (nni/MainThread) Intermediate result: 17.074032925441486  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.616 | ed:0.927 | hr@1:0.697 | hr@2:0.875 | hr@3:0.919 | acc@1:0.697 | acc@2:0.631 | acc@3:0.588 | Best krc: 0.804 | Best epoch: 12
[2024-01-10 07:20:50] INFO (nni/MainThread) Intermediate result: 0.8000927754491373  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 16.89	mae: 13.41	mape: 93.39%	acc@10: 46.67%	acc@20: 77.06%	acc@30: 92.71%	
[2024-01-10 07:20:50] INFO (nni/MainThread) Intermediate result: 16.890813890068323  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.806 | lsd:0.593 | ed:0.889 | hr@1:0.697 | hr@2:0.874 | hr@3:0.919 | acc@1:0.697 | acc@2:0.633 | acc@3:0.597 | Best krc: 0.804 | Best epoch: 12
best model saved
[2024-01-10 07:22:42] INFO (nni/MainThread) Intermediate result: 0.8057079220962036  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 16.76	mae: 13.32	mape: 92.98%	acc@10: 46.75%	acc@20: 77.25%	acc@30: 92.94%	
[2024-01-10 07:22:42] INFO (nni/MainThread) Intermediate result: 16.759460078411855  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.797 | lsd:0.609 | ed:0.921 | hr@1:0.679 | hr@2:0.877 | hr@3:0.918 | acc@1:0.679 | acc@2:0.619 | acc@3:0.58 | Best krc: 0.806 | Best epoch: 16
[2024-01-10 07:24:33] INFO (nni/MainThread) Intermediate result: 0.7970923558942797  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 16.6	mae: 13.18	mape: 91.74%	acc@10: 47.14%	acc@20: 77.65%	acc@30: 93.09%	
[2024-01-10 07:24:33] INFO (nni/MainThread) Intermediate result: 16.598546884721184  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.796 | lsd:0.644 | ed:0.936 | hr@1:0.689 | hr@2:0.876 | hr@3:0.919 | acc@1:0.689 | acc@2:0.624 | acc@3:0.586 | Best krc: 0.806 | Best epoch: 16
[2024-01-10 07:26:25] INFO (nni/MainThread) Intermediate result: 0.7964556841076299  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.49	mae: 13.08	mape: 91.17%	acc@10: 47.52%	acc@20: 77.97%	acc@30: 93.22%	
[2024-01-10 07:26:25] INFO (nni/MainThread) Intermediate result: 16.48541026153879  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.631 | ed:0.915 | hr@1:0.683 | hr@2:0.875 | hr@3:0.921 | acc@1:0.683 | acc@2:0.626 | acc@3:0.59 | Best krc: 0.806 | Best epoch: 16
[2024-01-10 07:28:17] INFO (nni/MainThread) Intermediate result: 0.8027697040202505  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.39	mae: 13.01	mape: 90.74%	acc@10: 47.87%	acc@20: 78.26%	acc@30: 93.31%	
[2024-01-10 07:28:17] INFO (nni/MainThread) Intermediate result: 16.385468945895504  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.621 | ed:0.924 | hr@1:0.682 | hr@2:0.873 | hr@3:0.919 | acc@1:0.682 | acc@2:0.622 | acc@3:0.583 | Best krc: 0.806 | Best epoch: 16
[2024-01-10 07:30:08] INFO (nni/MainThread) Intermediate result: 0.7986207583409157  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.33	mae: 12.98	mape: 90.73%	acc@10: 47.92%	acc@20: 78.45%	acc@30: 93.35%	
[2024-01-10 07:30:08] INFO (nni/MainThread) Intermediate result: 16.331157435846677  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.637 | ed:0.917 | hr@1:0.684 | hr@2:0.871 | hr@3:0.917 | acc@1:0.684 | acc@2:0.624 | acc@3:0.587 | Best krc: 0.806 | Best epoch: 16
[2024-01-10 07:32:00] INFO (nni/MainThread) Intermediate result: 0.799512807068557  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.3	mae: 12.96	mape: 90.79%	acc@10: 47.9%	acc@20: 78.47%	acc@30: 93.35%	
[2024-01-10 07:32:00] INFO (nni/MainThread) Intermediate result: 16.303845291773914  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.801 | lsd:0.634 | ed:0.905 | hr@1:0.686 | hr@2:0.878 | hr@3:0.922 | acc@1:0.686 | acc@2:0.631 | acc@3:0.599 | Best krc: 0.806 | Best epoch: 16
[2024-01-10 07:33:52] INFO (nni/MainThread) Intermediate result: 0.8014419563173388  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.22	mae: 12.9	mape: 90.36%	acc@10: 48.08%	acc@20: 78.7%	acc@30: 93.46%	
[2024-01-10 07:33:52] INFO (nni/MainThread) Intermediate result: 16.223782861316764  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.796 | lsd:0.642 | ed:0.937 | hr@1:0.679 | hr@2:0.871 | hr@3:0.92 | acc@1:0.679 | acc@2:0.616 | acc@3:0.579 | Best krc: 0.806 | Best epoch: 16
[2024-01-10 07:35:44] INFO (nni/MainThread) Intermediate result: 0.7957655979868484  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 16.14	mae: 12.83	mape: 89.89%	acc@10: 48.29%	acc@20: 78.95%	acc@30: 93.56%	
[2024-01-10 07:35:44] INFO (nni/MainThread) Intermediate result: 16.141684240142414  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.794 | lsd:0.647 | ed:0.939 | hr@1:0.676 | hr@2:0.871 | hr@3:0.92 | acc@1:0.676 | acc@2:0.616 | acc@3:0.579 | Best krc: 0.806 | Best epoch: 16
[2024-01-10 07:37:35] INFO (nni/MainThread) Intermediate result: 0.7943921071074547  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 16.06	mae: 12.74	mape: 88.91%	acc@10: 48.56%	acc@20: 79.17%	acc@30: 93.61%	
[2024-01-10 07:37:35] INFO (nni/MainThread) Intermediate result: 16.057806287162567  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.635 | ed:0.915 | hr@1:0.686 | hr@2:0.872 | hr@3:0.919 | acc@1:0.686 | acc@2:0.624 | acc@3:0.587 | Best krc: 0.806 | Best epoch: 16
[2024-01-10 07:39:27] INFO (nni/MainThread) Intermediate result: 0.7993815832906344  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 15.96	mae: 12.66	mape: 87.92%	acc@10: 48.86%	acc@20: 79.46%	acc@30: 93.72%	
[2024-01-10 07:39:27] INFO (nni/MainThread) Intermediate result: 15.963081645255865  (Index 51)
*** Epoch: 26 ***
-----------------G2R RESULT-------------------

val result: krc:0.797 | lsd:0.637 | ed:0.927 | hr@1:0.683 | hr@2:0.871 | hr@3:0.919 | acc@1:0.683 | acc@2:0.623 | acc@3:0.586 | Best krc: 0.806 | Best epoch: 16
[2024-01-10 07:41:19] INFO (nni/MainThread) Intermediate result: 0.7974075868260391  (Index 52)
-----------------ETPA RESULT-------------------
Epoch 26: Validation	rmse: 15.89	mae: 12.58	mape: 87.17%	acc@10: 49.2%	acc@20: 79.66%	acc@30: 93.79%	
[2024-01-10 07:41:19] INFO (nni/MainThread) Intermediate result: 15.886044714985994  (Index 53)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1704865867.08174251704865867.0817566
best model loaded !!!
krc:0.8 | lsd:0.441 | ed:0.904 | hr@1:0.698 | hr@2:0.912 | hr@3:0.943 | acc@1:0.698 | acc@2:0.645 | acc@3:0.595 |

-------------------------------------------------------------
Best epoch for G2R:  16
Best epoch for ETPA:  26
graph2route_pd Evaluation in test: krc:0.8 | lsd:0.441 | ed:0.904 | hr@1:0.698 | hr@2:0.912 | hr@3:0.943 | acc@1:0.698 | acc@2:0.645 | acc@3:0.595 |
RankPETA Evaluation in test: rmse: 12.83	mae: 9.71	mape: 77.15%	acc@10: 63.29%	acc@20: 89.45%	acc@30: 97.05%	
