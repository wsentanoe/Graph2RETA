Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 100,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 1000,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.748 | lsd:0.76 | ed:1.087 | hr@1:0.621 | hr@2:0.85 | hr@3:0.899 | acc@1:0.621 | acc@2:0.552 | acc@3:0.51 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-05 17:31:34] INFO (nni/MainThread) Intermediate result: 0.7482914533198748  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 23.9	mae: 18.33	mape: 93.34%	acc@10: 39.63%	acc@20: 64.07%	acc@30: 77.41%	
[2023-12-05 17:31:34] INFO (nni/MainThread) Intermediate result: 23.904383607699707  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.728 | ed:1.045 | hr@1:0.625 | hr@2:0.854 | hr@3:0.9 | acc@1:0.625 | acc@2:0.564 | acc@3:0.522 | Best krc: 0.748 | Best epoch: 0
best model saved
[2023-12-05 17:31:59] INFO (nni/MainThread) Intermediate result: 0.7589882876196826  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 24.39	mae: 18.52	mape: 114.17%	acc@10: 36.3%	acc@20: 65.56%	acc@30: 79.63%	
[2023-12-05 17:31:59] INFO (nni/MainThread) Intermediate result: 24.390801428699977  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.756 | lsd:0.722 | ed:1.046 | hr@1:0.629 | hr@2:0.856 | hr@3:0.902 | acc@1:0.629 | acc@2:0.567 | acc@3:0.523 | Best krc: 0.759 | Best epoch: 1
[2023-12-05 17:32:23] INFO (nni/MainThread) Intermediate result: 0.7560803241520337  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 23.4	mae: 18.06	mape: 120.3%	acc@10: 36.05%	acc@20: 65.68%	acc@30: 81.48%	
[2023-12-05 17:32:23] INFO (nni/MainThread) Intermediate result: 23.398404292491186  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.699 | ed:1.029 | hr@1:0.634 | hr@2:0.857 | hr@3:0.908 | acc@1:0.634 | acc@2:0.569 | acc@3:0.534 | Best krc: 0.759 | Best epoch: 1
best model saved
[2023-12-05 17:32:48] INFO (nni/MainThread) Intermediate result: 0.760757674041452  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 23.11	mae: 18.18	mape: 127.17%	acc@10: 34.63%	acc@20: 63.89%	acc@30: 81.67%	
[2023-12-05 17:32:48] INFO (nni/MainThread) Intermediate result: 23.10729831715117  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.705 | ed:1.017 | hr@1:0.631 | hr@2:0.861 | hr@3:0.904 | acc@1:0.631 | acc@2:0.574 | acc@3:0.532 | Best krc: 0.761 | Best epoch: 3
best model saved
[2023-12-05 17:33:14] INFO (nni/MainThread) Intermediate result: 0.7655329593239518  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 22.38	mae: 17.7	mape: 127.12%	acc@10: 34.67%	acc@20: 64.44%	acc@30: 83.26%	
[2023-12-05 17:33:14] INFO (nni/MainThread) Intermediate result: 22.382053576265154  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.693 | ed:1.012 | hr@1:0.639 | hr@2:0.859 | hr@3:0.906 | acc@1:0.639 | acc@2:0.578 | acc@3:0.531 | Best krc: 0.766 | Best epoch: 4
best model saved
[2023-12-05 17:33:40] INFO (nni/MainThread) Intermediate result: 0.7660965900930921  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 21.55	mae: 17.14	mape: 124.8%	acc@10: 35.56%	acc@20: 65.93%	acc@30: 84.75%	
[2023-12-05 17:33:40] INFO (nni/MainThread) Intermediate result: 21.554210444844394  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.703 | ed:0.995 | hr@1:0.636 | hr@2:0.858 | hr@3:0.91 | acc@1:0.636 | acc@2:0.572 | acc@3:0.539 | Best krc: 0.766 | Best epoch: 5
best model saved
[2023-12-05 17:34:06] INFO (nni/MainThread) Intermediate result: 0.7725586085358713  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 20.83	mae: 16.63	mape: 121.89%	acc@10: 36.19%	acc@20: 67.67%	acc@30: 85.98%	
[2023-12-05 17:34:06] INFO (nni/MainThread) Intermediate result: 20.82638283838218  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.694 | ed:1.004 | hr@1:0.633 | hr@2:0.862 | hr@3:0.907 | acc@1:0.633 | acc@2:0.571 | acc@3:0.536 | Best krc: 0.773 | Best epoch: 6
[2023-12-05 17:34:30] INFO (nni/MainThread) Intermediate result: 0.766386495332713  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 20.38	mae: 16.32	mape: 120.43%	acc@10: 36.53%	acc@20: 68.47%	acc@30: 86.71%	
[2023-12-05 17:34:30] INFO (nni/MainThread) Intermediate result: 20.376130135894726  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.707 | ed:1.01 | hr@1:0.623 | hr@2:0.855 | hr@3:0.904 | acc@1:0.623 | acc@2:0.566 | acc@3:0.53 | Best krc: 0.773 | Best epoch: 6
[2023-12-05 17:34:55] INFO (nni/MainThread) Intermediate result: 0.764056178966542  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 20.03	mae: 16.08	mape: 119.41%	acc@10: 36.87%	acc@20: 69.09%	acc@30: 87.45%	
[2023-12-05 17:34:55] INFO (nni/MainThread) Intermediate result: 20.026652005174032  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.699 | ed:1.0 | hr@1:0.644 | hr@2:0.86 | hr@3:0.907 | acc@1:0.644 | acc@2:0.581 | acc@3:0.537 | Best krc: 0.773 | Best epoch: 6
[2023-12-05 17:35:19] INFO (nni/MainThread) Intermediate result: 0.7671226669652553  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 19.65	mae: 15.83	mape: 117.92%	acc@10: 37.19%	acc@20: 69.93%	acc@30: 88.26%	
[2023-12-05 17:35:19] INFO (nni/MainThread) Intermediate result: 19.65323399619412  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.69 | ed:0.97 | hr@1:0.643 | hr@2:0.864 | hr@3:0.912 | acc@1:0.643 | acc@2:0.587 | acc@3:0.551 | Best krc: 0.773 | Best epoch: 6
best model saved
[2023-12-05 17:35:45] INFO (nni/MainThread) Intermediate result: 0.7772543542547914  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 19.31	mae: 15.57	mape: 116.37%	acc@10: 37.98%	acc@20: 70.64%	acc@30: 88.86%	
[2023-12-05 17:35:45] INFO (nni/MainThread) Intermediate result: 19.31331532915246  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.73 | ed:1.016 | hr@1:0.631 | hr@2:0.855 | hr@3:0.904 | acc@1:0.631 | acc@2:0.571 | acc@3:0.533 | Best krc: 0.777 | Best epoch: 10
[2023-12-05 17:36:09] INFO (nni/MainThread) Intermediate result: 0.7615678706627548  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 19.03	mae: 15.36	mape: 115.2%	acc@10: 38.4%	acc@20: 71.2%	acc@30: 89.41%	
[2023-12-05 17:36:09] INFO (nni/MainThread) Intermediate result: 19.03025035130584  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.724 | ed:1.016 | hr@1:0.624 | hr@2:0.857 | hr@3:0.905 | acc@1:0.624 | acc@2:0.565 | acc@3:0.528 | Best krc: 0.777 | Best epoch: 10
[2023-12-05 17:36:33] INFO (nni/MainThread) Intermediate result: 0.7598134670718841  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 18.77	mae: 15.16	mape: 113.84%	acc@10: 38.86%	acc@20: 71.77%	acc@30: 89.8%	
[2023-12-05 17:36:33] INFO (nni/MainThread) Intermediate result: 18.77068783453845  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.681 | ed:0.96 | hr@1:0.642 | hr@2:0.862 | hr@3:0.913 | acc@1:0.642 | acc@2:0.586 | acc@3:0.551 | Best krc: 0.777 | Best epoch: 10
[2023-12-05 17:36:57] INFO (nni/MainThread) Intermediate result: 0.7762819237152424  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 18.63	mae: 15.03	mape: 113.15%	acc@10: 39.23%	acc@20: 72.06%	acc@30: 90.0%	
[2023-12-05 17:36:57] INFO (nni/MainThread) Intermediate result: 18.626233450639113  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.687 | ed:0.97 | hr@1:0.633 | hr@2:0.863 | hr@3:0.911 | acc@1:0.633 | acc@2:0.581 | acc@3:0.546 | Best krc: 0.777 | Best epoch: 10
[2023-12-05 17:37:21] INFO (nni/MainThread) Intermediate result: 0.7728897088757168  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 18.54	mae: 14.98	mape: 113.07%	acc@10: 39.28%	acc@20: 72.05%	acc@30: 90.2%	
[2023-12-05 17:37:21] INFO (nni/MainThread) Intermediate result: 18.535909475984454  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.666 | ed:0.977 | hr@1:0.631 | hr@2:0.864 | hr@3:0.911 | acc@1:0.631 | acc@2:0.573 | acc@3:0.538 | Best krc: 0.777 | Best epoch: 10
[2023-12-05 17:37:45] INFO (nni/MainThread) Intermediate result: 0.7720354940206274  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 18.32	mae: 14.81	mape: 111.87%	acc@10: 39.79%	acc@20: 72.59%	acc@30: 90.56%	
[2023-12-05 17:37:45] INFO (nni/MainThread) Intermediate result: 18.319314221253567  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.784 | lsd:0.667 | ed:0.938 | hr@1:0.646 | hr@2:0.865 | hr@3:0.911 | acc@1:0.646 | acc@2:0.592 | acc@3:0.559 | Best krc: 0.777 | Best epoch: 10
best model saved
[2023-12-05 17:38:11] INFO (nni/MainThread) Intermediate result: 0.7844786113172647  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 18.1	mae: 14.63	mape: 110.41%	acc@10: 40.48%	acc@20: 73.31%	acc@30: 90.89%	
[2023-12-05 17:38:11] INFO (nni/MainThread) Intermediate result: 18.099751884989814  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.655 | ed:0.959 | hr@1:0.639 | hr@2:0.866 | hr@3:0.91 | acc@1:0.639 | acc@2:0.588 | acc@3:0.548 | Best krc: 0.784 | Best epoch: 16
[2023-12-05 17:38:35] INFO (nni/MainThread) Intermediate result: 0.775767914412427  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 17.95	mae: 14.51	mape: 109.49%	acc@10: 40.76%	acc@20: 73.68%	acc@30: 91.15%	
[2023-12-05 17:38:35] INFO (nni/MainThread) Intermediate result: 17.952067224146077  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.67 | ed:0.972 | hr@1:0.638 | hr@2:0.866 | hr@3:0.913 | acc@1:0.638 | acc@2:0.583 | acc@3:0.546 | Best krc: 0.784 | Best epoch: 16
[2023-12-05 17:38:59] INFO (nni/MainThread) Intermediate result: 0.7730643344897827  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 17.81	mae: 14.39	mape: 108.68%	acc@10: 41.07%	acc@20: 74.04%	acc@30: 91.4%	
[2023-12-05 17:38:59] INFO (nni/MainThread) Intermediate result: 17.813120920065273  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.654 | ed:0.959 | hr@1:0.641 | hr@2:0.865 | hr@3:0.913 | acc@1:0.641 | acc@2:0.586 | acc@3:0.552 | Best krc: 0.784 | Best epoch: 16
[2023-12-05 17:39:25] INFO (nni/MainThread) Intermediate result: 0.7772422760966704  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 17.66	mae: 14.26	mape: 107.4%	acc@10: 41.69%	acc@20: 74.41%	acc@30: 91.57%	
[2023-12-05 17:39:25] INFO (nni/MainThread) Intermediate result: 17.658656241708606  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.67 | ed:0.955 | hr@1:0.641 | hr@2:0.867 | hr@3:0.913 | acc@1:0.641 | acc@2:0.588 | acc@3:0.553 | Best krc: 0.784 | Best epoch: 16
[2023-12-05 17:39:50] INFO (nni/MainThread) Intermediate result: 0.7772929113025309  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 17.48	mae: 14.11	mape: 106.04%	acc@10: 42.22%	acc@20: 74.96%	acc@30: 91.8%	
[2023-12-05 17:39:50] INFO (nni/MainThread) Intermediate result: 17.484016299103732  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.644 | ed:0.957 | hr@1:0.643 | hr@2:0.867 | hr@3:0.914 | acc@1:0.643 | acc@2:0.587 | acc@3:0.553 | Best krc: 0.784 | Best epoch: 16
[2023-12-05 17:40:14] INFO (nni/MainThread) Intermediate result: 0.7762106619999055  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 17.35	mae: 14.01	mape: 105.26%	acc@10: 42.53%	acc@20: 75.32%	acc@30: 92.0%	
[2023-12-05 17:40:14] INFO (nni/MainThread) Intermediate result: 17.352866980577605  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.672 | ed:1.006 | hr@1:0.637 | hr@2:0.866 | hr@3:0.91 | acc@1:0.637 | acc@2:0.58 | acc@3:0.54 | Best krc: 0.784 | Best epoch: 16
[2023-12-05 17:40:39] INFO (nni/MainThread) Intermediate result: 0.7643637976300853  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 17.21	mae: 13.89	mape: 104.07%	acc@10: 43.0%	acc@20: 75.7%	acc@30: 92.17%	
[2023-12-05 17:40:39] INFO (nni/MainThread) Intermediate result: 17.21433142504915  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.681 | ed:0.997 | hr@1:0.633 | hr@2:0.864 | hr@3:0.908 | acc@1:0.633 | acc@2:0.579 | acc@3:0.535 | Best krc: 0.784 | Best epoch: 16
[2023-12-05 17:41:04] INFO (nni/MainThread) Intermediate result: 0.7665750919795521  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 17.06	mae: 13.77	mape: 102.84%	acc@10: 43.4%	acc@20: 76.14%	acc@30: 92.38%	
[2023-12-05 17:41:04] INFO (nni/MainThread) Intermediate result: 17.063730739708102  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.665 | ed:0.984 | hr@1:0.636 | hr@2:0.863 | hr@3:0.91 | acc@1:0.636 | acc@2:0.578 | acc@3:0.538 | Best krc: 0.784 | Best epoch: 16
[2023-12-05 17:41:28] INFO (nni/MainThread) Intermediate result: 0.7726601539806613  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 16.97	mae: 13.69	mape: 102.19%	acc@10: 43.63%	acc@20: 76.41%	acc@30: 92.5%	
[2023-12-05 17:41:28] INFO (nni/MainThread) Intermediate result: 16.972651680872815  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.647 | ed:0.944 | hr@1:0.652 | hr@2:0.868 | hr@3:0.915 | acc@1:0.652 | acc@2:0.595 | acc@3:0.557 | Best krc: 0.784 | Best epoch: 16
[2023-12-05 17:41:53] INFO (nni/MainThread) Intermediate result: 0.7821359485548379  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 16.92	mae: 13.65	mape: 101.98%	acc@10: 43.72%	acc@20: 76.58%	acc@30: 92.61%	
[2023-12-05 17:41:53] INFO (nni/MainThread) Intermediate result: 16.91904542361033  (Index 51)
*** Epoch: 26 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.658 | ed:0.961 | hr@1:0.647 | hr@2:0.863 | hr@3:0.912 | acc@1:0.647 | acc@2:0.587 | acc@3:0.549 | Best krc: 0.784 | Best epoch: 16
[2023-12-05 17:42:19] INFO (nni/MainThread) Intermediate result: 0.7780939208486215  (Index 52)
-----------------ETPA RESULT-------------------
Epoch 26: Validation	rmse: 16.85	mae: 13.58	mape: 101.51%	acc@10: 43.95%	acc@20: 76.72%	acc@30: 92.72%	
[2023-12-05 17:42:19] INFO (nni/MainThread) Intermediate result: 16.84686700135334  (Index 53)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701793870.17328551701793870.173303
best model loaded !!!
krc:0.778 | lsd:0.485 | ed:0.961 | hr@1:0.654 | hr@2:0.906 | hr@3:0.941 | acc@1:0.654 | acc@2:0.61 | acc@3:0.563 |

-------------------------------------------------------------
Best epoch for G2R:  16
Best epoch for ETPA:  26
graph2route_pd Evaluation in test: krc:0.778 | lsd:0.485 | ed:0.961 | hr@1:0.654 | hr@2:0.906 | hr@3:0.941 | acc@1:0.654 | acc@2:0.61 | acc@3:0.563 |
RankPETA Evaluation in test: rmse: 14.3	mae: 11.18	mape: 104.4%	acc@10: 49.79%	acc@20: 85.23%	acc@30: 96.62%	
