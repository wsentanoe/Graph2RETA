Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 2,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'true_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:38
#train:2521 | #val:1257 | #test:1261
****ETPA Loss****
Epoch 0: Train [0/2521 (0%)]	RMSE: 41.965902
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 0: Train [256/2521 (10%)]	RMSE: 58.420471
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 0: Train [512/2521 (20%)]	RMSE: 53.852886
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 0: Train [768/2521 (30%)]	RMSE: 52.006483
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 0: Train [1024/2521 (40%)]	RMSE: 49.340931
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 0: Train [1280/2521 (50%)]	RMSE: 51.651964
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 0: Train [1536/2521 (60%)]	RMSE: 52.053000
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 0: Train [1792/2521 (70%)]	RMSE: 52.332156
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 0: Train [2048/2521 (80%)]	RMSE: 51.497601
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 0: Train [2304/2521 (90%)]	RMSE: 51.117405
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
best model saved
[2023-11-23 08:37:18] INFO (nni/MainThread) Intermediate result: 0.7218321163075817  (Index 0)
[2023-11-23 08:37:18] INFO (nni/MainThread) Intermediate result: 12.564100173079632  (Index 1)
****ETPA Loss****
Epoch 1: Train [0/2521 (0%)]	RMSE: 51.925574
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 1: Train [256/2521 (10%)]	RMSE: 51.338835
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 1: Train [512/2521 (20%)]	RMSE: 51.188854
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 1: Train [768/2521 (30%)]	RMSE: 51.366807
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 1: Train [1024/2521 (40%)]	RMSE: 51.251973
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 1: Train [1280/2521 (50%)]	RMSE: 51.170367
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 1: Train [1536/2521 (60%)]	RMSE: 50.771931
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 1: Train [1792/2521 (70%)]	RMSE: 49.753198
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 1: Train [2048/2521 (80%)]	RMSE: 49.484850
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
Epoch 1: Train [2304/2521 (90%)]	RMSE: 48.903170
****ETPA Loss****
****ETPA Loss****
****ETPA Loss****
best model saved
[2023-11-23 08:37:42] INFO (nni/MainThread) Intermediate result: 0.7485808742238522  (Index 2)
[2023-11-23 08:37:42] INFO (nni/MainThread) Intermediate result: 12.38804552027676  (Index 3)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1700725013.92021061700725013.9202209
best model loaded !!!
krc:0.748 | lsd:0.56 | ed:1.06 | hr@1:0.642 | hr@2:0.884 | hr@3:0.931 | acc@1:0.642 | acc@2:0.573 | acc@3:0.53 |

-------------------------------------------------------------
Best epoch for G2R:  1
Best epoch for ETPA:  1
graph2route_pd Evaluation in test: krc:0.748 | lsd:0.56 | ed:1.06 | hr@1:0.642 | hr@2:0.884 | hr@3:0.931 | acc@1:0.642 | acc@2:0.573 | acc@3:0.53 |
RankPETA Evaluation in test: rmse: 11.44	mae: 8.44	mape: 39.85%	acc@10: 61.54%	acc@20: 88.46%	acc@30: 100.0%	
