Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 9999,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.687 | lsd:0.999 | ed:1.261 | hr@1:0.628 | hr@2:0.801 | hr@3:0.868 | acc@1:0.628 | acc@2:0.519 | acc@3:0.47 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-18 10:55:18] INFO (nni/MainThread) Intermediate result: 0.6867074074769743  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 23.36	mae: 17.29	mape: 104.89%	acc@10: 40.74%	acc@20: 69.63%	acc@30: 83.7%	
[2023-12-18 10:55:18] INFO (nni/MainThread) Intermediate result: 23.36481176279701  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.746 | ed:1.026 | hr@1:0.656 | hr@2:0.852 | hr@3:0.907 | acc@1:0.656 | acc@2:0.584 | acc@3:0.551 | Best krc: 0.687 | Best epoch: 0
best model saved
[2023-12-18 10:56:57] INFO (nni/MainThread) Intermediate result: 0.76123170550805  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 22.42	mae: 16.53	mape: 105.99%	acc@10: 42.59%	acc@20: 71.85%	acc@30: 84.07%	
[2023-12-18 10:56:57] INFO (nni/MainThread) Intermediate result: 22.417981616530092  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.701 | ed:0.997 | hr@1:0.696 | hr@2:0.853 | hr@3:0.904 | acc@1:0.696 | acc@2:0.61 | acc@3:0.564 | Best krc: 0.761 | Best epoch: 1
best model saved
[2023-12-18 10:58:36] INFO (nni/MainThread) Intermediate result: 0.7784640784728235  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 21.53	mae: 15.83	mape: 103.16%	acc@10: 45.31%	acc@20: 72.59%	acc@30: 83.95%	
[2023-12-18 10:58:36] INFO (nni/MainThread) Intermediate result: 21.534353451952565  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.79 | lsd:0.703 | ed:0.962 | hr@1:0.696 | hr@2:0.861 | hr@3:0.911 | acc@1:0.696 | acc@2:0.619 | acc@3:0.583 | Best krc: 0.778 | Best epoch: 2
best model saved
[2023-12-18 11:00:15] INFO (nni/MainThread) Intermediate result: 0.7901973389774002  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 21.01	mae: 15.69	mape: 106.43%	acc@10: 43.33%	acc@20: 72.04%	acc@30: 85.19%	
[2023-12-18 11:00:15] INFO (nni/MainThread) Intermediate result: 21.009420370334826  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.795 | lsd:0.629 | ed:0.918 | hr@1:0.696 | hr@2:0.871 | hr@3:0.916 | acc@1:0.696 | acc@2:0.628 | acc@3:0.588 | Best krc: 0.79 | Best epoch: 3
best model saved
[2023-12-18 11:01:55] INFO (nni/MainThread) Intermediate result: 0.7953333356306684  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 20.44	mae: 15.3	mape: 104.83%	acc@10: 44.67%	acc@20: 73.11%	acc@30: 85.78%	
[2023-12-18 11:01:55] INFO (nni/MainThread) Intermediate result: 20.439758694577364  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.792 | lsd:0.668 | ed:0.957 | hr@1:0.711 | hr@2:0.866 | hr@3:0.916 | acc@1:0.711 | acc@2:0.631 | acc@3:0.592 | Best krc: 0.795 | Best epoch: 4
[2023-12-18 11:03:34] INFO (nni/MainThread) Intermediate result: 0.7915522505640565  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 19.87	mae: 14.97	mape: 103.27%	acc@10: 45.12%	acc@20: 74.01%	acc@30: 86.36%	
[2023-12-18 11:03:34] INFO (nni/MainThread) Intermediate result: 19.870026716900632  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.635 | ed:0.926 | hr@1:0.702 | hr@2:0.869 | hr@3:0.916 | acc@1:0.702 | acc@2:0.627 | acc@3:0.592 | Best krc: 0.795 | Best epoch: 4
best model saved
[2023-12-18 11:05:15] INFO (nni/MainThread) Intermediate result: 0.7985357084089048  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 19.38	mae: 14.75	mape: 102.51%	acc@10: 44.97%	acc@20: 74.55%	acc@30: 87.41%	
[2023-12-18 11:05:15] INFO (nni/MainThread) Intermediate result: 19.380235924237535  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.81 | lsd:0.61 | ed:0.873 | hr@1:0.72 | hr@2:0.875 | hr@3:0.924 | acc@1:0.72 | acc@2:0.646 | acc@3:0.611 | Best krc: 0.799 | Best epoch: 6
best model saved
[2023-12-18 11:06:56] INFO (nni/MainThread) Intermediate result: 0.8095357148964495  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.12	mae: 14.63	mape: 102.71%	acc@10: 45.09%	acc@20: 74.91%	acc@30: 87.82%	
[2023-12-18 11:06:56] INFO (nni/MainThread) Intermediate result: 19.122308157304047  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.801 | lsd:0.628 | ed:0.911 | hr@1:0.697 | hr@2:0.873 | hr@3:0.922 | acc@1:0.697 | acc@2:0.627 | acc@3:0.596 | Best krc: 0.81 | Best epoch: 7
[2023-12-18 11:08:36] INFO (nni/MainThread) Intermediate result: 0.8011540701440132  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.7	mae: 14.39	mape: 101.29%	acc@10: 45.43%	acc@20: 75.43%	acc@30: 88.72%	
[2023-12-18 11:08:36] INFO (nni/MainThread) Intermediate result: 18.696755269012108  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.785 | lsd:0.682 | ed:0.969 | hr@1:0.694 | hr@2:0.873 | hr@3:0.915 | acc@1:0.694 | acc@2:0.622 | acc@3:0.583 | Best krc: 0.81 | Best epoch: 7
[2023-12-18 11:10:16] INFO (nni/MainThread) Intermediate result: 0.7846663003549753  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.32	mae: 14.12	mape: 99.33%	acc@10: 46.33%	acc@20: 76.0%	acc@30: 89.3%	
[2023-12-18 11:10:16] INFO (nni/MainThread) Intermediate result: 18.322175688747244  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.618 | ed:0.895 | hr@1:0.706 | hr@2:0.877 | hr@3:0.921 | acc@1:0.706 | acc@2:0.642 | acc@3:0.609 | Best krc: 0.81 | Best epoch: 7
[2023-12-18 11:11:56] INFO (nni/MainThread) Intermediate result: 0.8029566226417996  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 18.18	mae: 14.06	mape: 98.68%	acc@10: 46.36%	acc@20: 75.79%	acc@30: 89.6%	
[2023-12-18 11:11:56] INFO (nni/MainThread) Intermediate result: 18.182023668655745  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.805 | lsd:0.6 | ed:0.903 | hr@1:0.702 | hr@2:0.879 | hr@3:0.925 | acc@1:0.702 | acc@2:0.633 | acc@3:0.601 | Best krc: 0.81 | Best epoch: 7
[2023-12-18 11:13:36] INFO (nni/MainThread) Intermediate result: 0.8052915550335751  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 18.15	mae: 14.07	mape: 99.21%	acc@10: 46.08%	acc@20: 76.02%	acc@30: 89.44%	
[2023-12-18 11:13:36] INFO (nni/MainThread) Intermediate result: 18.151369868477452  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.653 | ed:0.932 | hr@1:0.719 | hr@2:0.87 | hr@3:0.913 | acc@1:0.719 | acc@2:0.638 | acc@3:0.597 | Best krc: 0.81 | Best epoch: 7
[2023-12-18 11:15:17] INFO (nni/MainThread) Intermediate result: 0.8002161478418583  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 18.1	mae: 14.06	mape: 99.7%	acc@10: 45.67%	acc@20: 75.98%	acc@30: 89.57%	
[2023-12-18 11:15:17] INFO (nni/MainThread) Intermediate result: 18.09799359664438  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.616 | ed:0.889 | hr@1:0.706 | hr@2:0.877 | hr@3:0.924 | acc@1:0.706 | acc@2:0.641 | acc@3:0.612 | Best krc: 0.81 | Best epoch: 7
[2023-12-18 11:16:57] INFO (nni/MainThread) Intermediate result: 0.8078638875578097  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.99	mae: 14.0	mape: 99.63%	acc@10: 45.77%	acc@20: 76.08%	acc@30: 89.74%	
[2023-12-18 11:16:57] INFO (nni/MainThread) Intermediate result: 17.993185048639443  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.797 | lsd:0.6 | ed:0.92 | hr@1:0.687 | hr@2:0.874 | hr@3:0.921 | acc@1:0.687 | acc@2:0.618 | acc@3:0.583 | Best krc: 0.81 | Best epoch: 7
[2023-12-18 11:18:37] INFO (nni/MainThread) Intermediate result: 0.7971013701840113  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.83	mae: 13.9	mape: 99.19%	acc@10: 45.9%	acc@20: 76.27%	acc@30: 90.02%	
[2023-12-18 11:18:37] INFO (nni/MainThread) Intermediate result: 17.831212977818087  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.792 | lsd:0.64 | ed:0.953 | hr@1:0.721 | hr@2:0.865 | hr@3:0.918 | acc@1:0.721 | acc@2:0.628 | acc@3:0.587 | Best krc: 0.81 | Best epoch: 7
[2023-12-18 11:20:17] INFO (nni/MainThread) Intermediate result: 0.7923556852546797  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 17.72	mae: 13.84	mape: 98.76%	acc@10: 46.02%	acc@20: 76.27%	acc@30: 90.23%	
[2023-12-18 11:20:17] INFO (nni/MainThread) Intermediate result: 17.716999186287588  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.801 | lsd:0.663 | ed:0.937 | hr@1:0.718 | hr@2:0.871 | hr@3:0.918 | acc@1:0.718 | acc@2:0.64 | acc@3:0.598 | Best krc: 0.81 | Best epoch: 7
[2023-12-18 11:22:00] INFO (nni/MainThread) Intermediate result: 0.8005947745431787  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 17.6	mae: 13.75	mape: 98.1%	acc@10: 46.32%	acc@20: 76.56%	acc@30: 90.26%	
[2023-12-18 11:22:00] INFO (nni/MainThread) Intermediate result: 17.601789364746526  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.691 | ed:0.935 | hr@1:0.732 | hr@2:0.858 | hr@3:0.918 | acc@1:0.732 | acc@2:0.632 | acc@3:0.603 | Best krc: 0.81 | Best epoch: 7
[2023-12-18 11:23:42] INFO (nni/MainThread) Intermediate result: 0.7990383692001533  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 17.54	mae: 13.74	mape: 98.18%	acc@10: 46.17%	acc@20: 76.52%	acc@30: 90.45%	
[2023-12-18 11:23:42] INFO (nni/MainThread) Intermediate result: 17.540027564133684  (Index 35)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702893218.66345621702893218.6634698
best model loaded !!!
krc:0.805 | lsd:0.447 | ed:0.898 | hr@1:0.722 | hr@2:0.899 | hr@3:0.943 | acc@1:0.722 | acc@2:0.65 | acc@3:0.6 |

-------------------------------------------------------------
Best epoch for G2R:  7
Best epoch for ETPA:  17
graph2route_pd Evaluation in test: krc:0.805 | lsd:0.447 | ed:0.898 | hr@1:0.722 | hr@2:0.899 | hr@3:0.943 | acc@1:0.722 | acc@2:0.65 | acc@3:0.6 |
RankPETA Evaluation in test: rmse: 16.27	mae: 13.07	mape: 116.88%	acc@10: 43.04%	acc@20: 80.59%	acc@30: 94.09%	
