Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 1999,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.709 | lsd:0.885 | ed:1.177 | hr@1:0.607 | hr@2:0.831 | hr@3:0.876 | acc@1:0.607 | acc@2:0.531 | acc@3:0.478 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-16 09:16:48] INFO (nni/MainThread) Intermediate result: 0.7086877222600878  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.25	mae: 19.0	mape: 69.67%	acc@10: 38.89%	acc@20: 61.11%	acc@30: 78.89%	
[2023-12-16 09:16:48] INFO (nni/MainThread) Intermediate result: 24.252656456867644  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.748 | lsd:0.734 | ed:1.073 | hr@1:0.621 | hr@2:0.851 | hr@3:0.898 | acc@1:0.621 | acc@2:0.555 | acc@3:0.507 | Best krc: 0.709 | Best epoch: 0
best model saved
[2023-12-16 09:17:11] INFO (nni/MainThread) Intermediate result: 0.7478852935433608  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 22.17	mae: 17.23	mape: 87.64%	acc@10: 40.93%	acc@20: 64.63%	acc@30: 83.89%	
[2023-12-16 09:17:11] INFO (nni/MainThread) Intermediate result: 22.173219934776853  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.681 | ed:1.01 | hr@1:0.629 | hr@2:0.86 | hr@3:0.909 | acc@1:0.629 | acc@2:0.566 | acc@3:0.533 | Best krc: 0.748 | Best epoch: 1
best model saved
[2023-12-16 09:17:35] INFO (nni/MainThread) Intermediate result: 0.7643085104825375  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 22.02	mae: 17.05	mape: 99.8%	acc@10: 40.62%	acc@20: 65.43%	acc@30: 84.2%	
[2023-12-16 09:17:35] INFO (nni/MainThread) Intermediate result: 22.02101564894649  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.66 | ed:0.982 | hr@1:0.637 | hr@2:0.868 | hr@3:0.911 | acc@1:0.637 | acc@2:0.582 | acc@3:0.544 | Best krc: 0.764 | Best epoch: 2
best model saved
[2023-12-16 09:17:59] INFO (nni/MainThread) Intermediate result: 0.7743204344603558  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 21.35	mae: 16.36	mape: 99.85%	acc@10: 43.33%	acc@20: 67.41%	acc@30: 84.72%	
[2023-12-16 09:17:59] INFO (nni/MainThread) Intermediate result: 21.352403406905626  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.704 | ed:1.012 | hr@1:0.627 | hr@2:0.861 | hr@3:0.907 | acc@1:0.627 | acc@2:0.573 | acc@3:0.531 | Best krc: 0.774 | Best epoch: 3
[2023-12-16 09:18:22] INFO (nni/MainThread) Intermediate result: 0.7609340857526253  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 21.1	mae: 16.21	mape: 102.67%	acc@10: 43.48%	acc@20: 68.22%	acc@30: 84.89%	
[2023-12-16 09:18:22] INFO (nni/MainThread) Intermediate result: 21.100280714521297  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.686 | ed:0.991 | hr@1:0.638 | hr@2:0.86 | hr@3:0.906 | acc@1:0.638 | acc@2:0.582 | acc@3:0.541 | Best krc: 0.774 | Best epoch: 3
[2023-12-16 09:18:45] INFO (nni/MainThread) Intermediate result: 0.7669261328640428  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 20.3	mae: 15.63	mape: 100.14%	acc@10: 44.81%	acc@20: 69.69%	acc@30: 85.99%	
[2023-12-16 09:18:45] INFO (nni/MainThread) Intermediate result: 20.29532094292183  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.703 | ed:1.0 | hr@1:0.634 | hr@2:0.863 | hr@3:0.909 | acc@1:0.634 | acc@2:0.579 | acc@3:0.541 | Best krc: 0.774 | Best epoch: 3
[2023-12-16 09:19:08] INFO (nni/MainThread) Intermediate result: 0.7648548866476281  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 19.85	mae: 15.25	mape: 99.09%	acc@10: 45.71%	acc@20: 70.85%	acc@30: 86.61%	
[2023-12-16 09:19:08] INFO (nni/MainThread) Intermediate result: 19.854395436141633  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.755 | lsd:0.731 | ed:1.033 | hr@1:0.625 | hr@2:0.861 | hr@3:0.906 | acc@1:0.625 | acc@2:0.571 | acc@3:0.527 | Best krc: 0.774 | Best epoch: 3
[2023-12-16 09:19:30] INFO (nni/MainThread) Intermediate result: 0.754747669212033  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.27	mae: 14.81	mape: 97.11%	acc@10: 46.81%	acc@20: 72.31%	acc@30: 87.45%	
[2023-12-16 09:19:30] INFO (nni/MainThread) Intermediate result: 19.270554332733255  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.682 | ed:0.998 | hr@1:0.633 | hr@2:0.864 | hr@3:0.91 | acc@1:0.633 | acc@2:0.578 | acc@3:0.539 | Best krc: 0.774 | Best epoch: 3
[2023-12-16 09:19:53] INFO (nni/MainThread) Intermediate result: 0.7667815563924002  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.75	mae: 14.44	mape: 94.82%	acc@10: 47.61%	acc@20: 73.54%	acc@30: 88.31%	
[2023-12-16 09:19:53] INFO (nni/MainThread) Intermediate result: 18.751076747547064  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.676 | ed:1.0 | hr@1:0.633 | hr@2:0.862 | hr@3:0.913 | acc@1:0.633 | acc@2:0.571 | acc@3:0.531 | Best krc: 0.774 | Best epoch: 3
[2023-12-16 09:20:16] INFO (nni/MainThread) Intermediate result: 0.7658033300971647  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.49	mae: 14.32	mape: 95.47%	acc@10: 46.93%	acc@20: 74.0%	acc@30: 89.04%	
[2023-12-16 09:20:16] INFO (nni/MainThread) Intermediate result: 18.48570099999061  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.659 | ed:0.956 | hr@1:0.641 | hr@2:0.864 | hr@3:0.913 | acc@1:0.641 | acc@2:0.584 | acc@3:0.551 | Best krc: 0.774 | Best epoch: 3
best model saved
[2023-12-16 09:20:40] INFO (nni/MainThread) Intermediate result: 0.7770829167593488  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 18.01	mae: 13.97	mape: 93.34%	acc@10: 47.85%	acc@20: 75.35%	acc@30: 89.73%	
[2023-12-16 09:20:40] INFO (nni/MainThread) Intermediate result: 18.00625962595254  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.711 | ed:1.028 | hr@1:0.62 | hr@2:0.863 | hr@3:0.907 | acc@1:0.62 | acc@2:0.567 | acc@3:0.529 | Best krc: 0.777 | Best epoch: 10
[2023-12-16 09:21:03] INFO (nni/MainThread) Intermediate result: 0.7645926151129475  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.65	mae: 13.68	mape: 90.87%	acc@10: 48.58%	acc@20: 76.33%	acc@30: 90.25%	
[2023-12-16 09:21:03] INFO (nni/MainThread) Intermediate result: 17.650186699987902  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.668 | ed:0.997 | hr@1:0.635 | hr@2:0.864 | hr@3:0.909 | acc@1:0.635 | acc@2:0.578 | acc@3:0.539 | Best krc: 0.777 | Best epoch: 10
[2023-12-16 09:21:26] INFO (nni/MainThread) Intermediate result: 0.7698601827329419  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.36	mae: 13.47	mape: 89.68%	acc@10: 49.06%	acc@20: 77.07%	acc@30: 90.68%	
[2023-12-16 09:21:26] INFO (nni/MainThread) Intermediate result: 17.35560579143764  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.687 | ed:1.006 | hr@1:0.635 | hr@2:0.864 | hr@3:0.913 | acc@1:0.635 | acc@2:0.577 | acc@3:0.537 | Best krc: 0.777 | Best epoch: 10
[2023-12-16 09:21:49] INFO (nni/MainThread) Intermediate result: 0.7684565401399682  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.14	mae: 13.33	mape: 89.19%	acc@10: 49.07%	acc@20: 77.54%	acc@30: 91.11%	
[2023-12-16 09:21:49] INFO (nni/MainThread) Intermediate result: 17.138406973897407  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.646 | ed:0.954 | hr@1:0.639 | hr@2:0.865 | hr@3:0.913 | acc@1:0.639 | acc@2:0.586 | acc@3:0.555 | Best krc: 0.777 | Best epoch: 10
best model saved
[2023-12-16 09:22:13] INFO (nni/MainThread) Intermediate result: 0.7795190817053519  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 16.99	mae: 13.23	mape: 88.94%	acc@10: 49.21%	acc@20: 77.83%	acc@30: 91.36%	
[2023-12-16 09:22:13] INFO (nni/MainThread) Intermediate result: 16.98920095997075  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.684 | ed:1.026 | hr@1:0.631 | hr@2:0.863 | hr@3:0.909 | acc@1:0.631 | acc@2:0.572 | acc@3:0.532 | Best krc: 0.78 | Best epoch: 14
[2023-12-16 09:22:36] INFO (nni/MainThread) Intermediate result: 0.7629682160945825  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 16.8	mae: 13.1	mape: 88.23%	acc@10: 49.38%	acc@20: 78.26%	acc@30: 91.69%	
[2023-12-16 09:22:36] INFO (nni/MainThread) Intermediate result: 16.802214475704357  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.693 | ed:1.003 | hr@1:0.632 | hr@2:0.864 | hr@3:0.911 | acc@1:0.632 | acc@2:0.577 | acc@3:0.539 | Best krc: 0.78 | Best epoch: 14
[2023-12-16 09:22:59] INFO (nni/MainThread) Intermediate result: 0.7684862265623088  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 16.64	mae: 13.01	mape: 87.72%	acc@10: 49.48%	acc@20: 78.61%	acc@30: 92.0%	
[2023-12-16 09:22:59] INFO (nni/MainThread) Intermediate result: 16.644344540533556  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.678 | ed:0.952 | hr@1:0.645 | hr@2:0.863 | hr@3:0.912 | acc@1:0.645 | acc@2:0.591 | acc@3:0.56 | Best krc: 0.78 | Best epoch: 14
[2023-12-16 09:23:22] INFO (nni/MainThread) Intermediate result: 0.7774465315086215  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 16.49	mae: 12.91	mape: 87.21%	acc@10: 49.71%	acc@20: 78.97%	acc@30: 92.26%	
[2023-12-16 09:23:22] INFO (nni/MainThread) Intermediate result: 16.491639790611913  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.757 | lsd:0.699 | ed:1.013 | hr@1:0.635 | hr@2:0.86 | hr@3:0.909 | acc@1:0.635 | acc@2:0.577 | acc@3:0.538 | Best krc: 0.78 | Best epoch: 14
[2023-12-16 09:23:45] INFO (nni/MainThread) Intermediate result: 0.757104457672888  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.32	mae: 12.78	mape: 86.21%	acc@10: 50.08%	acc@20: 79.34%	acc@30: 92.53%	
[2023-12-16 09:23:45] INFO (nni/MainThread) Intermediate result: 16.32221277173285  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.703 | ed:1.002 | hr@1:0.632 | hr@2:0.86 | hr@3:0.907 | acc@1:0.632 | acc@2:0.582 | acc@3:0.545 | Best krc: 0.78 | Best epoch: 14
[2023-12-16 09:24:08] INFO (nni/MainThread) Intermediate result: 0.7613315599848175  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.2	mae: 12.7	mape: 85.93%	acc@10: 50.17%	acc@20: 79.59%	acc@30: 92.76%	
[2023-12-16 09:24:08] INFO (nni/MainThread) Intermediate result: 16.20305343659916  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.691 | ed:1.0 | hr@1:0.63 | hr@2:0.861 | hr@3:0.909 | acc@1:0.63 | acc@2:0.578 | acc@3:0.542 | Best krc: 0.78 | Best epoch: 14
[2023-12-16 09:24:31] INFO (nni/MainThread) Intermediate result: 0.7628083985845245  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.09	mae: 12.62	mape: 85.45%	acc@10: 50.32%	acc@20: 79.84%	acc@30: 92.98%	
[2023-12-16 09:24:31] INFO (nni/MainThread) Intermediate result: 16.08883348134284  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.7 | ed:0.979 | hr@1:0.635 | hr@2:0.866 | hr@3:0.912 | acc@1:0.635 | acc@2:0.584 | acc@3:0.554 | Best krc: 0.78 | Best epoch: 14
[2023-12-16 09:24:55] INFO (nni/MainThread) Intermediate result: 0.7724453149726432  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 15.98	mae: 12.54	mape: 84.95%	acc@10: 50.45%	acc@20: 80.12%	acc@30: 93.18%	
[2023-12-16 09:24:55] INFO (nni/MainThread) Intermediate result: 15.978647885634858  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.718 | ed:1.003 | hr@1:0.624 | hr@2:0.863 | hr@3:0.908 | acc@1:0.624 | acc@2:0.574 | acc@3:0.537 | Best krc: 0.78 | Best epoch: 14
[2023-12-16 09:25:18] INFO (nni/MainThread) Intermediate result: 0.7623432128285648  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 15.91	mae: 12.49	mape: 84.71%	acc@10: 50.58%	acc@20: 80.24%	acc@30: 93.25%	
[2023-12-16 09:25:18] INFO (nni/MainThread) Intermediate result: 15.90940878875591  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.717 | ed:0.993 | hr@1:0.63 | hr@2:0.861 | hr@3:0.909 | acc@1:0.63 | acc@2:0.574 | acc@3:0.539 | Best krc: 0.78 | Best epoch: 14
[2023-12-16 09:25:42] INFO (nni/MainThread) Intermediate result: 0.7658208247889052  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 15.82	mae: 12.42	mape: 84.25%	acc@10: 50.71%	acc@20: 80.45%	acc@30: 93.4%	
[2023-12-16 09:25:42] INFO (nni/MainThread) Intermediate result: 15.819585805228208  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.694 | ed:0.976 | hr@1:0.636 | hr@2:0.864 | hr@3:0.91 | acc@1:0.636 | acc@2:0.582 | acc@3:0.544 | Best krc: 0.78 | Best epoch: 14
[2023-12-16 09:26:05] INFO (nni/MainThread) Intermediate result: 0.7683850221585244  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 15.74	mae: 12.36	mape: 83.82%	acc@10: 50.86%	acc@20: 80.61%	acc@30: 93.53%	
[2023-12-16 09:26:05] INFO (nni/MainThread) Intermediate result: 15.738131643821701  (Index 49)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702714583.98314481702714583.9831583
best model loaded !!!
krc:0.772 | lsd:0.494 | ed:0.966 | hr@1:0.652 | hr@2:0.903 | hr@3:0.938 | acc@1:0.652 | acc@2:0.604 | acc@3:0.556 |

-------------------------------------------------------------
Best epoch for G2R:  14
Best epoch for ETPA:  24
graph2route_pd Evaluation in test: krc:0.772 | lsd:0.494 | ed:0.966 | hr@1:0.652 | hr@2:0.903 | hr@3:0.938 | acc@1:0.652 | acc@2:0.604 | acc@3:0.556 |
RankPETA Evaluation in test: rmse: 12.47	mae: 9.53	mape: 77.2%	acc@10: 65.4%	acc@20: 90.3%	acc@30: 97.47%	
