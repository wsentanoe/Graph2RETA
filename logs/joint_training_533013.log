Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.755 | lsd:0.732 | ed:1.056 | hr@1:0.62 | hr@2:0.857 | hr@3:0.904 | acc@1:0.62 | acc@2:0.555 | acc@3:0.521 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 16:36:50] INFO (nni/MainThread) Intermediate result: 0.7550882161288807  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 21.64	mae: 16.41	mape: 63.05%	acc@10: 39.26%	acc@20: 68.52%	acc@30: 84.81%	
[2023-12-01 16:36:50] INFO (nni/MainThread) Intermediate result: 21.64167063696757  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.716 | ed:1.041 | hr@1:0.625 | hr@2:0.86 | hr@3:0.905 | acc@1:0.625 | acc@2:0.566 | acc@3:0.528 | Best krc: 0.755 | Best epoch: 0
best model saved
[2023-12-01 16:38:44] INFO (nni/MainThread) Intermediate result: 0.7589562672990745  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 20.64	mae: 15.95	mape: 85.13%	acc@10: 40.19%	acc@20: 69.26%	acc@30: 84.44%	
[2023-12-01 16:38:44] INFO (nni/MainThread) Intermediate result: 20.642034609067963  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.653 | ed:0.992 | hr@1:0.634 | hr@2:0.865 | hr@3:0.912 | acc@1:0.634 | acc@2:0.576 | acc@3:0.54 | Best krc: 0.759 | Best epoch: 1
best model saved
[2023-12-01 16:40:39] INFO (nni/MainThread) Intermediate result: 0.7694634585321074  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 21.23	mae: 16.48	mape: 102.61%	acc@10: 38.15%	acc@20: 68.52%	acc@30: 83.58%	
[2023-12-01 16:40:39] INFO (nni/MainThread) Intermediate result: 21.226897951974962  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.674 | ed:0.974 | hr@1:0.629 | hr@2:0.864 | hr@3:0.913 | acc@1:0.629 | acc@2:0.574 | acc@3:0.544 | Best krc: 0.769 | Best epoch: 2
best model saved
[2023-12-01 16:42:33] INFO (nni/MainThread) Intermediate result: 0.7719731954712276  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 21.74	mae: 17.2	mape: 115.53%	acc@10: 35.46%	acc@20: 65.93%	acc@30: 82.13%	
[2023-12-01 16:42:33] INFO (nni/MainThread) Intermediate result: 21.735250479552167  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.784 | lsd:0.629 | ed:0.956 | hr@1:0.637 | hr@2:0.87 | hr@3:0.919 | acc@1:0.637 | acc@2:0.579 | acc@3:0.551 | Best krc: 0.772 | Best epoch: 3
best model saved
[2023-12-01 16:44:27] INFO (nni/MainThread) Intermediate result: 0.78422587016378  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 21.81	mae: 17.53	mape: 121.49%	acc@10: 33.41%	acc@20: 64.81%	acc@30: 82.0%	
[2023-12-01 16:44:27] INFO (nni/MainThread) Intermediate result: 21.814429054207753  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.712 | ed:0.997 | hr@1:0.655 | hr@2:0.866 | hr@3:0.911 | acc@1:0.655 | acc@2:0.593 | acc@3:0.548 | Best krc: 0.784 | Best epoch: 4
[2023-12-01 16:46:22] INFO (nni/MainThread) Intermediate result: 0.7737981126874874  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 22.07	mae: 17.75	mape: 125.38%	acc@10: 32.84%	acc@20: 64.14%	acc@30: 81.67%	
[2023-12-01 16:46:22] INFO (nni/MainThread) Intermediate result: 22.068657590929977  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.795 | lsd:0.644 | ed:0.914 | hr@1:0.666 | hr@2:0.866 | hr@3:0.917 | acc@1:0.666 | acc@2:0.607 | acc@3:0.577 | Best krc: 0.784 | Best epoch: 4
best model saved
[2023-12-01 16:48:19] INFO (nni/MainThread) Intermediate result: 0.7954544841383494  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 21.77	mae: 17.51	mape: 125.22%	acc@10: 33.76%	acc@20: 64.97%	acc@30: 82.28%	
[2023-12-01 16:48:19] INFO (nni/MainThread) Intermediate result: 21.7732510423835  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.781 | lsd:0.629 | ed:0.951 | hr@1:0.642 | hr@2:0.871 | hr@3:0.916 | acc@1:0.642 | acc@2:0.589 | acc@3:0.555 | Best krc: 0.795 | Best epoch: 6
[2023-12-01 16:50:12] INFO (nni/MainThread) Intermediate result: 0.7807867146214325  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 21.39	mae: 17.21	mape: 124.5%	acc@10: 34.49%	acc@20: 65.69%	acc@30: 82.92%	
[2023-12-01 16:50:12] INFO (nni/MainThread) Intermediate result: 21.38880140974764  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.601 | ed:0.875 | hr@1:0.699 | hr@2:0.876 | hr@3:0.923 | acc@1:0.699 | acc@2:0.634 | acc@3:0.602 | Best krc: 0.795 | Best epoch: 6
best model saved
[2023-12-01 16:52:08] INFO (nni/MainThread) Intermediate result: 0.807702152905476  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 21.43	mae: 17.3	mape: 125.91%	acc@10: 34.12%	acc@20: 64.98%	acc@30: 82.8%	
[2023-12-01 16:52:08] INFO (nni/MainThread) Intermediate result: 21.43413133011732  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.623 | ed:0.902 | hr@1:0.684 | hr@2:0.876 | hr@3:0.92 | acc@1:0.684 | acc@2:0.631 | acc@3:0.595 | Best krc: 0.808 | Best epoch: 8
[2023-12-01 16:54:10] INFO (nni/MainThread) Intermediate result: 0.7994561178994932  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 21.07	mae: 17.03	mape: 124.69%	acc@10: 34.44%	acc@20: 65.78%	acc@30: 83.63%	
[2023-12-01 16:54:10] INFO (nni/MainThread) Intermediate result: 21.070363084517954  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.812 | lsd:0.59 | ed:0.871 | hr@1:0.715 | hr@2:0.875 | hr@3:0.924 | acc@1:0.715 | acc@2:0.644 | acc@3:0.613 | Best krc: 0.808 | Best epoch: 8
best model saved
[2023-12-01 16:56:18] INFO (nni/MainThread) Intermediate result: 0.8115078560203176  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 20.9	mae: 16.93	mape: 124.59%	acc@10: 34.58%	acc@20: 65.86%	acc@30: 84.14%	
[2023-12-01 16:56:18] INFO (nni/MainThread) Intermediate result: 20.895670611895834  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.813 | lsd:0.578 | ed:0.874 | hr@1:0.714 | hr@2:0.882 | hr@3:0.929 | acc@1:0.714 | acc@2:0.646 | acc@3:0.614 | Best krc: 0.812 | Best epoch: 10
best model saved
[2023-12-01 16:58:20] INFO (nni/MainThread) Intermediate result: 0.8125464439850096  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 20.75	mae: 16.84	mape: 124.78%	acc@10: 34.54%	acc@20: 66.08%	acc@30: 84.41%	
[2023-12-01 16:58:20] INFO (nni/MainThread) Intermediate result: 20.75133841859477  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.812 | lsd:0.594 | ed:0.875 | hr@1:0.719 | hr@2:0.873 | hr@3:0.928 | acc@1:0.719 | acc@2:0.641 | acc@3:0.612 | Best krc: 0.813 | Best epoch: 11
[2023-12-01 17:00:21] INFO (nni/MainThread) Intermediate result: 0.8123808857258792  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 20.49	mae: 16.64	mape: 123.71%	acc@10: 34.73%	acc@20: 66.72%	acc@30: 85.13%	
[2023-12-01 17:00:21] INFO (nni/MainThread) Intermediate result: 20.49316050601807  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.807 | lsd:0.633 | ed:0.887 | hr@1:0.741 | hr@2:0.862 | hr@3:0.92 | acc@1:0.741 | acc@2:0.642 | acc@3:0.61 | Best krc: 0.813 | Best epoch: 11
[2023-12-01 17:02:27] INFO (nni/MainThread) Intermediate result: 0.8066438508939603  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 20.14	mae: 16.35	mape: 121.62%	acc@10: 35.61%	acc@20: 67.46%	acc@30: 85.82%	
[2023-12-01 17:02:27] INFO (nni/MainThread) Intermediate result: 20.141103142511355  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.784 | lsd:0.648 | ed:0.953 | hr@1:0.69 | hr@2:0.862 | hr@3:0.912 | acc@1:0.69 | acc@2:0.617 | acc@3:0.574 | Best krc: 0.813 | Best epoch: 11
[2023-12-01 17:04:34] INFO (nni/MainThread) Intermediate result: 0.7840053590031727  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 19.96	mae: 16.2	mape: 120.61%	acc@10: 35.93%	acc@20: 68.0%	acc@30: 86.07%	
[2023-12-01 17:04:34] INFO (nni/MainThread) Intermediate result: 19.955191159768553  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.809 | lsd:0.609 | ed:0.893 | hr@1:0.697 | hr@2:0.871 | hr@3:0.923 | acc@1:0.697 | acc@2:0.626 | acc@3:0.596 | Best krc: 0.813 | Best epoch: 11
[2023-12-01 17:06:29] INFO (nni/MainThread) Intermediate result: 0.8093037465053204  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 19.72	mae: 16.01	mape: 119.32%	acc@10: 36.27%	acc@20: 68.52%	acc@30: 86.6%	
[2023-12-01 17:06:29] INFO (nni/MainThread) Intermediate result: 19.7240635204565  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.805 | lsd:0.63 | ed:0.915 | hr@1:0.715 | hr@2:0.875 | hr@3:0.92 | acc@1:0.715 | acc@2:0.641 | acc@3:0.601 | Best krc: 0.813 | Best epoch: 11
[2023-12-01 17:08:31] INFO (nni/MainThread) Intermediate result: 0.8049400113239203  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 19.53	mae: 15.87	mape: 118.34%	acc@10: 36.64%	acc@20: 68.8%	acc@30: 87.12%	
[2023-12-01 17:08:31] INFO (nni/MainThread) Intermediate result: 19.526482915324795  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.816 | lsd:0.587 | ed:0.874 | hr@1:0.721 | hr@2:0.872 | hr@3:0.922 | acc@1:0.721 | acc@2:0.645 | acc@3:0.611 | Best krc: 0.813 | Best epoch: 11
best model saved
[2023-12-01 17:10:28] INFO (nni/MainThread) Intermediate result: 0.8157903415795852  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 19.37	mae: 15.73	mape: 117.44%	acc@10: 36.83%	acc@20: 69.22%	acc@30: 87.43%	
[2023-12-01 17:10:28] INFO (nni/MainThread) Intermediate result: 19.365770233552816  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.823 | lsd:0.576 | ed:0.847 | hr@1:0.73 | hr@2:0.881 | hr@3:0.927 | acc@1:0.73 | acc@2:0.657 | acc@3:0.625 | Best krc: 0.816 | Best epoch: 17
best model saved
[2023-12-01 17:12:26] INFO (nni/MainThread) Intermediate result: 0.8225942601019121  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 19.27	mae: 15.68	mape: 117.28%	acc@10: 36.8%	acc@20: 69.32%	acc@30: 87.76%	
[2023-12-01 17:12:26] INFO (nni/MainThread) Intermediate result: 19.27491347598227  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.821 | lsd:0.582 | ed:0.847 | hr@1:0.753 | hr@2:0.869 | hr@3:0.922 | acc@1:0.753 | acc@2:0.66 | acc@3:0.625 | Best krc: 0.823 | Best epoch: 18
[2023-12-01 17:14:21] INFO (nni/MainThread) Intermediate result: 0.8213140332598138  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 19.17	mae: 15.61	mape: 116.72%	acc@10: 36.93%	acc@20: 69.56%	acc@30: 88.0%	
[2023-12-01 17:14:22] INFO (nni/MainThread) Intermediate result: 19.172492826979166  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.819 | lsd:0.602 | ed:0.863 | hr@1:0.745 | hr@2:0.869 | hr@3:0.923 | acc@1:0.745 | acc@2:0.654 | acc@3:0.619 | Best krc: 0.823 | Best epoch: 18
[2023-12-01 17:16:20] INFO (nni/MainThread) Intermediate result: 0.8187990871943648  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 19.07	mae: 15.52	mape: 116.11%	acc@10: 37.13%	acc@20: 69.86%	acc@30: 88.24%	
[2023-12-01 17:16:21] INFO (nni/MainThread) Intermediate result: 19.06573231553275  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.584 | ed:0.875 | hr@1:0.711 | hr@2:0.88 | hr@3:0.92 | acc@1:0.711 | acc@2:0.646 | acc@3:0.603 | Best krc: 0.823 | Best epoch: 18
[2023-12-01 17:18:15] INFO (nni/MainThread) Intermediate result: 0.8111596172374484  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 18.9	mae: 15.39	mape: 115.08%	acc@10: 37.47%	acc@20: 70.34%	acc@30: 88.59%	
[2023-12-01 17:18:15] INFO (nni/MainThread) Intermediate result: 18.90179783591946  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.821 | lsd:0.57 | ed:0.851 | hr@1:0.725 | hr@2:0.88 | hr@3:0.928 | acc@1:0.725 | acc@2:0.652 | acc@3:0.619 | Best krc: 0.823 | Best epoch: 18
[2023-12-01 17:20:21] INFO (nni/MainThread) Intermediate result: 0.8213171838445122  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 18.74	mae: 15.26	mape: 113.97%	acc@10: 37.92%	acc@20: 70.79%	acc@30: 88.86%	
[2023-12-01 17:20:21] INFO (nni/MainThread) Intermediate result: 18.74126126847219  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.812 | lsd:0.596 | ed:0.874 | hr@1:0.707 | hr@2:0.881 | hr@3:0.922 | acc@1:0.707 | acc@2:0.642 | acc@3:0.605 | Best krc: 0.823 | Best epoch: 18
[2023-12-01 17:22:14] INFO (nni/MainThread) Intermediate result: 0.8123570219153953  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 18.6	mae: 15.16	mape: 113.16%	acc@10: 38.12%	acc@20: 71.05%	acc@30: 89.17%	
[2023-12-01 17:22:14] INFO (nni/MainThread) Intermediate result: 18.604985973105606  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.593 | ed:0.884 | hr@1:0.728 | hr@2:0.878 | hr@3:0.919 | acc@1:0.728 | acc@2:0.652 | acc@3:0.606 | Best krc: 0.823 | Best epoch: 18
[2023-12-01 17:24:07] INFO (nni/MainThread) Intermediate result: 0.8080923627053928  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 18.54	mae: 15.11	mape: 112.79%	acc@10: 38.15%	acc@20: 71.33%	acc@30: 89.26%	
[2023-12-01 17:24:07] INFO (nni/MainThread) Intermediate result: 18.54094861705897  (Index 49)
*** Epoch: 25 ***
