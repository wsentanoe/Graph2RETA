Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 8888,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.749 | lsd:0.749 | ed:1.035 | hr@1:0.625 | hr@2:0.848 | hr@3:0.902 | acc@1:0.625 | acc@2:0.568 | acc@3:0.529 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-18 11:05:04] INFO (nni/MainThread) Intermediate result: 0.7488070836999564  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.58	mae: 18.92	mape: 65.61%	acc@10: 32.22%	acc@20: 62.96%	acc@30: 80.0%	
[2023-12-18 11:05:04] INFO (nni/MainThread) Intermediate result: 24.579453536090107  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.756 | lsd:0.735 | ed:1.014 | hr@1:0.632 | hr@2:0.855 | hr@3:0.904 | acc@1:0.632 | acc@2:0.575 | acc@3:0.534 | Best krc: 0.749 | Best epoch: 0
best model saved
[2023-12-18 11:05:31] INFO (nni/MainThread) Intermediate result: 0.7564673992220998  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 24.42	mae: 17.95	mape: 87.49%	acc@10: 38.7%	acc@20: 67.78%	acc@30: 81.48%	
[2023-12-18 11:05:31] INFO (nni/MainThread) Intermediate result: 24.41772215453521  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.756 | lsd:0.719 | ed:1.026 | hr@1:0.624 | hr@2:0.853 | hr@3:0.904 | acc@1:0.624 | acc@2:0.561 | acc@3:0.523 | Best krc: 0.756 | Best epoch: 1
[2023-12-18 11:05:58] INFO (nni/MainThread) Intermediate result: 0.7556393241570328  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 23.16	mae: 17.12	mape: 94.65%	acc@10: 40.74%	acc@20: 69.63%	acc@30: 83.46%	
[2023-12-18 11:05:58] INFO (nni/MainThread) Intermediate result: 23.15689781643925  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.693 | ed:1.007 | hr@1:0.628 | hr@2:0.859 | hr@3:0.908 | acc@1:0.628 | acc@2:0.569 | acc@3:0.532 | Best krc: 0.756 | Best epoch: 1
best model saved
[2023-12-18 11:06:27] INFO (nni/MainThread) Intermediate result: 0.7621402969894443  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 21.85	mae: 16.42	mape: 96.28%	acc@10: 41.11%	acc@20: 70.93%	acc@30: 84.91%	
[2023-12-18 11:06:27] INFO (nni/MainThread) Intermediate result: 21.85126461944834  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.706 | ed:1.015 | hr@1:0.632 | hr@2:0.858 | hr@3:0.906 | acc@1:0.632 | acc@2:0.574 | acc@3:0.533 | Best krc: 0.762 | Best epoch: 3
best model saved
[2023-12-18 11:06:55] INFO (nni/MainThread) Intermediate result: 0.7630332258229064  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 21.13	mae: 16.1	mape: 98.77%	acc@10: 40.52%	acc@20: 71.48%	acc@30: 85.78%	
[2023-12-18 11:06:55] INFO (nni/MainThread) Intermediate result: 21.128701829129078  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.698 | ed:1.009 | hr@1:0.631 | hr@2:0.859 | hr@3:0.907 | acc@1:0.631 | acc@2:0.575 | acc@3:0.538 | Best krc: 0.763 | Best epoch: 4
[2023-12-18 11:07:24] INFO (nni/MainThread) Intermediate result: 0.7593214490897043  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 20.4	mae: 15.64	mape: 98.62%	acc@10: 41.36%	acc@20: 72.35%	acc@30: 86.79%	
[2023-12-18 11:07:24] INFO (nni/MainThread) Intermediate result: 20.402475701016087  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.671 | ed:0.981 | hr@1:0.638 | hr@2:0.862 | hr@3:0.908 | acc@1:0.638 | acc@2:0.583 | acc@3:0.542 | Best krc: 0.763 | Best epoch: 4
best model saved
[2023-12-18 11:07:53] INFO (nni/MainThread) Intermediate result: 0.7717578313118323  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 19.78	mae: 15.21	mape: 97.99%	acc@10: 42.54%	acc@20: 73.44%	acc@30: 87.67%	
[2023-12-18 11:07:53] INFO (nni/MainThread) Intermediate result: 19.78071807838255  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.683 | ed:1.014 | hr@1:0.63 | hr@2:0.861 | hr@3:0.91 | acc@1:0.63 | acc@2:0.573 | acc@3:0.533 | Best krc: 0.772 | Best epoch: 6
[2023-12-18 11:08:20] INFO (nni/MainThread) Intermediate result: 0.7640417076971515  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.2	mae: 14.83	mape: 96.8%	acc@10: 42.82%	acc@20: 74.49%	acc@30: 88.7%	
[2023-12-18 11:08:20] INFO (nni/MainThread) Intermediate result: 19.202051636396842  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.696 | ed:0.995 | hr@1:0.638 | hr@2:0.862 | hr@3:0.91 | acc@1:0.638 | acc@2:0.583 | acc@3:0.541 | Best krc: 0.772 | Best epoch: 6
[2023-12-18 11:08:49] INFO (nni/MainThread) Intermediate result: 0.7680909115014931  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.73	mae: 14.51	mape: 95.78%	acc@10: 43.37%	acc@20: 75.51%	acc@30: 89.51%	
[2023-12-18 11:08:49] INFO (nni/MainThread) Intermediate result: 18.732828644468633  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.695 | ed:1.004 | hr@1:0.641 | hr@2:0.862 | hr@3:0.908 | acc@1:0.641 | acc@2:0.585 | acc@3:0.54 | Best krc: 0.772 | Best epoch: 6
[2023-12-18 11:09:17] INFO (nni/MainThread) Intermediate result: 0.769378539968833  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.38	mae: 14.27	mape: 94.98%	acc@10: 43.85%	acc@20: 76.22%	acc@30: 90.0%	
[2023-12-18 11:09:17] INFO (nni/MainThread) Intermediate result: 18.376593175554607  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.755 | lsd:0.738 | ed:1.062 | hr@1:0.631 | hr@2:0.856 | hr@3:0.904 | acc@1:0.631 | acc@2:0.568 | acc@3:0.519 | Best krc: 0.772 | Best epoch: 6
[2023-12-18 11:09:45] INFO (nni/MainThread) Intermediate result: 0.755076098495425  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 18.1	mae: 14.06	mape: 94.06%	acc@10: 44.44%	acc@20: 77.0%	acc@30: 90.37%	
[2023-12-18 11:09:45] INFO (nni/MainThread) Intermediate result: 18.09692123537265  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.675 | ed:0.992 | hr@1:0.639 | hr@2:0.864 | hr@3:0.911 | acc@1:0.639 | acc@2:0.584 | acc@3:0.544 | Best krc: 0.772 | Best epoch: 6
[2023-12-18 11:10:14] INFO (nni/MainThread) Intermediate result: 0.7693037054121445  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.82	mae: 13.86	mape: 93.12%	acc@10: 44.81%	acc@20: 77.44%	acc@30: 90.77%	
[2023-12-18 11:10:14] INFO (nni/MainThread) Intermediate result: 17.818808813432405  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.67 | ed:0.971 | hr@1:0.645 | hr@2:0.86 | hr@3:0.914 | acc@1:0.645 | acc@2:0.586 | acc@3:0.553 | Best krc: 0.772 | Best epoch: 6
best model saved
[2023-12-18 11:10:42] INFO (nni/MainThread) Intermediate result: 0.7717615737029816  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.55	mae: 13.64	mape: 91.55%	acc@10: 45.7%	acc@20: 77.89%	acc@30: 91.05%	
[2023-12-18 11:10:42] INFO (nni/MainThread) Intermediate result: 17.553271295880233  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.698 | ed:1.022 | hr@1:0.628 | hr@2:0.86 | hr@3:0.909 | acc@1:0.628 | acc@2:0.57 | acc@3:0.53 | Best krc: 0.772 | Best epoch: 12
[2023-12-18 11:11:09] INFO (nni/MainThread) Intermediate result: 0.7623121700078412  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.47	mae: 13.58	mape: 91.77%	acc@10: 45.77%	acc@20: 78.12%	acc@30: 91.01%	
[2023-12-18 11:11:09] INFO (nni/MainThread) Intermediate result: 17.469015141089177  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.702 | ed:1.012 | hr@1:0.635 | hr@2:0.867 | hr@3:0.911 | acc@1:0.635 | acc@2:0.579 | acc@3:0.54 | Best krc: 0.772 | Best epoch: 12
[2023-12-18 11:11:37] INFO (nni/MainThread) Intermediate result: 0.7662110248817726  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.36	mae: 13.5	mape: 91.58%	acc@10: 45.93%	acc@20: 78.3%	acc@30: 91.09%	
[2023-12-18 11:11:37] INFO (nni/MainThread) Intermediate result: 17.35542811742295  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.65 | ed:0.962 | hr@1:0.646 | hr@2:0.866 | hr@3:0.913 | acc@1:0.646 | acc@2:0.59 | acc@3:0.555 | Best krc: 0.772 | Best epoch: 12
best model saved
[2023-12-18 11:12:06] INFO (nni/MainThread) Intermediate result: 0.7785407360134076  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 17.2	mae: 13.38	mape: 90.81%	acc@10: 46.37%	acc@20: 78.61%	acc@30: 91.2%	
[2023-12-18 11:12:06] INFO (nni/MainThread) Intermediate result: 17.202034635390017  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.675 | ed:0.979 | hr@1:0.635 | hr@2:0.862 | hr@3:0.908 | acc@1:0.635 | acc@2:0.581 | acc@3:0.544 | Best krc: 0.779 | Best epoch: 15
[2023-12-18 11:12:34] INFO (nni/MainThread) Intermediate result: 0.7703679711113031  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 17.04	mae: 13.25	mape: 89.85%	acc@10: 46.95%	acc@20: 78.78%	acc@30: 91.37%	
[2023-12-18 11:12:34] INFO (nni/MainThread) Intermediate result: 17.044855160588543  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.679 | ed:0.991 | hr@1:0.631 | hr@2:0.865 | hr@3:0.911 | acc@1:0.631 | acc@2:0.582 | acc@3:0.545 | Best krc: 0.779 | Best epoch: 15
[2023-12-18 11:13:01] INFO (nni/MainThread) Intermediate result: 0.7690514314913092  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 16.91	mae: 13.15	mape: 89.18%	acc@10: 47.2%	acc@20: 79.12%	acc@30: 91.54%	
[2023-12-18 11:13:01] INFO (nni/MainThread) Intermediate result: 16.90697590791633  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.677 | ed:0.974 | hr@1:0.636 | hr@2:0.864 | hr@3:0.913 | acc@1:0.636 | acc@2:0.579 | acc@3:0.545 | Best krc: 0.779 | Best epoch: 15
[2023-12-18 11:13:28] INFO (nni/MainThread) Intermediate result: 0.7742578097540932  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.77	mae: 13.06	mape: 88.6%	acc@10: 47.6%	acc@20: 79.3%	acc@30: 91.72%	
[2023-12-18 11:13:28] INFO (nni/MainThread) Intermediate result: 16.772965862697774  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.668 | ed:0.979 | hr@1:0.637 | hr@2:0.866 | hr@3:0.913 | acc@1:0.637 | acc@2:0.584 | acc@3:0.547 | Best krc: 0.779 | Best epoch: 15
[2023-12-18 11:13:54] INFO (nni/MainThread) Intermediate result: 0.7757867312043089  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.66	mae: 12.98	mape: 88.07%	acc@10: 47.91%	acc@20: 79.5%	acc@30: 91.85%	
[2023-12-18 11:13:54] INFO (nni/MainThread) Intermediate result: 16.65670949229379  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.675 | ed:0.97 | hr@1:0.641 | hr@2:0.865 | hr@3:0.91 | acc@1:0.641 | acc@2:0.589 | acc@3:0.553 | Best krc: 0.779 | Best epoch: 15
[2023-12-18 11:14:22] INFO (nni/MainThread) Intermediate result: 0.7728133726384709  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.52	mae: 12.87	mape: 86.95%	acc@10: 48.32%	acc@20: 79.75%	acc@30: 92.03%	
[2023-12-18 11:14:22] INFO (nni/MainThread) Intermediate result: 16.522951820989235  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.674 | ed:1.004 | hr@1:0.638 | hr@2:0.865 | hr@3:0.91 | acc@1:0.638 | acc@2:0.581 | acc@3:0.541 | Best krc: 0.779 | Best epoch: 15
[2023-12-18 11:14:48] INFO (nni/MainThread) Intermediate result: 0.7649806615350997  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.42	mae: 12.78	mape: 86.35%	acc@10: 48.69%	acc@20: 79.88%	acc@30: 92.15%	
[2023-12-18 11:14:48] INFO (nni/MainThread) Intermediate result: 16.41885840548467  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.699 | ed:1.024 | hr@1:0.629 | hr@2:0.864 | hr@3:0.908 | acc@1:0.629 | acc@2:0.574 | acc@3:0.529 | Best krc: 0.779 | Best epoch: 15
[2023-12-18 11:15:16] INFO (nni/MainThread) Intermediate result: 0.7613178329225553  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.31	mae: 12.71	mape: 85.66%	acc@10: 48.95%	acc@20: 80.06%	acc@30: 92.27%	
[2023-12-18 11:15:16] INFO (nni/MainThread) Intermediate result: 16.314897810376383  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.705 | ed:0.99 | hr@1:0.641 | hr@2:0.867 | hr@3:0.908 | acc@1:0.641 | acc@2:0.589 | acc@3:0.548 | Best krc: 0.779 | Best epoch: 15
[2023-12-18 11:15:43] INFO (nni/MainThread) Intermediate result: 0.7701716392402881  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 16.2	mae: 12.62	mape: 84.77%	acc@10: 49.21%	acc@20: 80.39%	acc@30: 92.44%	
[2023-12-18 11:15:43] INFO (nni/MainThread) Intermediate result: 16.19761431048444  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.67 | ed:0.983 | hr@1:0.638 | hr@2:0.868 | hr@3:0.911 | acc@1:0.638 | acc@2:0.585 | acc@3:0.548 | Best krc: 0.779 | Best epoch: 15
[2023-12-18 11:16:10] INFO (nni/MainThread) Intermediate result: 0.7738625962937288  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 16.11	mae: 12.56	mape: 84.47%	acc@10: 49.33%	acc@20: 80.53%	acc@30: 92.59%	
[2023-12-18 11:16:10] INFO (nni/MainThread) Intermediate result: 16.109411022094097  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.664 | ed:0.979 | hr@1:0.643 | hr@2:0.868 | hr@3:0.909 | acc@1:0.643 | acc@2:0.588 | acc@3:0.543 | Best krc: 0.779 | Best epoch: 15
[2023-12-18 11:16:38] INFO (nni/MainThread) Intermediate result: 0.7719274820630307  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 16.01	mae: 12.49	mape: 83.72%	acc@10: 49.62%	acc@20: 80.75%	acc@30: 92.74%	
[2023-12-18 11:16:38] INFO (nni/MainThread) Intermediate result: 16.014619244425244  (Index 51)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702893878.24489261702893878.2449052
best model loaded !!!
krc:0.769 | lsd:0.488 | ed:0.999 | hr@1:0.659 | hr@2:0.9 | hr@3:0.934 | acc@1:0.659 | acc@2:0.605 | acc@3:0.55 |

-------------------------------------------------------------
Best epoch for G2R:  15
Best epoch for ETPA:  25
graph2route_pd Evaluation in test: krc:0.769 | lsd:0.488 | ed:0.999 | hr@1:0.659 | hr@2:0.9 | hr@3:0.934 | acc@1:0.659 | acc@2:0.605 | acc@3:0.55 |
RankPETA Evaluation in test: rmse: 12.98	mae: 10.5	mape: 96.31%	acc@10: 57.38%	acc@20: 88.61%	acc@30: 97.47%	
