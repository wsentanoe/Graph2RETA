Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 100,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 1999,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.688 | lsd:0.98 | ed:1.233 | hr@1:0.595 | hr@2:0.817 | hr@3:0.871 | acc@1:0.595 | acc@2:0.516 | acc@3:0.463 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-05 17:49:31] INFO (nni/MainThread) Intermediate result: 0.6877696363135805  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 26.66	mae: 21.05	mape: 67.09%	acc@10: 28.89%	acc@20: 55.19%	acc@30: 76.67%	
[2023-12-05 17:49:31] INFO (nni/MainThread) Intermediate result: 26.66032423252939  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.739 | lsd:0.771 | ed:1.09 | hr@1:0.621 | hr@2:0.849 | hr@3:0.894 | acc@1:0.621 | acc@2:0.553 | acc@3:0.509 | Best krc: 0.688 | Best epoch: 0
best model saved
[2023-12-05 17:51:09] INFO (nni/MainThread) Intermediate result: 0.7385126098374896  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 24.46	mae: 19.51	mape: 101.89%	acc@10: 31.48%	acc@20: 57.59%	acc@30: 80.74%	
[2023-12-05 17:51:09] INFO (nni/MainThread) Intermediate result: 24.461925704461134  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.7 | ed:1.018 | hr@1:0.627 | hr@2:0.857 | hr@3:0.906 | acc@1:0.627 | acc@2:0.571 | acc@3:0.536 | Best krc: 0.739 | Best epoch: 1
best model saved
[2023-12-05 17:52:46] INFO (nni/MainThread) Intermediate result: 0.7606256112508846  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 23.67	mae: 18.94	mape: 112.49%	acc@10: 31.6%	acc@20: 60.62%	acc@30: 80.62%	
[2023-12-05 17:52:46] INFO (nni/MainThread) Intermediate result: 23.665973040141846  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.7 | ed:1.004 | hr@1:0.634 | hr@2:0.864 | hr@3:0.912 | acc@1:0.634 | acc@2:0.575 | acc@3:0.538 | Best krc: 0.761 | Best epoch: 2
best model saved
[2023-12-05 17:54:32] INFO (nni/MainThread) Intermediate result: 0.7632828089496213  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 23.19	mae: 18.67	mape: 118.3%	acc@10: 31.94%	acc@20: 60.93%	acc@30: 81.02%	
[2023-12-05 17:54:32] INFO (nni/MainThread) Intermediate result: 23.194491036569296  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.686 | ed:1.01 | hr@1:0.628 | hr@2:0.862 | hr@3:0.907 | acc@1:0.628 | acc@2:0.569 | acc@3:0.533 | Best krc: 0.763 | Best epoch: 3
[2023-12-05 17:56:10] INFO (nni/MainThread) Intermediate result: 0.762711845475291  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 23.17	mae: 18.5	mape: 120.61%	acc@10: 32.89%	acc@20: 61.85%	acc@30: 81.19%	
[2023-12-05 17:56:10] INFO (nni/MainThread) Intermediate result: 23.167026162050405  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.67 | ed:0.994 | hr@1:0.635 | hr@2:0.864 | hr@3:0.912 | acc@1:0.635 | acc@2:0.575 | acc@3:0.537 | Best krc: 0.763 | Best epoch: 3
best model saved
[2023-12-05 17:57:47] INFO (nni/MainThread) Intermediate result: 0.7702025950211345  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 22.85	mae: 18.29	mape: 122.4%	acc@10: 33.21%	acc@20: 61.91%	acc@30: 81.98%	
[2023-12-05 17:57:47] INFO (nni/MainThread) Intermediate result: 22.849681548367926  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.672 | ed:0.998 | hr@1:0.649 | hr@2:0.865 | hr@3:0.911 | acc@1:0.649 | acc@2:0.593 | acc@3:0.547 | Best krc: 0.77 | Best epoch: 5
best model saved
[2023-12-05 17:59:24] INFO (nni/MainThread) Intermediate result: 0.7751179310252331  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 22.12	mae: 17.62	mape: 119.13%	acc@10: 34.92%	acc@20: 64.23%	acc@30: 82.65%	
[2023-12-05 17:59:24] INFO (nni/MainThread) Intermediate result: 22.118429179166  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.787 | lsd:0.642 | ed:0.962 | hr@1:0.669 | hr@2:0.868 | hr@3:0.913 | acc@1:0.669 | acc@2:0.608 | acc@3:0.565 | Best krc: 0.775 | Best epoch: 6
best model saved
[2023-12-05 18:01:05] INFO (nni/MainThread) Intermediate result: 0.7866768500087258  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 21.61	mae: 17.18	mape: 117.42%	acc@10: 36.06%	acc@20: 65.56%	acc@30: 83.38%	
[2023-12-05 18:01:05] INFO (nni/MainThread) Intermediate result: 21.606253594926255  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.787 | lsd:0.67 | ed:0.96 | hr@1:0.676 | hr@2:0.865 | hr@3:0.912 | acc@1:0.676 | acc@2:0.613 | acc@3:0.573 | Best krc: 0.787 | Best epoch: 7
[2023-12-05 18:02:45] INFO (nni/MainThread) Intermediate result: 0.7865741636620517  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 20.85	mae: 16.55	mape: 113.16%	acc@10: 37.9%	acc@20: 67.45%	acc@30: 84.69%	
[2023-12-05 18:02:45] INFO (nni/MainThread) Intermediate result: 20.84548812572901  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.796 | lsd:0.63 | ed:0.941 | hr@1:0.686 | hr@2:0.868 | hr@3:0.916 | acc@1:0.686 | acc@2:0.619 | acc@3:0.581 | Best krc: 0.787 | Best epoch: 7
best model saved
[2023-12-05 18:04:22] INFO (nni/MainThread) Intermediate result: 0.7964778857476715  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 20.18	mae: 16.02	mape: 109.35%	acc@10: 39.56%	acc@20: 69.15%	acc@30: 85.93%	
[2023-12-05 18:04:22] INFO (nni/MainThread) Intermediate result: 20.18424447260165  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.806 | lsd:0.618 | ed:0.912 | hr@1:0.697 | hr@2:0.871 | hr@3:0.919 | acc@1:0.697 | acc@2:0.624 | acc@3:0.593 | Best krc: 0.796 | Best epoch: 9
best model saved
[2023-12-05 18:06:00] INFO (nni/MainThread) Intermediate result: 0.8060701739757271  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 19.96	mae: 15.85	mape: 109.27%	acc@10: 39.93%	acc@20: 69.29%	acc@30: 86.4%	
[2023-12-05 18:06:00] INFO (nni/MainThread) Intermediate result: 19.963765278581274  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.62 | ed:0.927 | hr@1:0.684 | hr@2:0.872 | hr@3:0.92 | acc@1:0.684 | acc@2:0.618 | acc@3:0.581 | Best krc: 0.806 | Best epoch: 10
[2023-12-05 18:07:37] INFO (nni/MainThread) Intermediate result: 0.7990533394118878  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 19.53	mae: 15.51	mape: 107.51%	acc@10: 40.65%	acc@20: 70.52%	acc@30: 87.13%	
[2023-12-05 18:07:37] INFO (nni/MainThread) Intermediate result: 19.53452124273489  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.795 | lsd:0.63 | ed:0.944 | hr@1:0.686 | hr@2:0.872 | hr@3:0.92 | acc@1:0.686 | acc@2:0.613 | acc@3:0.58 | Best krc: 0.806 | Best epoch: 10
[2023-12-05 18:09:17] INFO (nni/MainThread) Intermediate result: 0.7951850300341774  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 19.13	mae: 15.18	mape: 105.21%	acc@10: 41.54%	acc@20: 71.57%	acc@30: 87.81%	
[2023-12-05 18:09:17] INFO (nni/MainThread) Intermediate result: 19.134238877113336  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.798 | lsd:0.625 | ed:0.928 | hr@1:0.688 | hr@2:0.868 | hr@3:0.918 | acc@1:0.688 | acc@2:0.618 | acc@3:0.584 | Best krc: 0.806 | Best epoch: 10
[2023-12-05 18:10:56] INFO (nni/MainThread) Intermediate result: 0.7980238048886934  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 18.96	mae: 15.05	mape: 105.08%	acc@10: 41.67%	acc@20: 71.83%	acc@30: 88.2%	
[2023-12-05 18:10:56] INFO (nni/MainThread) Intermediate result: 18.955173446244608  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.792 | lsd:0.675 | ed:0.963 | hr@1:0.715 | hr@2:0.858 | hr@3:0.914 | acc@1:0.715 | acc@2:0.621 | acc@3:0.582 | Best krc: 0.806 | Best epoch: 10
[2023-12-05 18:12:32] INFO (nni/MainThread) Intermediate result: 0.792204383415577  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 18.65	mae: 14.81	mape: 103.47%	acc@10: 42.47%	acc@20: 72.49%	acc@30: 88.69%	
[2023-12-05 18:12:33] INFO (nni/MainThread) Intermediate result: 18.654400587761927  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.797 | lsd:0.658 | ed:0.953 | hr@1:0.711 | hr@2:0.862 | hr@3:0.913 | acc@1:0.711 | acc@2:0.627 | acc@3:0.583 | Best krc: 0.806 | Best epoch: 10
[2023-12-05 18:14:10] INFO (nni/MainThread) Intermediate result: 0.7969273079023844  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 18.39	mae: 14.59	mape: 102.14%	acc@10: 43.08%	acc@20: 73.22%	acc@30: 89.1%	
[2023-12-05 18:14:10] INFO (nni/MainThread) Intermediate result: 18.38797733639445  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.795 | lsd:0.629 | ed:0.956 | hr@1:0.71 | hr@2:0.867 | hr@3:0.918 | acc@1:0.71 | acc@2:0.623 | acc@3:0.585 | Best krc: 0.806 | Best epoch: 10
[2023-12-05 18:15:49] INFO (nni/MainThread) Intermediate result: 0.7948563137456884  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 18.17	mae: 14.41	mape: 101.0%	acc@10: 43.66%	acc@20: 73.77%	acc@30: 89.41%	
[2023-12-05 18:15:49] INFO (nni/MainThread) Intermediate result: 18.169478358650174  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.794 | lsd:0.668 | ed:0.955 | hr@1:0.701 | hr@2:0.867 | hr@3:0.913 | acc@1:0.701 | acc@2:0.624 | acc@3:0.581 | Best krc: 0.806 | Best epoch: 10
[2023-12-05 18:17:27] INFO (nni/MainThread) Intermediate result: 0.7943084646976207  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 18.02	mae: 14.3	mape: 100.5%	acc@10: 43.95%	acc@20: 74.18%	acc@30: 89.67%	
[2023-12-05 18:17:27] INFO (nni/MainThread) Intermediate result: 18.0201919607208  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.794 | lsd:0.636 | ed:0.946 | hr@1:0.694 | hr@2:0.872 | hr@3:0.915 | acc@1:0.694 | acc@2:0.627 | acc@3:0.584 | Best krc: 0.806 | Best epoch: 10
[2023-12-05 18:19:04] INFO (nni/MainThread) Intermediate result: 0.7935449007421025  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 17.84	mae: 14.14	mape: 99.55%	acc@10: 44.41%	acc@20: 74.66%	acc@30: 89.94%	
[2023-12-05 18:19:04] INFO (nni/MainThread) Intermediate result: 17.83768072086927  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.794 | lsd:0.648 | ed:0.941 | hr@1:0.685 | hr@2:0.872 | hr@3:0.915 | acc@1:0.685 | acc@2:0.626 | acc@3:0.584 | Best krc: 0.806 | Best epoch: 10
[2023-12-05 18:20:42] INFO (nni/MainThread) Intermediate result: 0.7940881425009105  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 17.7	mae: 14.04	mape: 99.06%	acc@10: 44.57%	acc@20: 75.07%	acc@30: 90.17%	
[2023-12-05 18:20:42] INFO (nni/MainThread) Intermediate result: 17.70021510197396  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.613 | ed:0.917 | hr@1:0.695 | hr@2:0.876 | hr@3:0.917 | acc@1:0.695 | acc@2:0.635 | acc@3:0.591 | Best krc: 0.806 | Best epoch: 10
[2023-12-05 18:22:18] INFO (nni/MainThread) Intermediate result: 0.8030610607873396  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 17.58	mae: 13.95	mape: 98.65%	acc@10: 44.8%	acc@20: 75.41%	acc@30: 90.37%	
[2023-12-05 18:22:18] INFO (nni/MainThread) Intermediate result: 17.582541458406503  (Index 41)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701794871.42055681701794871.420571
best model loaded !!!
krc:0.795 | lsd:0.454 | ed:0.927 | hr@1:0.693 | hr@2:0.905 | hr@3:0.945 | acc@1:0.693 | acc@2:0.632 | acc@3:0.59 |

-------------------------------------------------------------
Best epoch for G2R:  10
Best epoch for ETPA:  20
graph2route_pd Evaluation in test: krc:0.795 | lsd:0.454 | ed:0.927 | hr@1:0.693 | hr@2:0.905 | hr@3:0.945 | acc@1:0.693 | acc@2:0.632 | acc@3:0.59 |
RankPETA Evaluation in test: rmse: 14.15	mae: 11.11	mape: 105.87%	acc@10: 53.59%	acc@20: 83.97%	acc@30: 97.47%	
