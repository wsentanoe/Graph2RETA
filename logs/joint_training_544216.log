Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 8888,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.742 | lsd:0.779 | ed:1.067 | hr@1:0.618 | hr@2:0.847 | hr@3:0.897 | acc@1:0.618 | acc@2:0.554 | acc@3:0.517 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-18 23:25:43] INFO (nni/MainThread) Intermediate result: 0.7415933972908175  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.62	mae: 18.96	mape: 65.65%	acc@10: 31.85%	acc@20: 62.59%	acc@30: 79.63%	
[2023-12-18 23:25:43] INFO (nni/MainThread) Intermediate result: 24.6212049938983  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.747 | lsd:0.784 | ed:1.041 | hr@1:0.63 | hr@2:0.853 | hr@3:0.897 | acc@1:0.63 | acc@2:0.571 | acc@3:0.527 | Best krc: 0.742 | Best epoch: 0
best model saved
[2023-12-18 23:27:24] INFO (nni/MainThread) Intermediate result: 0.7471559534086862  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 24.62	mae: 18.06	mape: 87.01%	acc@10: 37.22%	acc@20: 67.04%	acc@30: 80.74%	
[2023-12-18 23:27:24] INFO (nni/MainThread) Intermediate result: 24.61615244192285  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.746 | lsd:0.773 | ed:1.058 | hr@1:0.625 | hr@2:0.851 | hr@3:0.899 | acc@1:0.625 | acc@2:0.57 | acc@3:0.522 | Best krc: 0.747 | Best epoch: 1
[2023-12-18 23:29:03] INFO (nni/MainThread) Intermediate result: 0.7458190791378372  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 23.63	mae: 17.34	mape: 95.77%	acc@10: 39.51%	acc@20: 69.01%	acc@30: 82.59%	
[2023-12-18 23:29:03] INFO (nni/MainThread) Intermediate result: 23.62592704273947  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.718 | ed:1.007 | hr@1:0.638 | hr@2:0.858 | hr@3:0.906 | acc@1:0.638 | acc@2:0.584 | acc@3:0.542 | Best krc: 0.747 | Best epoch: 1
best model saved
[2023-12-18 23:30:44] INFO (nni/MainThread) Intermediate result: 0.7593186906698056  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 22.95	mae: 17.03	mape: 101.81%	acc@10: 39.91%	acc@20: 69.17%	acc@30: 83.61%	
[2023-12-18 23:30:44] INFO (nni/MainThread) Intermediate result: 22.945684440821534  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.758 | lsd:0.705 | ed:1.012 | hr@1:0.632 | hr@2:0.857 | hr@3:0.907 | acc@1:0.632 | acc@2:0.577 | acc@3:0.532 | Best krc: 0.759 | Best epoch: 3
[2023-12-18 23:32:23] INFO (nni/MainThread) Intermediate result: 0.7582454378606545  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 21.92	mae: 16.48	mape: 103.38%	acc@10: 39.85%	acc@20: 69.7%	acc@30: 84.67%	
[2023-12-18 23:32:23] INFO (nni/MainThread) Intermediate result: 21.924542389845634  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.715 | ed:1.023 | hr@1:0.633 | hr@2:0.856 | hr@3:0.904 | acc@1:0.633 | acc@2:0.572 | acc@3:0.529 | Best krc: 0.759 | Best epoch: 3
best model saved
[2023-12-18 23:34:04] INFO (nni/MainThread) Intermediate result: 0.7609647124644939  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 21.16	mae: 16.02	mape: 103.5%	acc@10: 40.31%	acc@20: 70.37%	acc@30: 86.11%	
[2023-12-18 23:34:04] INFO (nni/MainThread) Intermediate result: 21.155377837982904  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.699 | ed:1.014 | hr@1:0.632 | hr@2:0.863 | hr@3:0.908 | acc@1:0.632 | acc@2:0.579 | acc@3:0.537 | Best krc: 0.761 | Best epoch: 5
best model saved
[2023-12-18 23:35:45] INFO (nni/MainThread) Intermediate result: 0.7625643662722807  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 20.58	mae: 15.69	mape: 103.72%	acc@10: 40.63%	acc@20: 71.11%	acc@30: 86.98%	
[2023-12-18 23:35:45] INFO (nni/MainThread) Intermediate result: 20.576951096858405  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.654 | ed:0.962 | hr@1:0.653 | hr@2:0.866 | hr@3:0.907 | acc@1:0.653 | acc@2:0.596 | acc@3:0.554 | Best krc: 0.763 | Best epoch: 6
best model saved
[2023-12-18 23:37:25] INFO (nni/MainThread) Intermediate result: 0.7795731490003461  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 20.0	mae: 15.35	mape: 102.92%	acc@10: 40.97%	acc@20: 71.9%	acc@30: 87.82%	
[2023-12-18 23:37:25] INFO (nni/MainThread) Intermediate result: 19.99868371877249  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.672 | ed:0.997 | hr@1:0.647 | hr@2:0.862 | hr@3:0.91 | acc@1:0.647 | acc@2:0.585 | acc@3:0.546 | Best krc: 0.78 | Best epoch: 7
[2023-12-18 23:39:04] INFO (nni/MainThread) Intermediate result: 0.7680283107392858  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 19.43	mae: 14.92	mape: 100.7%	acc@10: 42.14%	acc@20: 73.05%	acc@30: 88.64%	
[2023-12-18 23:39:05] INFO (nni/MainThread) Intermediate result: 19.42571541130192  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.793 | lsd:0.641 | ed:0.929 | hr@1:0.675 | hr@2:0.864 | hr@3:0.915 | acc@1:0.675 | acc@2:0.616 | acc@3:0.578 | Best krc: 0.78 | Best epoch: 7
best model saved
[2023-12-18 23:40:46] INFO (nni/MainThread) Intermediate result: 0.7932513417690505  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 19.04	mae: 14.67	mape: 100.02%	acc@10: 42.7%	acc@20: 73.85%	acc@30: 89.19%	
[2023-12-18 23:40:46] INFO (nni/MainThread) Intermediate result: 19.036172930258694  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.788 | lsd:0.667 | ed:0.95 | hr@1:0.679 | hr@2:0.862 | hr@3:0.91 | acc@1:0.679 | acc@2:0.611 | acc@3:0.57 | Best krc: 0.793 | Best epoch: 9
[2023-12-18 23:42:26] INFO (nni/MainThread) Intermediate result: 0.7883983198456309  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 18.56	mae: 14.34	mape: 97.93%	acc@10: 43.5%	acc@20: 75.08%	acc@30: 89.87%	
[2023-12-18 23:42:26] INFO (nni/MainThread) Intermediate result: 18.557377702116323  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.682 | ed:0.983 | hr@1:0.649 | hr@2:0.864 | hr@3:0.91 | acc@1:0.649 | acc@2:0.591 | acc@3:0.549 | Best krc: 0.793 | Best epoch: 9
[2023-12-18 23:44:07] INFO (nni/MainThread) Intermediate result: 0.7713463193917939  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 18.21	mae: 14.09	mape: 96.43%	acc@10: 44.2%	acc@20: 75.74%	acc@30: 90.37%	
[2023-12-18 23:44:07] INFO (nni/MainThread) Intermediate result: 18.20838315481631  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.786 | lsd:0.682 | ed:0.95 | hr@1:0.672 | hr@2:0.864 | hr@3:0.911 | acc@1:0.672 | acc@2:0.609 | acc@3:0.572 | Best krc: 0.793 | Best epoch: 9
[2023-12-18 23:45:49] INFO (nni/MainThread) Intermediate result: 0.7861892539111603  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 18.04	mae: 13.97	mape: 96.19%	acc@10: 44.44%	acc@20: 76.1%	acc@30: 90.46%	
[2023-12-18 23:45:49] INFO (nni/MainThread) Intermediate result: 18.038729493544288  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.795 | lsd:0.642 | ed:0.922 | hr@1:0.693 | hr@2:0.868 | hr@3:0.913 | acc@1:0.693 | acc@2:0.626 | acc@3:0.582 | Best krc: 0.793 | Best epoch: 9
best model saved
[2023-12-18 23:47:31] INFO (nni/MainThread) Intermediate result: 0.7945805594428244  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.8	mae: 13.8	mape: 95.32%	acc@10: 44.89%	acc@20: 76.56%	acc@30: 90.87%	
[2023-12-18 23:47:31] INFO (nni/MainThread) Intermediate result: 17.804478013915357  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.794 | lsd:0.639 | ed:0.945 | hr@1:0.679 | hr@2:0.868 | hr@3:0.916 | acc@1:0.679 | acc@2:0.613 | acc@3:0.577 | Best krc: 0.795 | Best epoch: 13
[2023-12-18 23:49:12] INFO (nni/MainThread) Intermediate result: 0.7938102613835012  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.65	mae: 13.68	mape: 94.64%	acc@10: 45.46%	acc@20: 76.99%	acc@30: 90.89%	
[2023-12-18 23:49:12] INFO (nni/MainThread) Intermediate result: 17.64899545194084  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.794 | lsd:0.644 | ed:0.929 | hr@1:0.693 | hr@2:0.862 | hr@3:0.914 | acc@1:0.693 | acc@2:0.616 | acc@3:0.578 | Best krc: 0.795 | Best epoch: 13
[2023-12-18 23:50:53] INFO (nni/MainThread) Intermediate result: 0.7938885846537793  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 17.42	mae: 13.51	mape: 93.52%	acc@10: 45.95%	acc@20: 77.41%	acc@30: 91.25%	
[2023-12-18 23:50:53] INFO (nni/MainThread) Intermediate result: 17.423576541310673  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.631 | ed:0.902 | hr@1:0.709 | hr@2:0.866 | hr@3:0.915 | acc@1:0.709 | acc@2:0.629 | acc@3:0.591 | Best krc: 0.795 | Best epoch: 13
best model saved
[2023-12-18 23:52:34] INFO (nni/MainThread) Intermediate result: 0.8027475955678842  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 17.27	mae: 13.41	mape: 92.94%	acc@10: 46.19%	acc@20: 77.82%	acc@30: 91.44%	
[2023-12-18 23:52:34] INFO (nni/MainThread) Intermediate result: 17.26870250176826  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.798 | lsd:0.642 | ed:0.918 | hr@1:0.705 | hr@2:0.868 | hr@3:0.914 | acc@1:0.705 | acc@2:0.633 | acc@3:0.59 | Best krc: 0.803 | Best epoch: 16
[2023-12-18 23:54:15] INFO (nni/MainThread) Intermediate result: 0.7984681803483726  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 17.08	mae: 13.28	mape: 92.0%	acc@10: 46.52%	acc@20: 78.25%	acc@30: 91.69%	
[2023-12-18 23:54:15] INFO (nni/MainThread) Intermediate result: 17.081704796577906  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.796 | lsd:0.636 | ed:0.944 | hr@1:0.696 | hr@2:0.865 | hr@3:0.913 | acc@1:0.696 | acc@2:0.616 | acc@3:0.578 | Best krc: 0.803 | Best epoch: 16
[2023-12-18 23:55:55] INFO (nni/MainThread) Intermediate result: 0.7956513935788094  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.98	mae: 13.21	mape: 91.63%	acc@10: 46.82%	acc@20: 78.56%	acc@30: 91.73%	
[2023-12-18 23:55:55] INFO (nni/MainThread) Intermediate result: 16.982777183738214  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.637 | ed:0.93 | hr@1:0.7 | hr@2:0.868 | hr@3:0.916 | acc@1:0.7 | acc@2:0.625 | acc@3:0.588 | Best krc: 0.803 | Best epoch: 16
[2023-12-18 23:57:37] INFO (nni/MainThread) Intermediate result: 0.7999844328047214  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.85	mae: 13.11	mape: 90.9%	acc@10: 47.15%	acc@20: 78.83%	acc@30: 91.89%	
[2023-12-18 23:57:37] INFO (nni/MainThread) Intermediate result: 16.85088842607091  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.785 | lsd:0.663 | ed:0.959 | hr@1:0.682 | hr@2:0.865 | hr@3:0.912 | acc@1:0.682 | acc@2:0.615 | acc@3:0.574 | Best krc: 0.803 | Best epoch: 16
[2023-12-18 23:59:16] INFO (nni/MainThread) Intermediate result: 0.7846659567254232  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.74	mae: 13.02	mape: 89.8%	acc@10: 47.5%	acc@20: 79.01%	acc@30: 91.99%	
[2023-12-18 23:59:16] INFO (nni/MainThread) Intermediate result: 16.737474655970363  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.669 | ed:0.927 | hr@1:0.693 | hr@2:0.862 | hr@3:0.914 | acc@1:0.693 | acc@2:0.622 | acc@3:0.585 | Best krc: 0.803 | Best epoch: 16
[2023-12-19 00:00:55] INFO (nni/MainThread) Intermediate result: 0.7993383095875444  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.64	mae: 12.96	mape: 89.49%	acc@10: 47.61%	acc@20: 79.21%	acc@30: 92.19%	
[2023-12-19 00:00:55] INFO (nni/MainThread) Intermediate result: 16.638907422566124  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.797 | lsd:0.654 | ed:0.925 | hr@1:0.698 | hr@2:0.864 | hr@3:0.916 | acc@1:0.698 | acc@2:0.624 | acc@3:0.585 | Best krc: 0.803 | Best epoch: 16
[2023-12-19 00:02:33] INFO (nni/MainThread) Intermediate result: 0.7973993581601803  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.58	mae: 12.92	mape: 89.23%	acc@10: 47.79%	acc@20: 79.4%	acc@30: 92.21%	
[2023-12-19 00:02:33] INFO (nni/MainThread) Intermediate result: 16.58057759459838  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.801 | lsd:0.624 | ed:0.903 | hr@1:0.71 | hr@2:0.863 | hr@3:0.916 | acc@1:0.71 | acc@2:0.628 | acc@3:0.589 | Best krc: 0.803 | Best epoch: 16
[2023-12-19 00:04:12] INFO (nni/MainThread) Intermediate result: 0.8008157639377577  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 16.47	mae: 12.83	mape: 88.45%	acc@10: 48.09%	acc@20: 79.63%	acc@30: 92.36%	
[2023-12-19 00:04:12] INFO (nni/MainThread) Intermediate result: 16.47131830271269  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.68 | ed:0.972 | hr@1:0.682 | hr@2:0.857 | hr@3:0.91 | acc@1:0.682 | acc@2:0.603 | acc@3:0.565 | Best krc: 0.803 | Best epoch: 16
[2023-12-19 00:05:50] INFO (nni/MainThread) Intermediate result: 0.7804549234632312  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 16.4	mae: 12.78	mape: 88.17%	acc@10: 48.25%	acc@20: 79.81%	acc@30: 92.41%	
[2023-12-19 00:05:50] INFO (nni/MainThread) Intermediate result: 16.400188496228736  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.796 | lsd:0.661 | ed:0.929 | hr@1:0.718 | hr@2:0.866 | hr@3:0.915 | acc@1:0.718 | acc@2:0.631 | acc@3:0.594 | Best krc: 0.803 | Best epoch: 16
[2023-12-19 00:07:29] INFO (nni/MainThread) Intermediate result: 0.7960107411091234  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 16.33	mae: 12.73	mape: 87.65%	acc@10: 48.35%	acc@20: 80.01%	acc@30: 92.51%	
[2023-12-19 00:07:29] INFO (nni/MainThread) Intermediate result: 16.325801027401045  (Index 51)
*** Epoch: 26 ***
-----------------G2R RESULT-------------------

val result: krc:0.792 | lsd:0.656 | ed:0.941 | hr@1:0.711 | hr@2:0.865 | hr@3:0.916 | acc@1:0.711 | acc@2:0.624 | acc@3:0.584 | Best krc: 0.803 | Best epoch: 16
[2023-12-19 00:09:10] INFO (nni/MainThread) Intermediate result: 0.7917671795240664  (Index 52)
-----------------ETPA RESULT-------------------
Epoch 26: Validation	rmse: 16.27	mae: 12.69	mape: 87.39%	acc@10: 48.49%	acc@20: 80.12%	acc@30: 92.57%	
[2023-12-19 00:09:10] INFO (nni/MainThread) Intermediate result: 16.265527749729  (Index 53)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702938243.2657261702938243.2657413
best model loaded !!!
krc:0.798 | lsd:0.474 | ed:0.914 | hr@1:0.714 | hr@2:0.899 | hr@3:0.941 | acc@1:0.714 | acc@2:0.651 | acc@3:0.605 |

-------------------------------------------------------------
Best epoch for G2R:  16
Best epoch for ETPA:  26
graph2route_pd Evaluation in test: krc:0.798 | lsd:0.474 | ed:0.914 | hr@1:0.714 | hr@2:0.899 | hr@3:0.941 | acc@1:0.714 | acc@2:0.651 | acc@3:0.605 |
RankPETA Evaluation in test: rmse: 13.3	mae: 10.29	mape: 93.21%	acc@10: 55.27%	acc@20: 89.03%	acc@30: 96.62%	
