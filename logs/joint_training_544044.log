Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 1999,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.704 | lsd:0.918 | ed:1.184 | hr@1:0.607 | hr@2:0.823 | hr@3:0.876 | acc@1:0.607 | acc@2:0.527 | acc@3:0.477 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-16 11:45:28] INFO (nni/MainThread) Intermediate result: 0.7043198719368373  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.24	mae: 18.99	mape: 69.62%	acc@10: 38.89%	acc@20: 61.11%	acc@30: 78.89%	
[2023-12-16 11:45:28] INFO (nni/MainThread) Intermediate result: 24.238204132129535  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.753 | lsd:0.727 | ed:1.045 | hr@1:0.625 | hr@2:0.849 | hr@3:0.901 | acc@1:0.625 | acc@2:0.56 | acc@3:0.519 | Best krc: 0.704 | Best epoch: 0
best model saved
[2023-12-16 11:45:55] INFO (nni/MainThread) Intermediate result: 0.7531599275718207  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 22.18	mae: 17.22	mape: 87.63%	acc@10: 41.3%	acc@20: 64.63%	acc@30: 84.07%	
[2023-12-16 11:45:55] INFO (nni/MainThread) Intermediate result: 22.179456129265184  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.688 | ed:0.979 | hr@1:0.633 | hr@2:0.857 | hr@3:0.908 | acc@1:0.633 | acc@2:0.581 | acc@3:0.547 | Best krc: 0.753 | Best epoch: 1
best model saved
[2023-12-16 11:46:21] INFO (nni/MainThread) Intermediate result: 0.7680334926858758  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 22.1	mae: 17.03	mape: 99.49%	acc@10: 40.99%	acc@20: 65.56%	acc@30: 84.32%	
[2023-12-16 11:46:21] INFO (nni/MainThread) Intermediate result: 22.098266400588003  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.696 | ed:0.995 | hr@1:0.631 | hr@2:0.86 | hr@3:0.91 | acc@1:0.631 | acc@2:0.576 | acc@3:0.542 | Best krc: 0.768 | Best epoch: 2
[2023-12-16 11:46:47] INFO (nni/MainThread) Intermediate result: 0.7641208560666366  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 21.14	mae: 16.18	mape: 97.93%	acc@10: 43.06%	acc@20: 68.33%	acc@30: 85.0%	
[2023-12-16 11:46:47] INFO (nni/MainThread) Intermediate result: 21.139014074550367  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.676 | ed:0.985 | hr@1:0.634 | hr@2:0.857 | hr@3:0.907 | acc@1:0.634 | acc@2:0.576 | acc@3:0.545 | Best krc: 0.768 | Best epoch: 2
[2023-12-16 11:47:12] INFO (nni/MainThread) Intermediate result: 0.7676582676582676  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 20.99	mae: 16.11	mape: 101.53%	acc@10: 42.96%	acc@20: 68.81%	acc@30: 85.26%	
[2023-12-16 11:47:12] INFO (nni/MainThread) Intermediate result: 20.991153084344262  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.683 | ed:0.981 | hr@1:0.638 | hr@2:0.855 | hr@3:0.908 | acc@1:0.638 | acc@2:0.578 | acc@3:0.546 | Best krc: 0.768 | Best epoch: 2
[2023-12-16 11:47:37] INFO (nni/MainThread) Intermediate result: 0.7669426387310077  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 20.18	mae: 15.55	mape: 99.95%	acc@10: 44.2%	acc@20: 70.12%	acc@30: 86.6%	
[2023-12-16 11:47:37] INFO (nni/MainThread) Intermediate result: 20.17749372454412  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.707 | ed:0.988 | hr@1:0.639 | hr@2:0.857 | hr@3:0.907 | acc@1:0.639 | acc@2:0.577 | acc@3:0.539 | Best krc: 0.768 | Best epoch: 2
[2023-12-16 11:48:03] INFO (nni/MainThread) Intermediate result: 0.764880988580158  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 19.67	mae: 15.19	mape: 99.54%	acc@10: 44.87%	acc@20: 71.06%	acc@30: 87.62%	
[2023-12-16 11:48:03] INFO (nni/MainThread) Intermediate result: 19.669002772927268  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.756 | lsd:0.718 | ed:1.024 | hr@1:0.621 | hr@2:0.858 | hr@3:0.905 | acc@1:0.621 | acc@2:0.569 | acc@3:0.528 | Best krc: 0.768 | Best epoch: 2
[2023-12-16 11:48:28] INFO (nni/MainThread) Intermediate result: 0.7561995865799975  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.14	mae: 14.83	mape: 98.38%	acc@10: 45.42%	acc@20: 72.36%	acc@30: 88.43%	
[2023-12-16 11:48:28] INFO (nni/MainThread) Intermediate result: 19.139174583699866  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.67 | ed:0.965 | hr@1:0.645 | hr@2:0.865 | hr@3:0.91 | acc@1:0.645 | acc@2:0.59 | acc@3:0.554 | Best krc: 0.768 | Best epoch: 2
best model saved
[2023-12-16 11:48:55] INFO (nni/MainThread) Intermediate result: 0.773640787624172  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.67	mae: 14.46	mape: 96.59%	acc@10: 46.5%	acc@20: 73.42%	acc@30: 89.01%	
[2023-12-16 11:48:55] INFO (nni/MainThread) Intermediate result: 18.672231446178554  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.707 | ed:1.001 | hr@1:0.627 | hr@2:0.855 | hr@3:0.91 | acc@1:0.627 | acc@2:0.571 | acc@3:0.538 | Best krc: 0.774 | Best epoch: 8
[2023-12-16 11:49:21] INFO (nni/MainThread) Intermediate result: 0.762358791995871  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.41	mae: 14.36	mape: 97.1%	acc@10: 45.96%	acc@20: 73.93%	acc@30: 89.7%	
[2023-12-16 11:49:21] INFO (nni/MainThread) Intermediate result: 18.410416318203925  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.758 | lsd:0.747 | ed:1.036 | hr@1:0.629 | hr@2:0.857 | hr@3:0.904 | acc@1:0.629 | acc@2:0.573 | acc@3:0.526 | Best krc: 0.774 | Best epoch: 8
[2023-12-16 11:49:46] INFO (nni/MainThread) Intermediate result: 0.7584697030608705  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 17.99	mae: 14.03	mape: 95.25%	acc@10: 46.73%	acc@20: 75.08%	acc@30: 90.34%	
[2023-12-16 11:49:46] INFO (nni/MainThread) Intermediate result: 17.99411374614831  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.695 | ed:1.003 | hr@1:0.624 | hr@2:0.86 | hr@3:0.908 | acc@1:0.624 | acc@2:0.575 | acc@3:0.533 | Best krc: 0.774 | Best epoch: 8
[2023-12-16 11:50:12] INFO (nni/MainThread) Intermediate result: 0.7634628002970809  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.65	mae: 13.76	mape: 93.25%	acc@10: 47.44%	acc@20: 76.02%	acc@30: 90.83%	
[2023-12-16 11:50:12] INFO (nni/MainThread) Intermediate result: 17.646511148062167  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.675 | ed:0.971 | hr@1:0.645 | hr@2:0.861 | hr@3:0.909 | acc@1:0.645 | acc@2:0.585 | acc@3:0.546 | Best krc: 0.774 | Best epoch: 8
[2023-12-16 11:50:37] INFO (nni/MainThread) Intermediate result: 0.7692739859858356  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.44	mae: 13.61	mape: 92.77%	acc@10: 47.81%	acc@20: 76.5%	acc@30: 91.11%	
[2023-12-16 11:50:37] INFO (nni/MainThread) Intermediate result: 17.440579900899536  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.682 | ed:1.005 | hr@1:0.628 | hr@2:0.862 | hr@3:0.91 | acc@1:0.628 | acc@2:0.573 | acc@3:0.531 | Best krc: 0.774 | Best epoch: 8
[2023-12-16 11:51:03] INFO (nni/MainThread) Intermediate result: 0.7637299878051955  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.25	mae: 13.48	mape: 92.23%	acc@10: 48.07%	acc@20: 77.04%	acc@30: 91.43%	
[2023-12-16 11:51:03] INFO (nni/MainThread) Intermediate result: 17.25357174534202  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.664 | ed:0.972 | hr@1:0.638 | hr@2:0.866 | hr@3:0.913 | acc@1:0.638 | acc@2:0.583 | acc@3:0.547 | Best krc: 0.774 | Best epoch: 8
[2023-12-16 11:51:29] INFO (nni/MainThread) Intermediate result: 0.7714277223853088  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.17	mae: 13.42	mape: 92.36%	acc@10: 48.12%	acc@20: 77.21%	acc@30: 91.51%	
[2023-12-16 11:51:29] INFO (nni/MainThread) Intermediate result: 17.17010392322785  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.682 | ed:0.978 | hr@1:0.638 | hr@2:0.867 | hr@3:0.912 | acc@1:0.638 | acc@2:0.585 | acc@3:0.549 | Best krc: 0.774 | Best epoch: 8
[2023-12-16 11:51:54] INFO (nni/MainThread) Intermediate result: 0.7728410202568489  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 17.02	mae: 13.32	mape: 91.78%	acc@10: 48.19%	acc@20: 77.52%	acc@30: 91.64%	
[2023-12-16 11:51:54] INFO (nni/MainThread) Intermediate result: 17.02498559542908  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.685 | ed:0.997 | hr@1:0.631 | hr@2:0.865 | hr@3:0.91 | acc@1:0.631 | acc@2:0.576 | acc@3:0.539 | Best krc: 0.774 | Best epoch: 8
[2023-12-16 11:52:20] INFO (nni/MainThread) Intermediate result: 0.7691103254548817  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 16.86	mae: 13.22	mape: 91.28%	acc@10: 48.19%	acc@20: 77.91%	acc@30: 91.94%	
[2023-12-16 11:52:20] INFO (nni/MainThread) Intermediate result: 16.864921030233965  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.67 | ed:0.991 | hr@1:0.625 | hr@2:0.867 | hr@3:0.915 | acc@1:0.625 | acc@2:0.573 | acc@3:0.54 | Best krc: 0.774 | Best epoch: 8
[2023-12-16 11:52:46] INFO (nni/MainThread) Intermediate result: 0.7649865575969641  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 16.71	mae: 13.11	mape: 90.68%	acc@10: 48.52%	acc@20: 78.27%	acc@30: 92.2%	
[2023-12-16 11:52:46] INFO (nni/MainThread) Intermediate result: 16.70924128109046  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.67 | ed:0.971 | hr@1:0.638 | hr@2:0.863 | hr@3:0.911 | acc@1:0.638 | acc@2:0.582 | acc@3:0.547 | Best krc: 0.774 | Best epoch: 8
[2023-12-16 11:53:11] INFO (nni/MainThread) Intermediate result: 0.7729728539610483  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.52	mae: 12.98	mape: 89.56%	acc@10: 48.87%	acc@20: 78.77%	acc@30: 92.48%	
[2023-12-16 11:53:11] INFO (nni/MainThread) Intermediate result: 16.524881965077746  (Index 37)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702723501.64370231702723501.6437151
best model loaded !!!
krc:0.756 | lsd:0.541 | ed:1.013 | hr@1:0.642 | hr@2:0.896 | hr@3:0.933 | acc@1:0.642 | acc@2:0.592 | acc@3:0.544 |

-------------------------------------------------------------
Best epoch for G2R:  8
Best epoch for ETPA:  18
graph2route_pd Evaluation in test: krc:0.756 | lsd:0.541 | ed:1.013 | hr@1:0.642 | hr@2:0.896 | hr@3:0.933 | acc@1:0.642 | acc@2:0.592 | acc@3:0.544 |
RankPETA Evaluation in test: rmse: 11.97	mae: 9.42	mape: 77.23%	acc@10: 63.71%	acc@20: 93.25%	acc@30: 97.89%	
