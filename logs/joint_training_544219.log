Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 8888,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.758 | lsd:0.727 | ed:0.997 | hr@1:0.642 | hr@2:0.854 | hr@3:0.904 | acc@1:0.642 | acc@2:0.582 | acc@3:0.544 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-19 09:21:43] INFO (nni/MainThread) Intermediate result: 0.7583169043947356  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.59	mae: 18.94	mape: 65.65%	acc@10: 32.22%	acc@20: 62.59%	acc@30: 79.63%	
[2023-12-19 09:21:43] INFO (nni/MainThread) Intermediate result: 24.59195315862996  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.758 | lsd:0.703 | ed:1.027 | hr@1:0.619 | hr@2:0.858 | hr@3:0.907 | acc@1:0.619 | acc@2:0.563 | acc@3:0.529 | Best krc: 0.758 | Best epoch: 0
[2023-12-19 09:22:07] INFO (nni/MainThread) Intermediate result: 0.7580646780384427  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 24.36	mae: 17.92	mape: 87.24%	acc@10: 38.52%	acc@20: 67.78%	acc@30: 81.48%	
[2023-12-19 09:22:07] INFO (nni/MainThread) Intermediate result: 24.35659667651173  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.683 | ed:1.004 | hr@1:0.634 | hr@2:0.86 | hr@3:0.908 | acc@1:0.634 | acc@2:0.576 | acc@3:0.538 | Best krc: 0.758 | Best epoch: 0
best model saved
[2023-12-19 09:22:33] INFO (nni/MainThread) Intermediate result: 0.764908492534203  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 23.13	mae: 17.12	mape: 94.56%	acc@10: 39.63%	acc@20: 69.38%	acc@30: 83.21%	
[2023-12-19 09:22:33] INFO (nni/MainThread) Intermediate result: 23.125060507591673  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.722 | ed:1.022 | hr@1:0.632 | hr@2:0.858 | hr@3:0.906 | acc@1:0.632 | acc@2:0.571 | acc@3:0.528 | Best krc: 0.765 | Best epoch: 2
[2023-12-19 09:22:56] INFO (nni/MainThread) Intermediate result: 0.7621085229043251  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 21.94	mae: 16.47	mape: 97.4%	acc@10: 40.37%	acc@20: 70.93%	acc@30: 84.26%	
[2023-12-19 09:22:56] INFO (nni/MainThread) Intermediate result: 21.943959144390874  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.681 | ed:0.975 | hr@1:0.64 | hr@2:0.858 | hr@3:0.906 | acc@1:0.64 | acc@2:0.584 | acc@3:0.546 | Best krc: 0.765 | Best epoch: 2
best model saved
[2023-12-19 09:23:20] INFO (nni/MainThread) Intermediate result: 0.7681673706946991  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 21.23	mae: 16.14	mape: 100.02%	acc@10: 39.93%	acc@20: 71.48%	acc@30: 85.19%	
[2023-12-19 09:23:20] INFO (nni/MainThread) Intermediate result: 21.232345832487788  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.71 | ed:1.001 | hr@1:0.631 | hr@2:0.863 | hr@3:0.911 | acc@1:0.631 | acc@2:0.575 | acc@3:0.539 | Best krc: 0.768 | Best epoch: 4
[2023-12-19 09:23:44] INFO (nni/MainThread) Intermediate result: 0.7642095833525655  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 20.52	mae: 15.69	mape: 99.76%	acc@10: 41.17%	acc@20: 72.47%	acc@30: 86.11%	
[2023-12-19 09:23:44] INFO (nni/MainThread) Intermediate result: 20.524308917758834  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.698 | ed:1.001 | hr@1:0.628 | hr@2:0.856 | hr@3:0.907 | acc@1:0.628 | acc@2:0.568 | acc@3:0.53 | Best krc: 0.768 | Best epoch: 4
[2023-12-19 09:24:08] INFO (nni/MainThread) Intermediate result: 0.7628987362699649  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 19.91	mae: 15.26	mape: 98.91%	acc@10: 42.17%	acc@20: 73.39%	acc@30: 86.98%	
[2023-12-19 09:24:08] INFO (nni/MainThread) Intermediate result: 19.912578897142552  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.719 | ed:1.006 | hr@1:0.627 | hr@2:0.858 | hr@3:0.904 | acc@1:0.627 | acc@2:0.57 | acc@3:0.534 | Best krc: 0.768 | Best epoch: 4
[2023-12-19 09:24:32] INFO (nni/MainThread) Intermediate result: 0.7597546996235234  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.33	mae: 14.88	mape: 97.74%	acc@10: 42.55%	acc@20: 74.68%	acc@30: 88.01%	
[2023-12-19 09:24:32] INFO (nni/MainThread) Intermediate result: 19.334006435687815  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.709 | ed:1.005 | hr@1:0.626 | hr@2:0.86 | hr@3:0.908 | acc@1:0.626 | acc@2:0.569 | acc@3:0.535 | Best krc: 0.768 | Best epoch: 4
[2023-12-19 09:24:55] INFO (nni/MainThread) Intermediate result: 0.7639185821870562  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.79	mae: 14.5	mape: 95.84%	acc@10: 43.54%	acc@20: 75.76%	acc@30: 88.89%	
[2023-12-19 09:24:55] INFO (nni/MainThread) Intermediate result: 18.791370049930762  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.675 | ed:0.991 | hr@1:0.633 | hr@2:0.859 | hr@3:0.91 | acc@1:0.633 | acc@2:0.574 | acc@3:0.541 | Best krc: 0.768 | Best epoch: 4
[2023-12-19 09:25:19] INFO (nni/MainThread) Intermediate result: 0.7678019520520614  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.44	mae: 14.26	mape: 95.03%	acc@10: 44.04%	acc@20: 76.33%	acc@30: 89.41%	
[2023-12-19 09:25:19] INFO (nni/MainThread) Intermediate result: 18.43606417397215  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.676 | ed:0.995 | hr@1:0.631 | hr@2:0.86 | hr@3:0.909 | acc@1:0.631 | acc@2:0.575 | acc@3:0.537 | Best krc: 0.768 | Best epoch: 4
[2023-12-19 09:25:44] INFO (nni/MainThread) Intermediate result: 0.7633626701401077  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 18.15	mae: 14.05	mape: 94.18%	acc@10: 44.65%	acc@20: 77.04%	acc@30: 89.83%	
[2023-12-19 09:25:44] INFO (nni/MainThread) Intermediate result: 18.148288432103232  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.688 | ed:0.993 | hr@1:0.64 | hr@2:0.862 | hr@3:0.912 | acc@1:0.64 | acc@2:0.583 | acc@3:0.547 | Best krc: 0.768 | Best epoch: 4
best model saved
[2023-12-19 09:26:10] INFO (nni/MainThread) Intermediate result: 0.7686346654689462  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.88	mae: 13.86	mape: 93.26%	acc@10: 45.09%	acc@20: 77.44%	acc@30: 90.22%	
[2023-12-19 09:26:10] INFO (nni/MainThread) Intermediate result: 17.878106620115663  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.713 | ed:1.008 | hr@1:0.632 | hr@2:0.857 | hr@3:0.911 | acc@1:0.632 | acc@2:0.573 | acc@3:0.537 | Best krc: 0.769 | Best epoch: 11
[2023-12-19 09:26:34] INFO (nni/MainThread) Intermediate result: 0.7620227087039505  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.62	mae: 13.64	mape: 91.81%	acc@10: 45.87%	acc@20: 77.89%	acc@30: 90.54%	
[2023-12-19 09:26:34] INFO (nni/MainThread) Intermediate result: 17.616561142642002  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.669 | ed:0.993 | hr@1:0.631 | hr@2:0.862 | hr@3:0.911 | acc@1:0.631 | acc@2:0.574 | acc@3:0.538 | Best krc: 0.769 | Best epoch: 11
[2023-12-19 09:26:58] INFO (nni/MainThread) Intermediate result: 0.766900743105378  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.55	mae: 13.6	mape: 92.06%	acc@10: 45.93%	acc@20: 78.04%	acc@30: 90.56%	
[2023-12-19 09:26:58] INFO (nni/MainThread) Intermediate result: 17.547393741838665  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.673 | ed:1.007 | hr@1:0.621 | hr@2:0.861 | hr@3:0.912 | acc@1:0.621 | acc@2:0.566 | acc@3:0.531 | Best krc: 0.769 | Best epoch: 11
[2023-12-19 09:27:23] INFO (nni/MainThread) Intermediate result: 0.7674153202705892  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.43	mae: 13.52	mape: 91.88%	acc@10: 46.1%	acc@20: 78.22%	acc@30: 90.67%	
[2023-12-19 09:27:23] INFO (nni/MainThread) Intermediate result: 17.426349279650573  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.673 | ed:0.994 | hr@1:0.63 | hr@2:0.859 | hr@3:0.908 | acc@1:0.63 | acc@2:0.573 | acc@3:0.533 | Best krc: 0.769 | Best epoch: 11
best model saved
[2023-12-19 09:27:49] INFO (nni/MainThread) Intermediate result: 0.7716587051873454  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 17.25	mae: 13.39	mape: 90.93%	acc@10: 46.46%	acc@20: 78.59%	acc@30: 90.86%	
[2023-12-19 09:27:49] INFO (nni/MainThread) Intermediate result: 17.254724138152824  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.683 | ed:1.01 | hr@1:0.63 | hr@2:0.86 | hr@3:0.908 | acc@1:0.63 | acc@2:0.571 | acc@3:0.532 | Best krc: 0.772 | Best epoch: 15
[2023-12-19 09:28:13] INFO (nni/MainThread) Intermediate result: 0.7624792024442222  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 17.09	mae: 13.26	mape: 89.91%	acc@10: 46.95%	acc@20: 78.87%	acc@30: 91.07%	
[2023-12-19 09:28:13] INFO (nni/MainThread) Intermediate result: 17.091540981710658  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.686 | ed:0.997 | hr@1:0.632 | hr@2:0.857 | hr@3:0.906 | acc@1:0.632 | acc@2:0.574 | acc@3:0.535 | Best krc: 0.772 | Best epoch: 15
[2023-12-19 09:28:38] INFO (nni/MainThread) Intermediate result: 0.7658318102568211  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 16.94	mae: 13.16	mape: 89.14%	acc@10: 47.1%	acc@20: 79.14%	acc@30: 91.3%	
[2023-12-19 09:28:38] INFO (nni/MainThread) Intermediate result: 16.944755803720792  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.695 | ed:0.997 | hr@1:0.633 | hr@2:0.861 | hr@3:0.909 | acc@1:0.633 | acc@2:0.573 | acc@3:0.535 | Best krc: 0.772 | Best epoch: 15
[2023-12-19 09:29:03] INFO (nni/MainThread) Intermediate result: 0.7643602911202385  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.79	mae: 13.05	mape: 88.47%	acc@10: 47.45%	acc@20: 79.38%	acc@30: 91.5%	
[2023-12-19 09:29:03] INFO (nni/MainThread) Intermediate result: 16.790394516985288  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.673 | ed:0.989 | hr@1:0.641 | hr@2:0.863 | hr@3:0.913 | acc@1:0.641 | acc@2:0.577 | acc@3:0.544 | Best krc: 0.772 | Best epoch: 15
[2023-12-19 09:29:28] INFO (nni/MainThread) Intermediate result: 0.7716492644345727  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.67	mae: 12.97	mape: 87.94%	acc@10: 47.78%	acc@20: 79.54%	acc@30: 91.67%	
[2023-12-19 09:29:28] INFO (nni/MainThread) Intermediate result: 16.67478272846037  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.673 | ed:0.981 | hr@1:0.633 | hr@2:0.865 | hr@3:0.914 | acc@1:0.633 | acc@2:0.578 | acc@3:0.544 | Best krc: 0.772 | Best epoch: 15
[2023-12-19 09:29:52] INFO (nni/MainThread) Intermediate result: 0.770214029601874  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.55	mae: 12.87	mape: 86.85%	acc@10: 48.27%	acc@20: 79.75%	acc@30: 91.85%	
[2023-12-19 09:29:52] INFO (nni/MainThread) Intermediate result: 16.553442458137077  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.669 | ed:0.981 | hr@1:0.633 | hr@2:0.866 | hr@3:0.915 | acc@1:0.633 | acc@2:0.576 | acc@3:0.542 | Best krc: 0.772 | Best epoch: 15
[2023-12-19 09:30:16] INFO (nni/MainThread) Intermediate result: 0.7704812362005189  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.46	mae: 12.8	mape: 86.25%	acc@10: 48.57%	acc@20: 79.8%	acc@30: 91.99%	
[2023-12-19 09:30:16] INFO (nni/MainThread) Intermediate result: 16.461898551995432  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.669 | ed:0.994 | hr@1:0.638 | hr@2:0.862 | hr@3:0.911 | acc@1:0.638 | acc@2:0.576 | acc@3:0.537 | Best krc: 0.772 | Best epoch: 15
[2023-12-19 09:30:41] INFO (nni/MainThread) Intermediate result: 0.7687182493129148  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.35	mae: 12.72	mape: 85.53%	acc@10: 48.9%	acc@20: 79.9%	acc@30: 92.17%	
[2023-12-19 09:30:41] INFO (nni/MainThread) Intermediate result: 16.354215146765426  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.681 | ed:1.021 | hr@1:0.625 | hr@2:0.864 | hr@3:0.909 | acc@1:0.625 | acc@2:0.569 | acc@3:0.528 | Best krc: 0.772 | Best epoch: 15
[2023-12-19 09:31:06] INFO (nni/MainThread) Intermediate result: 0.7624143104947652  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 16.23	mae: 12.63	mape: 84.58%	acc@10: 49.17%	acc@20: 80.22%	acc@30: 92.35%	
[2023-12-19 09:31:06] INFO (nni/MainThread) Intermediate result: 16.234825108249066  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.744 | lsd:0.756 | ed:1.077 | hr@1:0.615 | hr@2:0.849 | hr@3:0.896 | acc@1:0.615 | acc@2:0.554 | acc@3:0.51 | Best krc: 0.772 | Best epoch: 15
[2023-12-19 09:31:31] INFO (nni/MainThread) Intermediate result: 0.7438243480919476  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 16.15	mae: 12.58	mape: 84.3%	acc@10: 49.23%	acc@20: 80.37%	acc@30: 92.5%	
[2023-12-19 09:31:31] INFO (nni/MainThread) Intermediate result: 16.14608972037555  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.709 | ed:1.003 | hr@1:0.635 | hr@2:0.858 | hr@3:0.905 | acc@1:0.635 | acc@2:0.574 | acc@3:0.536 | Best krc: 0.772 | Best epoch: 15
[2023-12-19 09:31:56] INFO (nni/MainThread) Intermediate result: 0.7640521097713926  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 16.05	mae: 12.51	mape: 83.56%	acc@10: 49.5%	acc@20: 80.56%	acc@30: 92.66%	
[2023-12-19 09:31:56] INFO (nni/MainThread) Intermediate result: 16.051816545014795  (Index 51)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702974078.17866541702974078.1786792
best model loaded !!!
krc:0.759 | lsd:0.521 | ed:1.018 | hr@1:0.639 | hr@2:0.894 | hr@3:0.934 | acc@1:0.639 | acc@2:0.588 | acc@3:0.537 |

-------------------------------------------------------------
Best epoch for G2R:  15
Best epoch for ETPA:  25
graph2route_pd Evaluation in test: krc:0.759 | lsd:0.521 | ed:1.018 | hr@1:0.639 | hr@2:0.894 | hr@3:0.934 | acc@1:0.639 | acc@2:0.588 | acc@3:0.537 |
RankPETA Evaluation in test: rmse: 11.54	mae: 8.74	mape: 70.77%	acc@10: 68.78%	acc@20: 93.67%	acc@30: 97.05%	
