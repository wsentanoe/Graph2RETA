Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1000,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'true_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:38
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.734 | lsd:0.792 | ed:1.096 | hr@1:0.622 | hr@2:0.847 | hr@3:0.898 | acc@1:0.622 | acc@2:0.554 | acc@3:0.507 | Best krc: -1 | Best epoch: -1
best model saved
[2023-11-24 12:15:47] INFO (nni/MainThread) Intermediate result: 0.7340775893202651  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 43.07	mae: 36.03	mape: 72.9%	acc@10: 15.62%	acc@20: 25.0%	acc@30: 34.38%	
[2023-11-24 12:15:47] INFO (nni/MainThread) Intermediate result: 43.071683527289714  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.689 | ed:1.014 | hr@1:0.63 | hr@2:0.861 | hr@3:0.907 | acc@1:0.63 | acc@2:0.574 | acc@3:0.536 | Best krc: 0.734 | Best epoch: 0
best model saved
[2023-11-24 12:17:40] INFO (nni/MainThread) Intermediate result: 0.7646652866154398  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 38.18	mae: 31.71	mape: 63.49%	acc@10: 14.06%	acc@20: 29.69%	acc@30: 50.0%	
[2023-11-24 12:17:40] INFO (nni/MainThread) Intermediate result: 38.18469811249385  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.703 | ed:1.021 | hr@1:0.616 | hr@2:0.859 | hr@3:0.905 | acc@1:0.616 | acc@2:0.568 | acc@3:0.527 | Best krc: 0.765 | Best epoch: 1
[2023-11-24 12:19:40] INFO (nni/MainThread) Intermediate result: 0.759699007044875  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 35.45	mae: 28.29	mape: 58.01%	acc@10: 19.79%	acc@20: 41.67%	acc@30: 60.42%	
[2023-11-24 12:19:40] INFO (nni/MainThread) Intermediate result: 35.44545267113312  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.664 | ed:0.977 | hr@1:0.634 | hr@2:0.867 | hr@3:0.911 | acc@1:0.634 | acc@2:0.582 | acc@3:0.547 | Best krc: 0.765 | Best epoch: 1
best model saved
[2023-11-24 12:21:45] INFO (nni/MainThread) Intermediate result: 0.773206783823312  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 32.67	mae: 25.2	mape: 51.66%	acc@10: 26.56%	acc@20: 51.56%	acc@30: 67.19%	
[2023-11-24 12:21:45] INFO (nni/MainThread) Intermediate result: 32.669359732635286  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.665 | ed:0.984 | hr@1:0.634 | hr@2:0.865 | hr@3:0.911 | acc@1:0.634 | acc@2:0.578 | acc@3:0.541 | Best krc: 0.773 | Best epoch: 3
[2023-11-24 12:23:49] INFO (nni/MainThread) Intermediate result: 0.7707373379345395  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 31.08	mae: 23.57	mape: 49.12%	acc@10: 29.38%	acc@20: 55.62%	acc@30: 70.62%	
[2023-11-24 12:23:49] INFO (nni/MainThread) Intermediate result: 31.0784490656387  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.726 | ed:0.993 | hr@1:0.686 | hr@2:0.846 | hr@3:0.902 | acc@1:0.686 | acc@2:0.599 | acc@3:0.565 | Best krc: 0.773 | Best epoch: 3
[2023-11-24 12:25:46] INFO (nni/MainThread) Intermediate result: 0.7723704982122123  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 29.76	mae: 22.34	mape: 46.78%	acc@10: 32.81%	acc@20: 58.85%	acc@30: 72.4%	
[2023-11-24 12:25:46] INFO (nni/MainThread) Intermediate result: 29.758063445129  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.624 | ed:0.909 | hr@1:0.697 | hr@2:0.866 | hr@3:0.915 | acc@1:0.697 | acc@2:0.627 | acc@3:0.589 | Best krc: 0.773 | Best epoch: 3
best model saved
[2023-11-24 12:27:45] INFO (nni/MainThread) Intermediate result: 0.799418825033167  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 28.68	mae: 21.43	mape: 45.57%	acc@10: 34.82%	acc@20: 60.71%	acc@30: 74.55%	
[2023-11-24 12:27:45] INFO (nni/MainThread) Intermediate result: 28.678958034254915  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.788 | lsd:0.646 | ed:0.944 | hr@1:0.673 | hr@2:0.864 | hr@3:0.913 | acc@1:0.673 | acc@2:0.606 | acc@3:0.568 | Best krc: 0.799 | Best epoch: 6
[2023-11-24 12:29:45] INFO (nni/MainThread) Intermediate result: 0.7880672460383872  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 27.75	mae: 20.64	mape: 43.96%	acc@10: 35.94%	acc@20: 62.89%	acc@30: 76.95%	
[2023-11-24 12:29:45] INFO (nni/MainThread) Intermediate result: 27.747664671680283  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.789 | lsd:0.619 | ed:0.926 | hr@1:0.66 | hr@2:0.87 | hr@3:0.92 | acc@1:0.66 | acc@2:0.599 | acc@3:0.57 | Best krc: 0.799 | Best epoch: 6
[2023-11-24 12:31:48] INFO (nni/MainThread) Intermediate result: 0.7885523341579308  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 26.96	mae: 20.0	mape: 43.04%	acc@10: 36.81%	acc@20: 64.24%	acc@30: 78.82%	
[2023-11-24 12:31:48] INFO (nni/MainThread) Intermediate result: 26.958884889312813  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.806 | lsd:0.612 | ed:0.897 | hr@1:0.7 | hr@2:0.875 | hr@3:0.921 | acc@1:0.7 | acc@2:0.634 | acc@3:0.596 | Best krc: 0.799 | Best epoch: 6
best model saved
[2023-11-24 12:33:49] INFO (nni/MainThread) Intermediate result: 0.8058752004445054  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 26.19	mae: 19.37	mape: 41.92%	acc@10: 37.81%	acc@20: 65.31%	acc@30: 80.0%	
[2023-11-24 12:33:49] INFO (nni/MainThread) Intermediate result: 26.19092037946904  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.81 | lsd:0.634 | ed:0.902 | hr@1:0.733 | hr@2:0.866 | hr@3:0.921 | acc@1:0.733 | acc@2:0.645 | acc@3:0.606 | Best krc: 0.806 | Best epoch: 9
best model saved
[2023-11-24 12:35:44] INFO (nni/MainThread) Intermediate result: 0.8096690599882554  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 25.52	mae: 18.89	mape: 41.14%	acc@10: 38.35%	acc@20: 66.76%	acc@30: 81.25%	
[2023-11-24 12:35:44] INFO (nni/MainThread) Intermediate result: 25.523876805423523  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.657 | ed:0.968 | hr@1:0.635 | hr@2:0.867 | hr@3:0.919 | acc@1:0.635 | acc@2:0.582 | acc@3:0.55 | Best krc: 0.81 | Best epoch: 10
[2023-11-24 12:37:46] INFO (nni/MainThread) Intermediate result: 0.7763240565164483  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 24.92	mae: 18.44	mape: 40.29%	acc@10: 39.32%	acc@20: 67.19%	acc@30: 82.29%	
[2023-11-24 12:37:46] INFO (nni/MainThread) Intermediate result: 24.91565272245636  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.595 | ed:0.865 | hr@1:0.701 | hr@2:0.88 | hr@3:0.925 | acc@1:0.701 | acc@2:0.639 | acc@3:0.606 | Best krc: 0.81 | Best epoch: 10
best model saved
[2023-11-24 12:39:53] INFO (nni/MainThread) Intermediate result: 0.8112810643986857  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 24.31	mae: 18.0	mape: 39.42%	acc@10: 40.38%	acc@20: 68.27%	acc@30: 83.17%	
[2023-11-24 12:39:53] INFO (nni/MainThread) Intermediate result: 24.305628033861026  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.584 | ed:0.875 | hr@1:0.702 | hr@2:0.878 | hr@3:0.927 | acc@1:0.702 | acc@2:0.631 | acc@3:0.604 | Best krc: 0.811 | Best epoch: 12
[2023-11-24 12:41:54] INFO (nni/MainThread) Intermediate result: 0.8111350493423077  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 23.93	mae: 17.74	mape: 38.95%	acc@10: 41.07%	acc@20: 68.53%	acc@30: 83.93%	
[2023-11-24 12:41:54] INFO (nni/MainThread) Intermediate result: 23.931655549146445  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.79 | lsd:0.651 | ed:0.934 | hr@1:0.682 | hr@2:0.867 | hr@3:0.915 | acc@1:0.682 | acc@2:0.613 | acc@3:0.575 | Best krc: 0.811 | Best epoch: 12
[2023-11-24 12:43:47] INFO (nni/MainThread) Intermediate result: 0.7904812630566895  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 23.54	mae: 17.48	mape: 38.46%	acc@10: 41.46%	acc@20: 68.75%	acc@30: 84.58%	
[2023-11-24 12:43:47] INFO (nni/MainThread) Intermediate result: 23.54116468719883  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.807 | lsd:0.591 | ed:0.88 | hr@1:0.698 | hr@2:0.875 | hr@3:0.922 | acc@1:0.698 | acc@2:0.633 | acc@3:0.603 | Best krc: 0.811 | Best epoch: 12
[2023-11-24 12:45:41] INFO (nni/MainThread) Intermediate result: 0.8072014319062855  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 23.22	mae: 17.28	mape: 38.1%	acc@10: 41.6%	acc@20: 69.34%	acc@30: 85.16%	
[2023-11-24 12:45:41] INFO (nni/MainThread) Intermediate result: 23.216770741542444  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.812 | lsd:0.584 | ed:0.875 | hr@1:0.71 | hr@2:0.882 | hr@3:0.928 | acc@1:0.71 | acc@2:0.644 | acc@3:0.612 | Best krc: 0.811 | Best epoch: 12
best model saved
[2023-11-24 12:47:40] INFO (nni/MainThread) Intermediate result: 0.8119350778292623  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 22.99	mae: 17.13	mape: 37.78%	acc@10: 41.73%	acc@20: 69.67%	acc@30: 85.48%	
[2023-11-24 12:47:40] INFO (nni/MainThread) Intermediate result: 22.988636267375888  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.568 | ed:0.866 | hr@1:0.711 | hr@2:0.881 | hr@3:0.923 | acc@1:0.711 | acc@2:0.646 | acc@3:0.61 | Best krc: 0.812 | Best epoch: 16
[2023-11-24 12:49:46] INFO (nni/MainThread) Intermediate result: 0.8109540063978192  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 22.83	mae: 16.98	mape: 37.39%	acc@10: 42.19%	acc@20: 70.14%	acc@30: 85.76%	
[2023-11-24 12:49:46] INFO (nni/MainThread) Intermediate result: 22.826079225895512  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.813 | lsd:0.598 | ed:0.858 | hr@1:0.711 | hr@2:0.883 | hr@3:0.929 | acc@1:0.711 | acc@2:0.646 | acc@3:0.614 | Best krc: 0.812 | Best epoch: 16
best model saved
[2023-11-24 12:51:46] INFO (nni/MainThread) Intermediate result: 0.8131234374784878  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 22.72	mae: 16.91	mape: 37.21%	acc@10: 42.43%	acc@20: 70.23%	acc@30: 85.86%	
[2023-11-24 12:51:46] INFO (nni/MainThread) Intermediate result: 22.719801123060506  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.817 | lsd:0.601 | ed:0.865 | hr@1:0.724 | hr@2:0.875 | hr@3:0.925 | acc@1:0.724 | acc@2:0.65 | acc@3:0.62 | Best krc: 0.813 | Best epoch: 18
best model saved
[2023-11-24 12:53:39] INFO (nni/MainThread) Intermediate result: 0.8168227286810582  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 22.42	mae: 16.69	mape: 36.79%	acc@10: 42.97%	acc@20: 70.47%	acc@30: 86.25%	
[2023-11-24 12:53:39] INFO (nni/MainThread) Intermediate result: 22.416034352038025  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.814 | lsd:0.594 | ed:0.875 | hr@1:0.714 | hr@2:0.878 | hr@3:0.924 | acc@1:0.714 | acc@2:0.641 | acc@3:0.61 | Best krc: 0.817 | Best epoch: 19
[2023-11-24 12:55:38] INFO (nni/MainThread) Intermediate result: 0.8144798293901923  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 22.16	mae: 16.51	mape: 36.42%	acc@10: 43.3%	acc@20: 70.54%	acc@30: 86.61%	
[2023-11-24 12:55:38] INFO (nni/MainThread) Intermediate result: 22.15999255094775  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.817 | lsd:0.602 | ed:0.858 | hr@1:0.718 | hr@2:0.881 | hr@3:0.922 | acc@1:0.718 | acc@2:0.652 | acc@3:0.618 | Best krc: 0.817 | Best epoch: 19
best model saved
[2023-11-24 12:57:35] INFO (nni/MainThread) Intermediate result: 0.8171818869239071  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 21.94	mae: 16.36	mape: 36.15%	acc@10: 43.75%	acc@20: 70.6%	acc@30: 86.93%	
[2023-11-24 12:57:35] INFO (nni/MainThread) Intermediate result: 21.939057870290494  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.814 | lsd:0.597 | ed:0.867 | hr@1:0.704 | hr@2:0.882 | hr@3:0.927 | acc@1:0.704 | acc@2:0.646 | acc@3:0.612 | Best krc: 0.817 | Best epoch: 21
[2023-11-24 12:59:26] INFO (nni/MainThread) Intermediate result: 0.8136826347145543  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 21.82	mae: 16.31	mape: 36.04%	acc@10: 43.48%	acc@20: 70.65%	acc@30: 86.82%	
[2023-11-24 12:59:26] INFO (nni/MainThread) Intermediate result: 21.815963430018886  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.812 | lsd:0.572 | ed:0.866 | hr@1:0.717 | hr@2:0.884 | hr@3:0.926 | acc@1:0.717 | acc@2:0.651 | acc@3:0.61 | Best krc: 0.817 | Best epoch: 21
[2023-11-24 13:01:19] INFO (nni/MainThread) Intermediate result: 0.8122222900097845  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 21.67	mae: 16.24	mape: 35.88%	acc@10: 43.75%	acc@20: 70.7%	acc@30: 86.85%	
[2023-11-24 13:01:19] INFO (nni/MainThread) Intermediate result: 21.671971879032913  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.813 | lsd:0.612 | ed:0.876 | hr@1:0.729 | hr@2:0.875 | hr@3:0.923 | acc@1:0.729 | acc@2:0.653 | acc@3:0.617 | Best krc: 0.817 | Best epoch: 21
[2023-11-24 13:03:07] INFO (nni/MainThread) Intermediate result: 0.8129225824459756  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 21.48	mae: 16.11	mape: 35.62%	acc@10: 43.88%	acc@20: 70.88%	acc@30: 87.0%	
[2023-11-24 13:03:07] INFO (nni/MainThread) Intermediate result: 21.475724775156145  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.646 | ed:0.885 | hr@1:0.734 | hr@2:0.866 | hr@3:0.919 | acc@1:0.734 | acc@2:0.648 | acc@3:0.615 | Best krc: 0.817 | Best epoch: 21
[2023-11-24 13:04:58] INFO (nni/MainThread) Intermediate result: 0.8082363716382079  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 21.34	mae: 16.04	mape: 35.47%	acc@10: 43.87%	acc@20: 70.91%	acc@30: 87.14%	
[2023-11-24 13:04:58] INFO (nni/MainThread) Intermediate result: 21.344193549783498  (Index 51)
*** Epoch: 26 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.649 | ed:0.887 | hr@1:0.728 | hr@2:0.87 | hr@3:0.925 | acc@1:0.728 | acc@2:0.643 | acc@3:0.613 | Best krc: 0.817 | Best epoch: 21
[2023-11-24 13:06:47] INFO (nni/MainThread) Intermediate result: 0.8113962576315004  (Index 52)
-----------------ETPA RESULT-------------------
Epoch 26: Validation	rmse: 21.29	mae: 16.02	mape: 35.41%	acc@10: 43.63%	acc@20: 71.06%	acc@30: 87.38%	
[2023-11-24 13:06:47] INFO (nni/MainThread) Intermediate result: 21.289520655853043  (Index 53)
*** Epoch: 27 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.611 | ed:0.893 | hr@1:0.72 | hr@2:0.868 | hr@3:0.922 | acc@1:0.72 | acc@2:0.644 | acc@3:0.61 | Best krc: 0.817 | Best epoch: 21
[2023-11-24 13:08:35] INFO (nni/MainThread) Intermediate result: 0.8075861617531928  (Index 54)
-----------------ETPA RESULT-------------------
Epoch 27: Validation	rmse: 21.19	mae: 16.0	mape: 35.41%	acc@10: 43.3%	acc@20: 71.09%	acc@30: 87.39%	
[2023-11-24 13:08:35] INFO (nni/MainThread) Intermediate result: 21.191705523118852  (Index 55)
*** Epoch: 28 ***
-----------------G2R RESULT-------------------

val result: krc:0.813 | lsd:0.619 | ed:0.872 | hr@1:0.73 | hr@2:0.872 | hr@3:0.919 | acc@1:0.73 | acc@2:0.654 | acc@3:0.616 | Best krc: 0.817 | Best epoch: 21
[2023-11-24 13:10:24] INFO (nni/MainThread) Intermediate result: 0.8130163302179043  (Index 56)
-----------------ETPA RESULT-------------------
Epoch 28: Validation	rmse: 20.99	mae: 15.88	mape: 35.21%	acc@10: 43.53%	acc@20: 71.44%	acc@30: 87.61%	
[2023-11-24 13:10:24] INFO (nni/MainThread) Intermediate result: 20.99231927074789  (Index 57)
*** Epoch: 29 ***
-----------------G2R RESULT-------------------

val result: krc:0.821 | lsd:0.6 | ed:0.849 | hr@1:0.738 | hr@2:0.879 | hr@3:0.924 | acc@1:0.738 | acc@2:0.666 | acc@3:0.631 | Best krc: 0.817 | Best epoch: 21
best model saved
[2023-11-24 13:12:15] INFO (nni/MainThread) Intermediate result: 0.8209170667063103  (Index 58)
-----------------ETPA RESULT-------------------
Epoch 29: Validation	rmse: 20.86	mae: 15.8	mape: 35.08%	acc@10: 43.44%	acc@20: 71.56%	acc@30: 87.81%	
[2023-11-24 13:12:15] INFO (nni/MainThread) Intermediate result: 20.85829785297011  (Index 59)
*** Epoch: 30 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.601 | ed:0.888 | hr@1:0.697 | hr@2:0.881 | hr@3:0.922 | acc@1:0.697 | acc@2:0.637 | acc@3:0.6 | Best krc: 0.821 | Best epoch: 29
[2023-11-24 13:14:06] INFO (nni/MainThread) Intermediate result: 0.8079174662646459  (Index 60)
-----------------ETPA RESULT-------------------
Epoch 30: Validation	rmse: 20.69	mae: 15.7	mape: 34.89%	acc@10: 43.45%	acc@20: 71.67%	acc@30: 88.1%	
[2023-11-24 13:14:06] INFO (nni/MainThread) Intermediate result: 20.69415880843882  (Index 61)
*** Epoch: 31 ***
-----------------G2R RESULT-------------------

val result: krc:0.814 | lsd:0.607 | ed:0.873 | hr@1:0.725 | hr@2:0.883 | hr@3:0.925 | acc@1:0.725 | acc@2:0.654 | acc@3:0.616 | Best krc: 0.821 | Best epoch: 29
[2023-11-24 13:15:59] INFO (nni/MainThread) Intermediate result: 0.8144138013923757  (Index 62)
-----------------ETPA RESULT-------------------
Epoch 31: Validation	rmse: 20.64	mae: 15.69	mape: 34.88%	acc@10: 43.26%	acc@20: 71.48%	acc@30: 88.09%	
[2023-11-24 13:15:59] INFO (nni/MainThread) Intermediate result: 20.64025074325835  (Index 63)
*** Epoch: 32 ***
-----------------G2R RESULT-------------------

val result: krc:0.815 | lsd:0.614 | ed:0.87 | hr@1:0.741 | hr@2:0.877 | hr@3:0.923 | acc@1:0.741 | acc@2:0.659 | acc@3:0.619 | Best krc: 0.821 | Best epoch: 29
[2023-11-24 13:17:56] INFO (nni/MainThread) Intermediate result: 0.8152311702289838  (Index 64)
-----------------ETPA RESULT-------------------
Epoch 32: Validation	rmse: 20.54	mae: 15.65	mape: 34.81%	acc@10: 43.09%	acc@20: 71.5%	acc@30: 88.26%	
[2023-11-24 13:17:56] INFO (nni/MainThread) Intermediate result: 20.53629693772816  (Index 65)
*** Epoch: 33 ***
-----------------G2R RESULT-------------------

val result: krc:0.814 | lsd:0.557 | ed:0.863 | hr@1:0.714 | hr@2:0.878 | hr@3:0.925 | acc@1:0.714 | acc@2:0.642 | acc@3:0.61 | Best krc: 0.821 | Best epoch: 29
[2023-11-24 13:19:47] INFO (nni/MainThread) Intermediate result: 0.8136797196875903  (Index 66)
-----------------ETPA RESULT-------------------
Epoch 33: Validation	rmse: 20.46	mae: 15.62	mape: 34.76%	acc@10: 42.83%	acc@20: 71.42%	acc@30: 88.42%	
[2023-11-24 13:19:47] INFO (nni/MainThread) Intermediate result: 20.4647785292175  (Index 67)
*** Epoch: 34 ***
-----------------G2R RESULT-------------------

val result: krc:0.82 | lsd:0.569 | ed:0.842 | hr@1:0.726 | hr@2:0.88 | hr@3:0.925 | acc@1:0.726 | acc@2:0.655 | acc@3:0.62 | Best krc: 0.821 | Best epoch: 29
[2023-11-24 13:21:41] INFO (nni/MainThread) Intermediate result: 0.8197138675669501  (Index 68)
-----------------ETPA RESULT-------------------
Epoch 34: Validation	rmse: 20.34	mae: 15.56	mape: 34.67%	acc@10: 42.59%	acc@20: 71.61%	acc@30: 88.66%	
[2023-11-24 13:21:41] INFO (nni/MainThread) Intermediate result: 20.344518087688932  (Index 69)
*** Epoch: 35 ***
-----------------G2R RESULT-------------------

val result: krc:0.819 | lsd:0.574 | ed:0.853 | hr@1:0.73 | hr@2:0.886 | hr@3:0.927 | acc@1:0.73 | acc@2:0.662 | acc@3:0.63 | Best krc: 0.821 | Best epoch: 29
[2023-11-24 13:23:30] INFO (nni/MainThread) Intermediate result: 0.8194966590681501  (Index 70)
-----------------ETPA RESULT-------------------
Epoch 35: Validation	rmse: 20.29	mae: 15.55	mape: 34.65%	acc@10: 42.45%	acc@20: 71.61%	acc@30: 88.8%	
[2023-11-24 13:23:30] INFO (nni/MainThread) Intermediate result: 20.28735405178491  (Index 71)
*** Epoch: 36 ***
-----------------G2R RESULT-------------------

val result: krc:0.823 | lsd:0.559 | ed:0.84 | hr@1:0.733 | hr@2:0.882 | hr@3:0.924 | acc@1:0.733 | acc@2:0.662 | acc@3:0.627 | Best krc: 0.821 | Best epoch: 29
best model saved
[2023-11-24 13:25:20] INFO (nni/MainThread) Intermediate result: 0.8229570102766429  (Index 72)
-----------------ETPA RESULT-------------------
Epoch 36: Validation	rmse: 20.18	mae: 15.48	mape: 34.5%	acc@10: 42.31%	acc@20: 71.71%	acc@30: 88.94%	
[2023-11-24 13:25:20] INFO (nni/MainThread) Intermediate result: 20.182456758590437  (Index 73)
*** Epoch: 37 ***
-----------------G2R RESULT-------------------

val result: krc:0.826 | lsd:0.537 | ed:0.822 | hr@1:0.741 | hr@2:0.885 | hr@3:0.928 | acc@1:0.741 | acc@2:0.672 | acc@3:0.631 | Best krc: 0.823 | Best epoch: 36
best model saved
[2023-11-24 13:27:11] INFO (nni/MainThread) Intermediate result: 0.8264445816697674  (Index 74)
-----------------ETPA RESULT-------------------
Epoch 37: Validation	rmse: 20.13	mae: 15.45	mape: 34.45%	acc@10: 42.19%	acc@20: 71.71%	acc@30: 88.98%	
[2023-11-24 13:27:11] INFO (nni/MainThread) Intermediate result: 20.127924924424086  (Index 75)
*** Epoch: 38 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.576 | ed:0.874 | hr@1:0.72 | hr@2:0.881 | hr@3:0.922 | acc@1:0.72 | acc@2:0.655 | acc@3:0.611 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:29:02] INFO (nni/MainThread) Intermediate result: 0.8114505692205736  (Index 76)
-----------------ETPA RESULT-------------------
Epoch 38: Validation	rmse: 20.03	mae: 15.41	mape: 34.39%	acc@10: 42.15%	acc@20: 71.88%	acc@30: 89.18%	
[2023-11-24 13:29:02] INFO (nni/MainThread) Intermediate result: 20.033734882102273  (Index 77)
*** Epoch: 39 ***
-----------------G2R RESULT-------------------

val result: krc:0.81 | lsd:0.562 | ed:0.877 | hr@1:0.71 | hr@2:0.881 | hr@3:0.924 | acc@1:0.71 | acc@2:0.645 | acc@3:0.604 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:30:54] INFO (nni/MainThread) Intermediate result: 0.8097292349587931  (Index 78)
-----------------ETPA RESULT-------------------
Epoch 39: Validation	rmse: 19.93	mae: 15.35	mape: 34.24%	acc@10: 42.11%	acc@20: 72.03%	acc@30: 89.3%	
[2023-11-24 13:30:54] INFO (nni/MainThread) Intermediate result: 19.933851233271383  (Index 79)
*** Epoch: 40 ***
-----------------G2R RESULT-------------------

val result: krc:0.824 | lsd:0.546 | ed:0.829 | hr@1:0.735 | hr@2:0.881 | hr@3:0.93 | acc@1:0.735 | acc@2:0.663 | acc@3:0.628 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:32:47] INFO (nni/MainThread) Intermediate result: 0.8236115074418529  (Index 80)
-----------------ETPA RESULT-------------------
Epoch 40: Validation	rmse: 19.86	mae: 15.31	mape: 34.17%	acc@10: 42.0%	acc@20: 72.18%	acc@30: 89.41%	
[2023-11-24 13:32:47] INFO (nni/MainThread) Intermediate result: 19.857560506235213  (Index 81)
*** Epoch: 41 ***
-----------------G2R RESULT-------------------

val result: krc:0.81 | lsd:0.613 | ed:0.878 | hr@1:0.716 | hr@2:0.87 | hr@3:0.925 | acc@1:0.716 | acc@2:0.646 | acc@3:0.612 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:34:42] INFO (nni/MainThread) Intermediate result: 0.8097256232892436  (Index 82)
-----------------ETPA RESULT-------------------
Epoch 41: Validation	rmse: 19.75	mae: 15.26	mape: 34.04%	acc@10: 42.04%	acc@20: 72.47%	acc@30: 89.58%	
[2023-11-24 13:34:42] INFO (nni/MainThread) Intermediate result: 19.754554633696028  (Index 83)
*** Epoch: 42 ***
-----------------G2R RESULT-------------------

val result: krc:0.82 | lsd:0.582 | ed:0.846 | hr@1:0.726 | hr@2:0.873 | hr@3:0.925 | acc@1:0.726 | acc@2:0.654 | acc@3:0.622 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:36:37] INFO (nni/MainThread) Intermediate result: 0.8200088376214305  (Index 84)
-----------------ETPA RESULT-------------------
Epoch 42: Validation	rmse: 19.68	mae: 15.23	mape: 34.02%	acc@10: 41.93%	acc@20: 72.6%	acc@30: 89.68%	
[2023-11-24 13:36:37] INFO (nni/MainThread) Intermediate result: 19.68422490217041  (Index 85)
*** Epoch: 43 ***
-----------------G2R RESULT-------------------

val result: krc:0.805 | lsd:0.625 | ed:0.881 | hr@1:0.707 | hr@2:0.874 | hr@3:0.92 | acc@1:0.707 | acc@2:0.64 | acc@3:0.603 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:38:31] INFO (nni/MainThread) Intermediate result: 0.80459430219815  (Index 86)
-----------------ETPA RESULT-------------------
Epoch 43: Validation	rmse: 19.6	mae: 15.19	mape: 33.92%	acc@10: 41.83%	acc@20: 72.8%	acc@30: 89.84%	
[2023-11-24 13:38:31] INFO (nni/MainThread) Intermediate result: 19.601027396034763  (Index 87)
*** Epoch: 44 ***
-----------------G2R RESULT-------------------

val result: krc:0.818 | lsd:0.564 | ed:0.855 | hr@1:0.723 | hr@2:0.882 | hr@3:0.928 | acc@1:0.723 | acc@2:0.656 | acc@3:0.62 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:40:23] INFO (nni/MainThread) Intermediate result: 0.8182725075860188  (Index 88)
-----------------ETPA RESULT-------------------
Epoch 44: Validation	rmse: 19.56	mae: 15.18	mape: 33.93%	acc@10: 41.74%	acc@20: 72.78%	acc@30: 89.86%	
[2023-11-24 13:40:23] INFO (nni/MainThread) Intermediate result: 19.562870041768534  (Index 89)
*** Epoch: 45 ***
-----------------G2R RESULT-------------------

val result: krc:0.824 | lsd:0.565 | ed:0.83 | hr@1:0.733 | hr@2:0.886 | hr@3:0.928 | acc@1:0.733 | acc@2:0.668 | acc@3:0.635 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:42:17] INFO (nni/MainThread) Intermediate result: 0.8235250076002154  (Index 90)
-----------------ETPA RESULT-------------------
Epoch 45: Validation	rmse: 19.55	mae: 15.18	mape: 33.89%	acc@10: 41.85%	acc@20: 72.62%	acc@30: 89.81%	
[2023-11-24 13:42:17] INFO (nni/MainThread) Intermediate result: 19.549284429430106  (Index 91)
*** Epoch: 46 ***
-----------------G2R RESULT-------------------

val result: krc:0.818 | lsd:0.607 | ed:0.85 | hr@1:0.728 | hr@2:0.882 | hr@3:0.926 | acc@1:0.728 | acc@2:0.659 | acc@3:0.626 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:44:13] INFO (nni/MainThread) Intermediate result: 0.8175456058621778  (Index 92)
-----------------ETPA RESULT-------------------
Epoch 46: Validation	rmse: 19.53	mae: 15.17	mape: 33.86%	acc@10: 41.89%	acc@20: 72.47%	acc@30: 89.76%	
[2023-11-24 13:44:13] INFO (nni/MainThread) Intermediate result: 19.528396231671532  (Index 93)
*** Epoch: 47 ***
-----------------G2R RESULT-------------------

val result: krc:0.823 | lsd:0.566 | ed:0.844 | hr@1:0.737 | hr@2:0.883 | hr@3:0.929 | acc@1:0.737 | acc@2:0.665 | acc@3:0.629 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:46:04] INFO (nni/MainThread) Intermediate result: 0.8228596912812042  (Index 94)
-----------------ETPA RESULT-------------------
Epoch 47: Validation	rmse: 19.45	mae: 15.14	mape: 33.82%	acc@10: 41.8%	acc@20: 72.59%	acc@30: 89.91%	
[2023-11-24 13:46:04] INFO (nni/MainThread) Intermediate result: 19.452024850047493  (Index 95)
*** Epoch: 48 ***
-----------------G2R RESULT-------------------

val result: krc:0.821 | lsd:0.568 | ed:0.841 | hr@1:0.728 | hr@2:0.883 | hr@3:0.927 | acc@1:0.728 | acc@2:0.664 | acc@3:0.629 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:47:59] INFO (nni/MainThread) Intermediate result: 0.82121404159008  (Index 96)
-----------------ETPA RESULT-------------------
Epoch 48: Validation	rmse: 19.46	mae: 15.15	mape: 33.84%	acc@10: 41.65%	acc@20: 72.39%	acc@30: 89.8%	
[2023-11-24 13:47:59] INFO (nni/MainThread) Intermediate result: 19.458862347771518  (Index 97)
*** Epoch: 49 ***
-----------------G2R RESULT-------------------

val result: krc:0.81 | lsd:0.591 | ed:0.871 | hr@1:0.712 | hr@2:0.877 | hr@3:0.922 | acc@1:0.712 | acc@2:0.646 | acc@3:0.61 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:49:54] INFO (nni/MainThread) Intermediate result: 0.8097180123153012  (Index 98)
-----------------ETPA RESULT-------------------
Epoch 49: Validation	rmse: 19.41	mae: 15.13	mape: 33.79%	acc@10: 41.56%	acc@20: 72.44%	acc@30: 89.88%	
[2023-11-24 13:49:54] INFO (nni/MainThread) Intermediate result: 19.40537227135563  (Index 99)
*** Epoch: 50 ***
-----------------G2R RESULT-------------------

val result: krc:0.824 | lsd:0.549 | ed:0.834 | hr@1:0.735 | hr@2:0.883 | hr@3:0.929 | acc@1:0.735 | acc@2:0.666 | acc@3:0.629 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:51:46] INFO (nni/MainThread) Intermediate result: 0.8236953284613976  (Index 100)
-----------------ETPA RESULT-------------------
Epoch 50: Validation	rmse: 19.35	mae: 15.11	mape: 33.76%	acc@10: 41.48%	acc@20: 72.49%	acc@30: 90.01%	
[2023-11-24 13:51:46] INFO (nni/MainThread) Intermediate result: 19.350198461813758  (Index 101)
*** Epoch: 51 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.597 | ed:0.917 | hr@1:0.698 | hr@2:0.876 | hr@3:0.922 | acc@1:0.698 | acc@2:0.627 | acc@3:0.587 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:53:36] INFO (nni/MainThread) Intermediate result: 0.7986675925897615  (Index 102)
-----------------ETPA RESULT-------------------
Epoch 51: Validation	rmse: 19.35	mae: 15.12	mape: 33.76%	acc@10: 41.47%	acc@20: 72.3%	acc@30: 90.02%	
[2023-11-24 13:53:36] INFO (nni/MainThread) Intermediate result: 19.347842015128606  (Index 103)
*** Epoch: 52 ***
-----------------G2R RESULT-------------------

val result: krc:0.815 | lsd:0.563 | ed:0.861 | hr@1:0.716 | hr@2:0.884 | hr@3:0.929 | acc@1:0.716 | acc@2:0.654 | acc@3:0.62 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:55:32] INFO (nni/MainThread) Intermediate result: 0.8151441704742974  (Index 104)
-----------------ETPA RESULT-------------------
Epoch 52: Validation	rmse: 19.31	mae: 15.12	mape: 33.76%	acc@10: 41.33%	acc@20: 72.35%	acc@30: 90.15%	
[2023-11-24 13:55:32] INFO (nni/MainThread) Intermediate result: 19.30856760762235  (Index 105)
*** Epoch: 53 ***
-----------------G2R RESULT-------------------

val result: krc:0.816 | lsd:0.57 | ed:0.86 | hr@1:0.728 | hr@2:0.88 | hr@3:0.925 | acc@1:0.728 | acc@2:0.655 | acc@3:0.618 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:57:28] INFO (nni/MainThread) Intermediate result: 0.8156932147837264  (Index 106)
-----------------ETPA RESULT-------------------
Epoch 53: Validation	rmse: 19.28	mae: 15.11	mape: 33.77%	acc@10: 41.2%	acc@20: 72.34%	acc@30: 90.22%	
[2023-11-24 13:57:28] INFO (nni/MainThread) Intermediate result: 19.280893901714485  (Index 107)
*** Epoch: 54 ***
-----------------G2R RESULT-------------------

val result: krc:0.822 | lsd:0.569 | ed:0.843 | hr@1:0.738 | hr@2:0.884 | hr@3:0.929 | acc@1:0.738 | acc@2:0.666 | acc@3:0.63 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 13:59:24] INFO (nni/MainThread) Intermediate result: 0.8217465127303342  (Index 108)
-----------------ETPA RESULT-------------------
Epoch 54: Validation	rmse: 19.25	mae: 15.11	mape: 33.78%	acc@10: 41.08%	acc@20: 72.27%	acc@30: 90.28%	
[2023-11-24 13:59:24] INFO (nni/MainThread) Intermediate result: 19.249280104074977  (Index 109)
*** Epoch: 55 ***
-----------------G2R RESULT-------------------

val result: krc:0.812 | lsd:0.586 | ed:0.861 | hr@1:0.715 | hr@2:0.878 | hr@3:0.924 | acc@1:0.715 | acc@2:0.644 | acc@3:0.613 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 14:01:20] INFO (nni/MainThread) Intermediate result: 0.8116888653137013  (Index 110)
-----------------ETPA RESULT-------------------
Epoch 55: Validation	rmse: 19.22	mae: 15.11	mape: 33.79%	acc@10: 40.96%	acc@20: 72.21%	acc@30: 90.35%	
[2023-11-24 14:01:20] INFO (nni/MainThread) Intermediate result: 19.218788256536282  (Index 111)
*** Epoch: 56 ***
-----------------G2R RESULT-------------------

val result: krc:0.82 | lsd:0.569 | ed:0.843 | hr@1:0.732 | hr@2:0.877 | hr@3:0.926 | acc@1:0.732 | acc@2:0.658 | acc@3:0.625 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 14:03:15] INFO (nni/MainThread) Intermediate result: 0.8204792713319168  (Index 112)
-----------------ETPA RESULT-------------------
Epoch 56: Validation	rmse: 19.19	mae: 15.09	mape: 33.7%	acc@10: 41.01%	acc@20: 72.31%	acc@30: 90.41%	
[2023-11-24 14:03:15] INFO (nni/MainThread) Intermediate result: 19.19040915249471  (Index 113)
*** Epoch: 57 ***
-----------------G2R RESULT-------------------

val result: krc:0.813 | lsd:0.563 | ed:0.87 | hr@1:0.715 | hr@2:0.877 | hr@3:0.923 | acc@1:0.715 | acc@2:0.643 | acc@3:0.611 | Best krc: 0.826 | Best epoch: 37
[2023-11-24 14:05:09] INFO (nni/MainThread) Intermediate result: 0.8130603141534494  (Index 114)
-----------------ETPA RESULT-------------------
Epoch 57: Validation	rmse: 19.14	mae: 15.06	mape: 33.65%	acc@10: 40.84%	acc@20: 72.47%	acc@30: 90.46%	
[2023-11-24 14:05:09] INFO (nni/MainThread) Intermediate result: 19.144113863564623  (Index 115)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1700824433.92820741700824433.9282243
best model loaded !!!
krc:0.817 | lsd:0.421 | ed:0.859 | hr@1:0.72 | hr@2:0.911 | hr@3:0.949 | acc@1:0.72 | acc@2:0.659 | acc@3:0.615 |

-------------------------------------------------------------
Best epoch for G2R:  37
Best epoch for ETPA:  57
graph2route_pd Evaluation in test: krc:0.817 | lsd:0.421 | ed:0.859 | hr@1:0.72 | hr@2:0.911 | hr@3:0.949 | acc@1:0.72 | acc@2:0.659 | acc@3:0.615 |
RankPETA Evaluation in test: rmse: 12.84	mae: 10.44	mape: 91.33%	acc@10: 50.0%	acc@20: 85.0%	acc@30: 100.0%	
