Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 9999,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.57 | lsd:1.493 | ed:1.555 | hr@1:0.564 | hr@2:0.701 | hr@3:0.818 | acc@1:0.564 | acc@2:0.415 | acc@3:0.387 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-18 10:28:38] INFO (nni/MainThread) Intermediate result: 0.5704851821161396  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 23.36	mae: 17.29	mape: 104.79%	acc@10: 40.37%	acc@20: 70.0%	acc@30: 83.7%	
[2023-12-18 10:28:38] INFO (nni/MainThread) Intermediate result: 23.356633931986273  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.708 | lsd:0.956 | ed:1.195 | hr@1:0.636 | hr@2:0.812 | hr@3:0.875 | acc@1:0.636 | acc@2:0.532 | acc@3:0.487 | Best krc: 0.57 | Best epoch: 0
best model saved
[2023-12-18 10:30:15] INFO (nni/MainThread) Intermediate result: 0.7076508009957944  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 22.77	mae: 16.74	mape: 107.08%	acc@10: 42.59%	acc@20: 70.93%	acc@30: 83.15%	
[2023-12-18 10:30:16] INFO (nni/MainThread) Intermediate result: 22.766901673494345  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.722 | lsd:0.887 | ed:1.153 | hr@1:0.645 | hr@2:0.826 | hr@3:0.888 | acc@1:0.645 | acc@2:0.554 | acc@3:0.507 | Best krc: 0.708 | Best epoch: 1
best model saved
[2023-12-18 10:31:52] INFO (nni/MainThread) Intermediate result: 0.7224165262905972  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 22.19	mae: 16.26	mape: 106.17%	acc@10: 44.57%	acc@20: 71.6%	acc@30: 83.46%	
[2023-12-18 10:31:52] INFO (nni/MainThread) Intermediate result: 22.19195486103488  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.74 | lsd:0.81 | ed:1.085 | hr@1:0.641 | hr@2:0.841 | hr@3:0.899 | acc@1:0.641 | acc@2:0.563 | acc@3:0.528 | Best krc: 0.722 | Best epoch: 2
best model saved
[2023-12-18 10:33:31] INFO (nni/MainThread) Intermediate result: 0.740124345686217  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 21.7	mae: 16.15	mape: 108.86%	acc@10: 43.98%	acc@20: 71.57%	acc@30: 84.35%	
[2023-12-18 10:33:31] INFO (nni/MainThread) Intermediate result: 21.702520682303707  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.747 | lsd:0.762 | ed:1.059 | hr@1:0.645 | hr@2:0.844 | hr@3:0.899 | acc@1:0.645 | acc@2:0.571 | acc@3:0.528 | Best krc: 0.74 | Best epoch: 3
best model saved
[2023-12-18 10:35:09] INFO (nni/MainThread) Intermediate result: 0.7472074447763122  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 20.87	mae: 15.61	mape: 106.35%	acc@10: 44.81%	acc@20: 72.52%	acc@30: 85.26%	
[2023-12-18 10:35:09] INFO (nni/MainThread) Intermediate result: 20.86926437762156  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.706 | ed:1.004 | hr@1:0.664 | hr@2:0.857 | hr@3:0.909 | acc@1:0.664 | acc@2:0.59 | acc@3:0.551 | Best krc: 0.747 | Best epoch: 4
best model saved
[2023-12-18 10:36:46] INFO (nni/MainThread) Intermediate result: 0.7691449226735626  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 20.31	mae: 15.26	mape: 104.85%	acc@10: 44.75%	acc@20: 73.77%	acc@30: 85.86%	
[2023-12-18 10:36:46] INFO (nni/MainThread) Intermediate result: 20.306288688918738  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.693 | ed:1.008 | hr@1:0.679 | hr@2:0.858 | hr@3:0.91 | acc@1:0.679 | acc@2:0.594 | acc@3:0.555 | Best krc: 0.769 | Best epoch: 5
best model saved
[2023-12-18 10:38:24] INFO (nni/MainThread) Intermediate result: 0.76977785077479  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 19.65	mae: 14.86	mape: 102.97%	acc@10: 45.13%	acc@20: 74.76%	acc@30: 86.88%	
[2023-12-18 10:38:24] INFO (nni/MainThread) Intermediate result: 19.649472631192506  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.785 | ed:1.031 | hr@1:0.706 | hr@2:0.842 | hr@3:0.902 | acc@1:0.706 | acc@2:0.6 | acc@3:0.561 | Best krc: 0.77 | Best epoch: 6
[2023-12-18 10:40:00] INFO (nni/MainThread) Intermediate result: 0.7692224108140155  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.35	mae: 14.73	mape: 103.18%	acc@10: 45.05%	acc@20: 75.09%	acc@30: 87.27%	
[2023-12-18 10:40:00] INFO (nni/MainThread) Intermediate result: 19.348422713409843  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.794 | lsd:0.685 | ed:0.942 | hr@1:0.711 | hr@2:0.862 | hr@3:0.911 | acc@1:0.711 | acc@2:0.628 | acc@3:0.588 | Best krc: 0.77 | Best epoch: 6
best model saved
[2023-12-18 10:41:35] INFO (nni/MainThread) Intermediate result: 0.793798078389246  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.79	mae: 14.39	mape: 101.33%	acc@10: 45.43%	acc@20: 76.13%	acc@30: 88.27%	
[2023-12-18 10:41:35] INFO (nni/MainThread) Intermediate result: 18.794992373839435  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.792 | lsd:0.682 | ed:0.948 | hr@1:0.722 | hr@2:0.859 | hr@3:0.916 | acc@1:0.722 | acc@2:0.63 | acc@3:0.597 | Best krc: 0.794 | Best epoch: 8
[2023-12-18 10:43:10] INFO (nni/MainThread) Intermediate result: 0.791838250981233  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.39	mae: 14.1	mape: 99.61%	acc@10: 46.22%	acc@20: 76.81%	acc@30: 89.0%	
[2023-12-18 10:43:10] INFO (nni/MainThread) Intermediate result: 18.391356634610233  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.63 | ed:0.917 | hr@1:0.693 | hr@2:0.871 | hr@3:0.918 | acc@1:0.693 | acc@2:0.625 | acc@3:0.592 | Best krc: 0.794 | Best epoch: 8
best model saved
[2023-12-18 10:44:46] INFO (nni/MainThread) Intermediate result: 0.8027621690848624  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 18.1	mae: 13.92	mape: 98.67%	acc@10: 46.46%	acc@20: 77.34%	acc@30: 89.39%	
[2023-12-18 10:44:46] INFO (nni/MainThread) Intermediate result: 18.100734317402203  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.63 | ed:0.94 | hr@1:0.698 | hr@2:0.865 | hr@3:0.916 | acc@1:0.698 | acc@2:0.621 | acc@3:0.584 | Best krc: 0.803 | Best epoch: 10
[2023-12-18 10:46:21] INFO (nni/MainThread) Intermediate result: 0.7991427206293842  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.98	mae: 13.84	mape: 98.58%	acc@10: 46.45%	acc@20: 77.62%	acc@30: 89.57%	
[2023-12-18 10:46:21] INFO (nni/MainThread) Intermediate result: 17.97611135592657  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.783 | lsd:0.669 | ed:0.975 | hr@1:0.679 | hr@2:0.858 | hr@3:0.914 | acc@1:0.679 | acc@2:0.603 | acc@3:0.566 | Best krc: 0.803 | Best epoch: 10
[2023-12-18 10:47:57] INFO (nni/MainThread) Intermediate result: 0.7827606910247926  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.79	mae: 13.73	mape: 98.1%	acc@10: 46.7%	acc@20: 77.86%	acc@30: 89.89%	
[2023-12-18 10:47:57] INFO (nni/MainThread) Intermediate result: 17.791633009819343  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.793 | lsd:0.642 | ed:0.941 | hr@1:0.707 | hr@2:0.864 | hr@3:0.914 | acc@1:0.707 | acc@2:0.631 | acc@3:0.592 | Best krc: 0.803 | Best epoch: 10
[2023-12-18 10:49:32] INFO (nni/MainThread) Intermediate result: 0.7934950673385304  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.69	mae: 13.68	mape: 98.18%	acc@10: 46.67%	acc@20: 78.02%	acc@30: 90.05%	
[2023-12-18 10:49:32] INFO (nni/MainThread) Intermediate result: 17.687598780735005  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.805 | lsd:0.639 | ed:0.916 | hr@1:0.725 | hr@2:0.864 | hr@3:0.919 | acc@1:0.725 | acc@2:0.638 | acc@3:0.604 | Best krc: 0.803 | Best epoch: 10
best model saved
[2023-12-18 10:51:08] INFO (nni/MainThread) Intermediate result: 0.8046588812570449  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.53	mae: 13.59	mape: 97.82%	acc@10: 46.86%	acc@20: 78.2%	acc@30: 90.37%	
[2023-12-18 10:51:08] INFO (nni/MainThread) Intermediate result: 17.533369652702905  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.595 | ed:0.874 | hr@1:0.717 | hr@2:0.876 | hr@3:0.921 | acc@1:0.717 | acc@2:0.645 | acc@3:0.609 | Best krc: 0.805 | Best epoch: 14
best model saved
[2023-12-18 10:52:44] INFO (nni/MainThread) Intermediate result: 0.8111032775221669  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 17.37	mae: 13.48	mape: 96.94%	acc@10: 47.2%	acc@20: 78.47%	acc@30: 90.6%	
[2023-12-18 10:52:44] INFO (nni/MainThread) Intermediate result: 17.37153743037435  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.798 | lsd:0.648 | ed:0.94 | hr@1:0.721 | hr@2:0.87 | hr@3:0.916 | acc@1:0.721 | acc@2:0.637 | acc@3:0.594 | Best krc: 0.811 | Best epoch: 15
[2023-12-18 10:54:20] INFO (nni/MainThread) Intermediate result: 0.7982388060044379  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 17.31	mae: 13.44	mape: 96.59%	acc@10: 47.32%	acc@20: 78.56%	acc@30: 90.65%	
[2023-12-18 10:54:20] INFO (nni/MainThread) Intermediate result: 17.31126544734933  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.805 | lsd:0.624 | ed:0.914 | hr@1:0.719 | hr@2:0.866 | hr@3:0.919 | acc@1:0.719 | acc@2:0.635 | acc@3:0.601 | Best krc: 0.811 | Best epoch: 15
[2023-12-18 10:55:56] INFO (nni/MainThread) Intermediate result: 0.8047114442829353  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 17.24	mae: 13.41	mape: 96.52%	acc@10: 47.37%	acc@20: 78.66%	acc@30: 90.8%	
[2023-12-18 10:55:56] INFO (nni/MainThread) Intermediate result: 17.239172673991153  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.807 | lsd:0.612 | ed:0.899 | hr@1:0.716 | hr@2:0.876 | hr@3:0.921 | acc@1:0.716 | acc@2:0.642 | acc@3:0.602 | Best krc: 0.811 | Best epoch: 15
[2023-12-18 10:57:31] INFO (nni/MainThread) Intermediate result: 0.807407802484322  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 17.16	mae: 13.36	mape: 96.12%	acc@10: 47.43%	acc@20: 78.83%	acc@30: 90.86%	
[2023-12-18 10:57:31] INFO (nni/MainThread) Intermediate result: 17.161396069389056  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.606 | ed:0.906 | hr@1:0.698 | hr@2:0.871 | hr@3:0.92 | acc@1:0.698 | acc@2:0.628 | acc@3:0.597 | Best krc: 0.811 | Best epoch: 15
[2023-12-18 10:59:06] INFO (nni/MainThread) Intermediate result: 0.8032657015691559  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 17.05	mae: 13.28	mape: 95.45%	acc@10: 47.65%	acc@20: 79.02%	acc@30: 91.0%	
[2023-12-18 10:59:06] INFO (nni/MainThread) Intermediate result: 17.05459436907412  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.794 | lsd:0.645 | ed:0.93 | hr@1:0.671 | hr@2:0.87 | hr@3:0.92 | acc@1:0.671 | acc@2:0.609 | acc@3:0.578 | Best krc: 0.811 | Best epoch: 15
[2023-12-18 11:00:41] INFO (nni/MainThread) Intermediate result: 0.7939236448987215  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.97	mae: 13.23	mape: 94.96%	acc@10: 47.8%	acc@20: 79.1%	acc@30: 91.16%	
[2023-12-18 11:00:41] INFO (nni/MainThread) Intermediate result: 16.971630613781446  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.807 | lsd:0.591 | ed:0.89 | hr@1:0.699 | hr@2:0.874 | hr@3:0.923 | acc@1:0.699 | acc@2:0.63 | acc@3:0.596 | Best krc: 0.811 | Best epoch: 15
[2023-12-18 11:02:18] INFO (nni/MainThread) Intermediate result: 0.8070761339585124  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.87	mae: 13.18	mape: 94.49%	acc@10: 47.88%	acc@20: 79.18%	acc@30: 91.4%	
[2023-12-18 11:02:18] INFO (nni/MainThread) Intermediate result: 16.872132984645464  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.809 | lsd:0.608 | ed:0.889 | hr@1:0.717 | hr@2:0.875 | hr@3:0.922 | acc@1:0.717 | acc@2:0.645 | acc@3:0.612 | Best krc: 0.811 | Best epoch: 15
[2023-12-18 11:03:54] INFO (nni/MainThread) Intermediate result: 0.8086106104295872  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.75	mae: 13.09	mape: 93.6%	acc@10: 48.13%	acc@20: 79.36%	acc@30: 91.56%	
[2023-12-18 11:03:54] INFO (nni/MainThread) Intermediate result: 16.753842017684754  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.632 | ed:0.897 | hr@1:0.73 | hr@2:0.871 | hr@3:0.92 | acc@1:0.73 | acc@2:0.652 | acc@3:0.61 | Best krc: 0.811 | Best epoch: 15
[2023-12-18 11:05:31] INFO (nni/MainThread) Intermediate result: 0.8076643009130985  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 16.68	mae: 13.05	mape: 93.24%	acc@10: 48.13%	acc@20: 79.38%	acc@30: 91.76%	
[2023-12-18 11:05:31] INFO (nni/MainThread) Intermediate result: 16.679930222889407  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.804 | lsd:0.612 | ed:0.92 | hr@1:0.712 | hr@2:0.87 | hr@3:0.92 | acc@1:0.712 | acc@2:0.636 | acc@3:0.6 | Best krc: 0.811 | Best epoch: 15
[2023-12-18 11:07:08] INFO (nni/MainThread) Intermediate result: 0.80392870696325  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 16.58	mae: 12.97	mape: 92.5%	acc@10: 48.39%	acc@20: 79.57%	acc@30: 91.93%	
[2023-12-18 11:07:08] INFO (nni/MainThread) Intermediate result: 16.578197835043355  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.804 | lsd:0.628 | ed:0.915 | hr@1:0.716 | hr@2:0.868 | hr@3:0.918 | acc@1:0.716 | acc@2:0.64 | acc@3:0.599 | Best krc: 0.811 | Best epoch: 15
[2023-12-18 11:08:45] INFO (nni/MainThread) Intermediate result: 0.8038344670439116  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 16.53	mae: 12.94	mape: 92.23%	acc@10: 48.39%	acc@20: 79.63%	acc@30: 92.04%	
[2023-12-18 11:08:45] INFO (nni/MainThread) Intermediate result: 16.52752752995235  (Index 51)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702891620.35747481702891620.357489
best model loaded !!!
krc:0.8 | lsd:0.46 | ed:0.911 | hr@1:0.712 | hr@2:0.901 | hr@3:0.943 | acc@1:0.712 | acc@2:0.646 | acc@3:0.604 |

-------------------------------------------------------------
Best epoch for G2R:  15
Best epoch for ETPA:  25
graph2route_pd Evaluation in test: krc:0.8 | lsd:0.46 | ed:0.911 | hr@1:0.712 | hr@2:0.901 | hr@3:0.943 | acc@1:0.712 | acc@2:0.646 | acc@3:0.604 |
RankPETA Evaluation in test: rmse: 13.57	mae: 10.76	mape: 95.06%	acc@10: 53.59%	acc@20: 84.81%	acc@30: 97.05%	
