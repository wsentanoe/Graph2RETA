Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 8888,
 'sort_mode': 'true_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:38
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.739 | lsd:0.784 | ed:1.056 | hr@1:0.62 | hr@2:0.843 | hr@3:0.895 | acc@1:0.62 | acc@2:0.563 | acc@3:0.52 | Best krc: -1 | Best epoch: -1
best model saved
[2023-11-29 15:37:37] INFO (nni/MainThread) Intermediate result: 0.7387671882118755  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 40.03	mae: 33.72	mape: 65.32%	acc@10: 9.38%	acc@20: 25.0%	acc@30: 43.75%	
[2023-11-29 15:37:37] INFO (nni/MainThread) Intermediate result: 40.03167538562042  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.752 | lsd:0.74 | ed:1.017 | hr@1:0.627 | hr@2:0.853 | hr@3:0.901 | acc@1:0.627 | acc@2:0.569 | acc@3:0.531 | Best krc: 0.739 | Best epoch: 0
best model saved
[2023-11-29 15:39:21] INFO (nni/MainThread) Intermediate result: 0.7518322060779429  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 34.0	mae: 26.61	mape: 51.85%	acc@10: 23.44%	acc@20: 46.88%	acc@30: 65.62%	
[2023-11-29 15:39:21] INFO (nni/MainThread) Intermediate result: 34.001247592540594  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.693 | ed:1.02 | hr@1:0.63 | hr@2:0.858 | hr@3:0.904 | acc@1:0.63 | acc@2:0.568 | acc@3:0.532 | Best krc: 0.752 | Best epoch: 1
best model saved
[2023-11-29 15:41:05] INFO (nni/MainThread) Intermediate result: 0.7595664216914763  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 31.28	mae: 24.38	mape: 50.77%	acc@10: 22.92%	acc@20: 51.04%	acc@30: 71.88%	
[2023-11-29 15:41:05] INFO (nni/MainThread) Intermediate result: 31.27515522978156  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.709 | ed:1.004 | hr@1:0.635 | hr@2:0.859 | hr@3:0.906 | acc@1:0.635 | acc@2:0.582 | acc@3:0.537 | Best krc: 0.76 | Best epoch: 2
[2023-11-29 15:42:50] INFO (nni/MainThread) Intermediate result: 0.7588497447264391  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 29.28	mae: 22.38	mape: 47.57%	acc@10: 26.56%	acc@20: 57.03%	acc@30: 75.78%	
[2023-11-29 15:42:50] INFO (nni/MainThread) Intermediate result: 29.280160080322414  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.755 | lsd:0.723 | ed:1.017 | hr@1:0.629 | hr@2:0.854 | hr@3:0.902 | acc@1:0.629 | acc@2:0.568 | acc@3:0.528 | Best krc: 0.76 | Best epoch: 2
[2023-11-29 15:44:37] INFO (nni/MainThread) Intermediate result: 0.7546650910183923  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 27.85	mae: 21.17	mape: 45.48%	acc@10: 28.75%	acc@20: 60.62%	acc@30: 78.75%	
[2023-11-29 15:44:37] INFO (nni/MainThread) Intermediate result: 27.85421182078486  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.695 | ed:0.981 | hr@1:0.639 | hr@2:0.861 | hr@3:0.907 | acc@1:0.639 | acc@2:0.585 | acc@3:0.546 | Best krc: 0.76 | Best epoch: 2
best model saved
[2023-11-29 15:46:25] INFO (nni/MainThread) Intermediate result: 0.7701519814943514  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 26.8	mae: 20.2	mape: 43.33%	acc@10: 31.25%	acc@20: 61.98%	acc@30: 81.25%	
[2023-11-29 15:46:25] INFO (nni/MainThread) Intermediate result: 26.795206088495334  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.681 | ed:0.979 | hr@1:0.648 | hr@2:0.861 | hr@3:0.907 | acc@1:0.648 | acc@2:0.596 | acc@3:0.554 | Best krc: 0.77 | Best epoch: 5
best model saved
[2023-11-29 15:48:13] INFO (nni/MainThread) Intermediate result: 0.7726154578712514  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 25.67	mae: 19.21	mape: 41.21%	acc@10: 33.48%	acc@20: 65.62%	acc@30: 83.04%	
[2023-11-29 15:48:13] INFO (nni/MainThread) Intermediate result: 25.669315525075866  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.671 | ed:0.966 | hr@1:0.658 | hr@2:0.863 | hr@3:0.911 | acc@1:0.658 | acc@2:0.598 | acc@3:0.563 | Best krc: 0.773 | Best epoch: 6
best model saved
[2023-11-29 15:50:01] INFO (nni/MainThread) Intermediate result: 0.7801819638199173  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 25.1	mae: 18.86	mape: 40.59%	acc@10: 33.98%	acc@20: 66.41%	acc@30: 84.38%	
[2023-11-29 15:50:01] INFO (nni/MainThread) Intermediate result: 25.103178955331565  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.666 | ed:0.97 | hr@1:0.65 | hr@2:0.864 | hr@3:0.91 | acc@1:0.65 | acc@2:0.595 | acc@3:0.557 | Best krc: 0.78 | Best epoch: 7
[2023-11-29 15:51:48] INFO (nni/MainThread) Intermediate result: 0.7754808666046095  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 24.36	mae: 18.29	mape: 39.29%	acc@10: 35.76%	acc@20: 68.06%	acc@30: 85.42%	
[2023-11-29 15:51:48] INFO (nni/MainThread) Intermediate result: 24.3632818139648  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.662 | ed:0.958 | hr@1:0.656 | hr@2:0.865 | hr@3:0.91 | acc@1:0.656 | acc@2:0.598 | acc@3:0.562 | Best krc: 0.78 | Best epoch: 7
[2023-11-29 15:53:35] INFO (nni/MainThread) Intermediate result: 0.7790647248102429  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 23.62	mae: 17.72	mape: 38.17%	acc@10: 36.88%	acc@20: 69.06%	acc@30: 86.25%	
[2023-11-29 15:53:35] INFO (nni/MainThread) Intermediate result: 23.62337167287574  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.707 | ed:1.005 | hr@1:0.646 | hr@2:0.862 | hr@3:0.905 | acc@1:0.646 | acc@2:0.589 | acc@3:0.544 | Best krc: 0.78 | Best epoch: 7
[2023-11-29 15:55:22] INFO (nni/MainThread) Intermediate result: 0.7669175492437408  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 23.21	mae: 17.47	mape: 37.83%	acc@10: 37.22%	acc@20: 69.89%	acc@30: 86.93%	
[2023-11-29 15:55:22] INFO (nni/MainThread) Intermediate result: 23.21109466555349  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.79 | lsd:0.646 | ed:0.935 | hr@1:0.679 | hr@2:0.864 | hr@3:0.913 | acc@1:0.679 | acc@2:0.612 | acc@3:0.575 | Best krc: 0.78 | Best epoch: 7
best model saved
[2023-11-29 15:57:09] INFO (nni/MainThread) Intermediate result: 0.7901442385045359  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 23.0	mae: 17.39	mape: 37.79%	acc@10: 37.5%	acc@20: 69.01%	acc@30: 87.24%	
[2023-11-29 15:57:09] INFO (nni/MainThread) Intermediate result: 22.996600647742426  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.694 | ed:0.988 | hr@1:0.652 | hr@2:0.861 | hr@3:0.905 | acc@1:0.652 | acc@2:0.593 | acc@3:0.55 | Best krc: 0.79 | Best epoch: 11
[2023-11-29 15:58:54] INFO (nni/MainThread) Intermediate result: 0.7722177141066515  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 22.74	mae: 17.25	mape: 37.55%	acc@10: 37.5%	acc@20: 68.75%	acc@30: 87.74%	
[2023-11-29 15:58:54] INFO (nni/MainThread) Intermediate result: 22.73764275548579  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.787 | lsd:0.652 | ed:0.942 | hr@1:0.677 | hr@2:0.865 | hr@3:0.912 | acc@1:0.677 | acc@2:0.613 | acc@3:0.574 | Best krc: 0.79 | Best epoch: 11
[2023-11-29 16:00:39] INFO (nni/MainThread) Intermediate result: 0.7874781585319408  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 22.4	mae: 17.01	mape: 37.14%	acc@10: 38.39%	acc@20: 69.42%	acc@30: 88.17%	
[2023-11-29 16:00:39] INFO (nni/MainThread) Intermediate result: 22.39932755765941  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.793 | lsd:0.659 | ed:0.937 | hr@1:0.711 | hr@2:0.864 | hr@3:0.911 | acc@1:0.711 | acc@2:0.635 | acc@3:0.588 | Best krc: 0.79 | Best epoch: 11
best model saved
[2023-11-29 16:02:25] INFO (nni/MainThread) Intermediate result: 0.7934572988267786  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 22.15	mae: 16.81	mape: 36.73%	acc@10: 39.17%	acc@20: 70.0%	acc@30: 88.12%	
[2023-11-29 16:02:25] INFO (nni/MainThread) Intermediate result: 22.146432587183604  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.801 | lsd:0.632 | ed:0.907 | hr@1:0.709 | hr@2:0.866 | hr@3:0.918 | acc@1:0.709 | acc@2:0.634 | acc@3:0.596 | Best krc: 0.793 | Best epoch: 14
best model saved
[2023-11-29 16:04:10] INFO (nni/MainThread) Intermediate result: 0.8014552866848451  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 21.98	mae: 16.71	mape: 36.47%	acc@10: 39.45%	acc@20: 70.12%	acc@30: 88.09%	
[2023-11-29 16:04:10] INFO (nni/MainThread) Intermediate result: 21.979489808265633  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.804 | lsd:0.632 | ed:0.915 | hr@1:0.715 | hr@2:0.868 | hr@3:0.916 | acc@1:0.715 | acc@2:0.639 | acc@3:0.598 | Best krc: 0.801 | Best epoch: 15
best model saved
[2023-11-29 16:05:57] INFO (nni/MainThread) Intermediate result: 0.803755824735274  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 21.67	mae: 16.49	mape: 36.09%	acc@10: 40.44%	acc@20: 70.59%	acc@30: 88.42%	
[2023-11-29 16:05:57] INFO (nni/MainThread) Intermediate result: 21.67051458280698  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.796 | lsd:0.638 | ed:0.932 | hr@1:0.704 | hr@2:0.869 | hr@3:0.911 | acc@1:0.704 | acc@2:0.633 | acc@3:0.59 | Best krc: 0.804 | Best epoch: 16
[2023-11-29 16:07:43] INFO (nni/MainThread) Intermediate result: 0.7957751044239894  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 21.38	mae: 16.25	mape: 35.58%	acc@10: 41.15%	acc@20: 71.01%	acc@30: 88.72%	
[2023-11-29 16:07:43] INFO (nni/MainThread) Intermediate result: 21.380331553189972  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.798 | lsd:0.654 | ed:0.921 | hr@1:0.705 | hr@2:0.865 | hr@3:0.911 | acc@1:0.705 | acc@2:0.634 | acc@3:0.589 | Best krc: 0.804 | Best epoch: 16
[2023-11-29 16:09:27] INFO (nni/MainThread) Intermediate result: 0.7977563837642543  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 21.23	mae: 16.15	mape: 35.43%	acc@10: 41.28%	acc@20: 71.05%	acc@30: 88.49%	
[2023-11-29 16:09:27] INFO (nni/MainThread) Intermediate result: 21.230004345911087  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.634 | ed:0.892 | hr@1:0.699 | hr@2:0.869 | hr@3:0.916 | acc@1:0.699 | acc@2:0.633 | acc@3:0.595 | Best krc: 0.804 | Best epoch: 16
[2023-11-29 16:11:12] INFO (nni/MainThread) Intermediate result: 0.7995458527771602  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 20.99	mae: 15.98	mape: 35.12%	acc@10: 41.56%	acc@20: 71.41%	acc@30: 88.75%	
[2023-11-29 16:11:12] INFO (nni/MainThread) Intermediate result: 20.992031497110446  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.657 | ed:0.924 | hr@1:0.723 | hr@2:0.865 | hr@3:0.913 | acc@1:0.723 | acc@2:0.639 | acc@3:0.596 | Best krc: 0.804 | Best epoch: 16
[2023-11-29 16:12:58] INFO (nni/MainThread) Intermediate result: 0.7998788602286634  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 20.97	mae: 15.99	mape: 35.09%	acc@10: 41.07%	acc@20: 71.43%	acc@30: 88.54%	
[2023-11-29 16:12:58] INFO (nni/MainThread) Intermediate result: 20.96629588436102  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.804 | lsd:0.633 | ed:0.903 | hr@1:0.708 | hr@2:0.867 | hr@3:0.914 | acc@1:0.708 | acc@2:0.631 | acc@3:0.596 | Best krc: 0.804 | Best epoch: 16
[2023-11-29 16:14:42] INFO (nni/MainThread) Intermediate result: 0.8035853912723174  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 20.86	mae: 15.94	mape: 34.99%	acc@10: 41.05%	acc@20: 71.45%	acc@30: 88.78%	
[2023-11-29 16:14:42] INFO (nni/MainThread) Intermediate result: 20.864560189397704  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.807 | lsd:0.614 | ed:0.909 | hr@1:0.704 | hr@2:0.871 | hr@3:0.917 | acc@1:0.704 | acc@2:0.636 | acc@3:0.602 | Best krc: 0.804 | Best epoch: 16
best model saved
[2023-11-29 16:16:28] INFO (nni/MainThread) Intermediate result: 0.8067072589591172  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 20.68	mae: 15.82	mape: 34.79%	acc@10: 40.9%	acc@20: 71.74%	acc@30: 88.99%	
[2023-11-29 16:16:28] INFO (nni/MainThread) Intermediate result: 20.681659403143254  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.592 | ed:0.882 | hr@1:0.725 | hr@2:0.875 | hr@3:0.92 | acc@1:0.725 | acc@2:0.653 | acc@3:0.616 | Best krc: 0.807 | Best epoch: 22
best model saved
[2023-11-29 16:18:15] INFO (nni/MainThread) Intermediate result: 0.8114112537287002  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 20.78	mae: 15.95	mape: 35.01%	acc@10: 40.36%	acc@20: 71.22%	acc@30: 88.67%	
[2023-11-29 16:18:15] INFO (nni/MainThread) Intermediate result: 20.784425509214305  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.61 | ed:0.888 | hr@1:0.714 | hr@2:0.874 | hr@3:0.917 | acc@1:0.714 | acc@2:0.646 | acc@3:0.607 | Best krc: 0.811 | Best epoch: 23
[2023-11-29 16:20:01] INFO (nni/MainThread) Intermediate result: 0.8106233632600053  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 20.85	mae: 16.03	mape: 35.13%	acc@10: 40.0%	acc@20: 71.0%	acc@30: 88.5%	
[2023-11-29 16:20:01] INFO (nni/MainThread) Intermediate result: 20.853471485145597  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.815 | lsd:0.588 | ed:0.863 | hr@1:0.724 | hr@2:0.875 | hr@3:0.922 | acc@1:0.724 | acc@2:0.655 | acc@3:0.619 | Best krc: 0.811 | Best epoch: 23
best model saved
[2023-11-29 16:21:49] INFO (nni/MainThread) Intermediate result: 0.8150309558617385  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 20.77	mae: 15.97	mape: 35.0%	acc@10: 39.9%	acc@20: 71.39%	acc@30: 88.7%	
[2023-11-29 16:21:49] INFO (nni/MainThread) Intermediate result: 20.76783868020626  (Index 51)
*** Epoch: 26 ***
-----------------G2R RESULT-------------------

val result: krc:0.802 | lsd:0.607 | ed:0.915 | hr@1:0.718 | hr@2:0.865 | hr@3:0.913 | acc@1:0.718 | acc@2:0.634 | acc@3:0.594 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:23:45] INFO (nni/MainThread) Intermediate result: 0.8022434793663477  (Index 52)
-----------------ETPA RESULT-------------------
Epoch 26: Validation	rmse: 20.8	mae: 16.0	mape: 35.06%	acc@10: 39.7%	acc@20: 71.06%	acc@30: 88.89%	
[2023-11-29 16:23:45] INFO (nni/MainThread) Intermediate result: 20.795604283148318  (Index 53)
*** Epoch: 27 ***
-----------------G2R RESULT-------------------

val result: krc:0.806 | lsd:0.621 | ed:0.91 | hr@1:0.71 | hr@2:0.868 | hr@3:0.915 | acc@1:0.71 | acc@2:0.632 | acc@3:0.595 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:25:34] INFO (nni/MainThread) Intermediate result: 0.8060412589402532  (Index 54)
-----------------ETPA RESULT-------------------
Epoch 27: Validation	rmse: 20.83	mae: 16.02	mape: 35.07%	acc@10: 39.51%	acc@20: 70.98%	acc@30: 89.06%	
[2023-11-29 16:25:34] INFO (nni/MainThread) Intermediate result: 20.83303169699733  (Index 55)
*** Epoch: 28 ***
-----------------G2R RESULT-------------------

val result: krc:0.806 | lsd:0.62 | ed:0.908 | hr@1:0.711 | hr@2:0.87 | hr@3:0.912 | acc@1:0.711 | acc@2:0.636 | acc@3:0.597 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:27:23] INFO (nni/MainThread) Intermediate result: 0.8059031573941937  (Index 56)
-----------------ETPA RESULT-------------------
Epoch 28: Validation	rmse: 20.94	mae: 16.1	mape: 35.19%	acc@10: 39.22%	acc@20: 70.69%	acc@30: 88.79%	
[2023-11-29 16:27:23] INFO (nni/MainThread) Intermediate result: 20.940740697940928  (Index 57)
*** Epoch: 29 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.607 | ed:0.913 | hr@1:0.707 | hr@2:0.87 | hr@3:0.915 | acc@1:0.707 | acc@2:0.634 | acc@3:0.594 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:29:13] INFO (nni/MainThread) Intermediate result: 0.8029706318556341  (Index 58)
-----------------ETPA RESULT-------------------
Epoch 29: Validation	rmse: 20.9	mae: 16.07	mape: 35.14%	acc@10: 39.17%	acc@20: 70.73%	acc@30: 88.96%	
[2023-11-29 16:29:13] INFO (nni/MainThread) Intermediate result: 20.897348812009575  (Index 59)
*** Epoch: 30 ***
-----------------G2R RESULT-------------------

val result: krc:0.804 | lsd:0.602 | ed:0.902 | hr@1:0.718 | hr@2:0.87 | hr@3:0.922 | acc@1:0.718 | acc@2:0.641 | acc@3:0.605 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:31:02] INFO (nni/MainThread) Intermediate result: 0.8044048251219218  (Index 60)
-----------------ETPA RESULT-------------------
Epoch 30: Validation	rmse: 20.92	mae: 16.09	mape: 35.18%	acc@10: 39.21%	acc@20: 70.67%	acc@30: 89.11%	
[2023-11-29 16:31:02] INFO (nni/MainThread) Intermediate result: 20.924129402485327  (Index 61)
*** Epoch: 31 ***
-----------------G2R RESULT-------------------

val result: krc:0.796 | lsd:0.623 | ed:0.93 | hr@1:0.685 | hr@2:0.868 | hr@3:0.912 | acc@1:0.685 | acc@2:0.619 | acc@3:0.58 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:32:50] INFO (nni/MainThread) Intermediate result: 0.7956757747750315  (Index 62)
-----------------ETPA RESULT-------------------
Epoch 31: Validation	rmse: 20.98	mae: 16.14	mape: 35.22%	acc@10: 39.06%	acc@20: 70.41%	acc@30: 89.26%	
[2023-11-29 16:32:50] INFO (nni/MainThread) Intermediate result: 20.980561721061328  (Index 63)
*** Epoch: 32 ***
-----------------G2R RESULT-------------------

val result: krc:0.802 | lsd:0.619 | ed:0.914 | hr@1:0.697 | hr@2:0.873 | hr@3:0.915 | acc@1:0.697 | acc@2:0.637 | acc@3:0.594 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:34:40] INFO (nni/MainThread) Intermediate result: 0.8015666210419162  (Index 64)
-----------------ETPA RESULT-------------------
Epoch 32: Validation	rmse: 21.01	mae: 16.15	mape: 35.21%	acc@10: 39.11%	acc@20: 70.27%	acc@30: 89.3%	
[2023-11-29 16:34:40] INFO (nni/MainThread) Intermediate result: 21.005944990877506  (Index 65)
*** Epoch: 33 ***
-----------------G2R RESULT-------------------

val result: krc:0.798 | lsd:0.622 | ed:0.929 | hr@1:0.705 | hr@2:0.869 | hr@3:0.917 | acc@1:0.705 | acc@2:0.627 | acc@3:0.588 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:36:28] INFO (nni/MainThread) Intermediate result: 0.7984008202197969  (Index 66)
-----------------ETPA RESULT-------------------
Epoch 33: Validation	rmse: 21.06	mae: 16.18	mape: 35.25%	acc@10: 38.97%	acc@20: 70.22%	acc@30: 89.34%	
[2023-11-29 16:36:28] INFO (nni/MainThread) Intermediate result: 21.06025389995505  (Index 67)
*** Epoch: 34 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.598 | ed:0.898 | hr@1:0.711 | hr@2:0.876 | hr@3:0.921 | acc@1:0.711 | acc@2:0.641 | acc@3:0.605 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:38:16] INFO (nni/MainThread) Intermediate result: 0.8079795182549885  (Index 68)
-----------------ETPA RESULT-------------------
Epoch 34: Validation	rmse: 21.09	mae: 16.2	mape: 35.26%	acc@10: 38.84%	acc@20: 70.09%	acc@30: 89.46%	
[2023-11-29 16:38:16] INFO (nni/MainThread) Intermediate result: 21.090405126863306  (Index 69)
*** Epoch: 35 ***
-----------------G2R RESULT-------------------

val result: krc:0.794 | lsd:0.637 | ed:0.954 | hr@1:0.697 | hr@2:0.873 | hr@3:0.912 | acc@1:0.697 | acc@2:0.627 | acc@3:0.584 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:40:06] INFO (nni/MainThread) Intermediate result: 0.7943427661748605  (Index 70)
-----------------ETPA RESULT-------------------
Epoch 35: Validation	rmse: 21.17	mae: 16.25	mape: 35.35%	acc@10: 38.63%	acc@20: 69.97%	acc@30: 89.41%	
[2023-11-29 16:40:06] INFO (nni/MainThread) Intermediate result: 21.1657076970646  (Index 71)
*** Epoch: 36 ***
-----------------G2R RESULT-------------------

val result: krc:0.798 | lsd:0.637 | ed:0.937 | hr@1:0.696 | hr@2:0.868 | hr@3:0.914 | acc@1:0.696 | acc@2:0.623 | acc@3:0.585 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:41:56] INFO (nni/MainThread) Intermediate result: 0.7975115930078763  (Index 72)
-----------------ETPA RESULT-------------------
Epoch 36: Validation	rmse: 21.13	mae: 16.24	mape: 35.31%	acc@10: 38.51%	acc@20: 70.27%	acc@30: 89.53%	
[2023-11-29 16:41:56] INFO (nni/MainThread) Intermediate result: 21.13191678547146  (Index 73)
*** Epoch: 37 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.695 | ed:0.976 | hr@1:0.693 | hr@2:0.866 | hr@3:0.911 | acc@1:0.693 | acc@2:0.62 | acc@3:0.577 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:43:42] INFO (nni/MainThread) Intermediate result: 0.7784233739021671  (Index 74)
-----------------ETPA RESULT-------------------
Epoch 37: Validation	rmse: 21.11	mae: 16.22	mape: 35.31%	acc@10: 38.32%	acc@20: 70.39%	acc@30: 89.64%	
[2023-11-29 16:43:42] INFO (nni/MainThread) Intermediate result: 21.11150332360615  (Index 75)
*** Epoch: 38 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.616 | ed:0.916 | hr@1:0.714 | hr@2:0.874 | hr@3:0.92 | acc@1:0.714 | acc@2:0.639 | acc@3:0.599 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:45:27] INFO (nni/MainThread) Intermediate result: 0.8032968404896695  (Index 76)
-----------------ETPA RESULT-------------------
Epoch 38: Validation	rmse: 21.1	mae: 16.21	mape: 35.26%	acc@10: 38.14%	acc@20: 70.51%	acc@30: 89.74%	
[2023-11-29 16:45:27] INFO (nni/MainThread) Intermediate result: 21.100159122113837  (Index 77)
*** Epoch: 39 ***
-----------------G2R RESULT-------------------

val result: krc:0.809 | lsd:0.604 | ed:0.874 | hr@1:0.727 | hr@2:0.876 | hr@3:0.918 | acc@1:0.727 | acc@2:0.658 | acc@3:0.613 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:47:13] INFO (nni/MainThread) Intermediate result: 0.8093453324760714  (Index 78)
-----------------ETPA RESULT-------------------
Epoch 39: Validation	rmse: 21.08	mae: 16.19	mape: 35.23%	acc@10: 38.12%	acc@20: 70.55%	acc@30: 89.84%	
[2023-11-29 16:47:13] INFO (nni/MainThread) Intermediate result: 21.08028257052203  (Index 79)
*** Epoch: 40 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.596 | ed:0.878 | hr@1:0.701 | hr@2:0.878 | hr@3:0.919 | acc@1:0.701 | acc@2:0.64 | acc@3:0.604 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:48:59] INFO (nni/MainThread) Intermediate result: 0.8080778263987708  (Index 80)
-----------------ETPA RESULT-------------------
Epoch 40: Validation	rmse: 21.08	mae: 16.17	mape: 35.15%	acc@10: 38.19%	acc@20: 70.58%	acc@30: 89.94%	
[2023-11-29 16:48:59] INFO (nni/MainThread) Intermediate result: 21.075025628851783  (Index 81)
*** Epoch: 41 ***
-----------------G2R RESULT-------------------

val result: krc:0.812 | lsd:0.579 | ed:0.877 | hr@1:0.709 | hr@2:0.878 | hr@3:0.92 | acc@1:0.709 | acc@2:0.647 | acc@3:0.603 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:50:46] INFO (nni/MainThread) Intermediate result: 0.8119509236168615  (Index 82)
-----------------ETPA RESULT-------------------
Epoch 41: Validation	rmse: 21.06	mae: 16.15	mape: 35.14%	acc@10: 38.39%	acc@20: 70.76%	acc@30: 90.03%	
[2023-11-29 16:50:46] INFO (nni/MainThread) Intermediate result: 21.059796724173403  (Index 83)
*** Epoch: 42 ***
-----------------G2R RESULT-------------------

val result: krc:0.81 | lsd:0.581 | ed:0.887 | hr@1:0.708 | hr@2:0.877 | hr@3:0.921 | acc@1:0.708 | acc@2:0.642 | acc@3:0.603 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:52:31] INFO (nni/MainThread) Intermediate result: 0.8101961634537059  (Index 84)
-----------------ETPA RESULT-------------------
Epoch 42: Validation	rmse: 21.05	mae: 16.13	mape: 35.11%	acc@10: 38.37%	acc@20: 70.86%	acc@30: 90.12%	
[2023-11-29 16:52:31] INFO (nni/MainThread) Intermediate result: 21.04841261108446  (Index 85)
*** Epoch: 43 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.613 | ed:0.898 | hr@1:0.695 | hr@2:0.877 | hr@3:0.919 | acc@1:0.695 | acc@2:0.636 | acc@3:0.598 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:54:17] INFO (nni/MainThread) Intermediate result: 0.8075996393442829  (Index 86)
-----------------ETPA RESULT-------------------
Epoch 43: Validation	rmse: 21.04	mae: 16.12	mape: 35.11%	acc@10: 38.28%	acc@20: 71.09%	acc@30: 90.2%	
[2023-11-29 16:54:17] INFO (nni/MainThread) Intermediate result: 21.040757289533175  (Index 87)
*** Epoch: 44 ***
-----------------G2R RESULT-------------------

val result: krc:0.813 | lsd:0.569 | ed:0.873 | hr@1:0.722 | hr@2:0.879 | hr@3:0.922 | acc@1:0.722 | acc@2:0.652 | acc@3:0.611 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:56:02] INFO (nni/MainThread) Intermediate result: 0.8130618938139706  (Index 88)
-----------------ETPA RESULT-------------------
Epoch 44: Validation	rmse: 21.05	mae: 16.12	mape: 35.08%	acc@10: 38.33%	acc@20: 71.11%	acc@30: 90.28%	
[2023-11-29 16:56:02] INFO (nni/MainThread) Intermediate result: 21.045372037008764  (Index 89)
*** Epoch: 45 ***
-----------------G2R RESULT-------------------

val result: krc:0.813 | lsd:0.605 | ed:0.886 | hr@1:0.725 | hr@2:0.874 | hr@3:0.92 | acc@1:0.725 | acc@2:0.651 | acc@3:0.612 | Best krc: 0.815 | Best epoch: 25
[2023-11-29 16:57:47] INFO (nni/MainThread) Intermediate result: 0.8132989797615946  (Index 90)
-----------------ETPA RESULT-------------------
Epoch 45: Validation	rmse: 21.06	mae: 16.13	mape: 35.1%	acc@10: 38.25%	acc@20: 71.13%	acc@30: 90.35%	
[2023-11-29 16:57:47] INFO (nni/MainThread) Intermediate result: 21.058493494440846  (Index 91)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701268554.92579941701268554.9258127
best model loaded !!!
krc:0.795 | lsd:0.478 | ed:0.922 | hr@1:0.707 | hr@2:0.9 | hr@3:0.94 | acc@1:0.707 | acc@2:0.647 | acc@3:0.602 |

-------------------------------------------------------------
Best epoch for G2R:  25
Best epoch for ETPA:  22
graph2route_pd Evaluation in test: krc:0.795 | lsd:0.478 | ed:0.922 | hr@1:0.707 | hr@2:0.9 | hr@3:0.94 | acc@1:0.707 | acc@2:0.647 | acc@3:0.602 |
RankPETA Evaluation in test: rmse: 10.38	mae: 8.85	mape: 75.41%	acc@10: 60.0%	acc@20: 100.0%	acc@30: 100.0%	
