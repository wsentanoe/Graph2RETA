Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 100,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 8888,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.74 | lsd:0.78 | ed:1.07 | hr@1:0.615 | hr@2:0.849 | hr@3:0.899 | acc@1:0.615 | acc@2:0.557 | acc@3:0.516 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-05 18:00:23] INFO (nni/MainThread) Intermediate result: 0.7403146553037238  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.3	mae: 19.28	mape: 70.26%	acc@10: 30.37%	acc@20: 63.7%	acc@30: 81.48%	
[2023-12-05 18:00:23] INFO (nni/MainThread) Intermediate result: 24.299900585332264  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.748 | lsd:0.75 | ed:1.043 | hr@1:0.621 | hr@2:0.849 | hr@3:0.897 | acc@1:0.621 | acc@2:0.569 | acc@3:0.525 | Best krc: 0.74 | Best epoch: 0
best model saved
[2023-12-05 18:02:00] INFO (nni/MainThread) Intermediate result: 0.7482809098462794  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 26.8	mae: 20.0	mape: 106.61%	acc@10: 32.22%	acc@20: 64.26%	acc@30: 81.3%	
[2023-12-05 18:02:00] INFO (nni/MainThread) Intermediate result: 26.799240892824578  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.754 | lsd:0.714 | ed:1.044 | hr@1:0.623 | hr@2:0.854 | hr@3:0.901 | acc@1:0.623 | acc@2:0.561 | acc@3:0.519 | Best krc: 0.748 | Best epoch: 1
best model saved
[2023-12-05 18:03:41] INFO (nni/MainThread) Intermediate result: 0.7541733386858003  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 24.73	mae: 18.68	mape: 108.56%	acc@10: 34.69%	acc@20: 66.05%	acc@30: 82.96%	
[2023-12-05 18:03:41] INFO (nni/MainThread) Intermediate result: 24.729364154545525  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.681 | ed:0.99 | hr@1:0.635 | hr@2:0.86 | hr@3:0.907 | acc@1:0.635 | acc@2:0.581 | acc@3:0.544 | Best krc: 0.754 | Best epoch: 2
best model saved
[2023-12-05 18:05:20] INFO (nni/MainThread) Intermediate result: 0.7686083910745038  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 23.56	mae: 18.11	mape: 111.64%	acc@10: 34.17%	acc@20: 66.3%	acc@30: 83.98%	
[2023-12-05 18:05:20] INFO (nni/MainThread) Intermediate result: 23.555986677130328  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.757 | lsd:0.711 | ed:1.032 | hr@1:0.624 | hr@2:0.856 | hr@3:0.908 | acc@1:0.624 | acc@2:0.563 | acc@3:0.53 | Best krc: 0.769 | Best epoch: 3
[2023-12-05 18:06:57] INFO (nni/MainThread) Intermediate result: 0.7574936737945046  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 23.45	mae: 18.17	mape: 118.0%	acc@10: 34.07%	acc@20: 65.19%	acc@30: 83.78%	
[2023-12-05 18:06:57] INFO (nni/MainThread) Intermediate result: 23.44591172091105  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.757 | lsd:0.721 | ed:1.023 | hr@1:0.623 | hr@2:0.855 | hr@3:0.906 | acc@1:0.623 | acc@2:0.565 | acc@3:0.529 | Best krc: 0.769 | Best epoch: 3
[2023-12-05 18:08:37] INFO (nni/MainThread) Intermediate result: 0.756621561728689  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 23.0	mae: 18.0	mape: 120.55%	acc@10: 33.83%	acc@20: 64.63%	acc@30: 84.07%	
[2023-12-05 18:08:37] INFO (nni/MainThread) Intermediate result: 23.004805080579715  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.755 | lsd:0.744 | ed:1.019 | hr@1:0.63 | hr@2:0.85 | hr@3:0.901 | acc@1:0.63 | acc@2:0.568 | acc@3:0.531 | Best krc: 0.769 | Best epoch: 3
[2023-12-05 18:10:16] INFO (nni/MainThread) Intermediate result: 0.7549631162049177  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 22.73	mae: 17.9	mape: 122.97%	acc@10: 33.81%	acc@20: 64.6%	acc@30: 84.29%	
[2023-12-05 18:10:16] INFO (nni/MainThread) Intermediate result: 22.726893151166994  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.715 | ed:1.001 | hr@1:0.631 | hr@2:0.857 | hr@3:0.908 | acc@1:0.631 | acc@2:0.577 | acc@3:0.539 | Best krc: 0.769 | Best epoch: 3
[2023-12-05 18:11:55] INFO (nni/MainThread) Intermediate result: 0.7616191310026027  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 22.39	mae: 17.68	mape: 123.37%	acc@10: 34.03%	acc@20: 64.91%	acc@30: 84.49%	
[2023-12-05 18:11:55] INFO (nni/MainThread) Intermediate result: 22.39329615214822  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.704 | ed:0.998 | hr@1:0.638 | hr@2:0.86 | hr@3:0.907 | acc@1:0.638 | acc@2:0.58 | acc@3:0.543 | Best krc: 0.769 | Best epoch: 3
[2023-12-05 18:13:32] INFO (nni/MainThread) Intermediate result: 0.7655592476318319  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 21.83	mae: 17.31	mape: 122.07%	acc@10: 34.69%	acc@20: 65.51%	acc@30: 85.51%	
[2023-12-05 18:13:32] INFO (nni/MainThread) Intermediate result: 21.826921565966536  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.683 | ed:1.009 | hr@1:0.631 | hr@2:0.862 | hr@3:0.909 | acc@1:0.631 | acc@2:0.577 | acc@3:0.537 | Best krc: 0.769 | Best epoch: 3
[2023-12-05 18:15:09] INFO (nni/MainThread) Intermediate result: 0.7638522781854659  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 21.54	mae: 17.18	mape: 122.23%	acc@10: 34.3%	acc@20: 65.59%	acc@30: 85.89%	
[2023-12-05 18:15:09] INFO (nni/MainThread) Intermediate result: 21.544388977479187  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.719 | ed:1.018 | hr@1:0.627 | hr@2:0.86 | hr@3:0.905 | acc@1:0.627 | acc@2:0.568 | acc@3:0.53 | Best krc: 0.769 | Best epoch: 3
[2023-12-05 18:16:46] INFO (nni/MainThread) Intermediate result: 0.7603217501862013  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 21.13	mae: 16.92	mape: 121.14%	acc@10: 34.58%	acc@20: 66.09%	acc@30: 86.7%	
[2023-12-05 18:16:46] INFO (nni/MainThread) Intermediate result: 21.131034216061508  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.694 | ed:0.986 | hr@1:0.635 | hr@2:0.863 | hr@3:0.908 | acc@1:0.635 | acc@2:0.584 | acc@3:0.544 | Best krc: 0.769 | Best epoch: 3
[2023-12-05 18:18:24] INFO (nni/MainThread) Intermediate result: 0.7651227911831322  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 20.88	mae: 16.79	mape: 121.0%	acc@10: 34.54%	acc@20: 66.17%	acc@30: 87.19%	
[2023-12-05 18:18:24] INFO (nni/MainThread) Intermediate result: 20.88042970619692  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.701 | ed:0.975 | hr@1:0.656 | hr@2:0.861 | hr@3:0.91 | acc@1:0.656 | acc@2:0.6 | acc@3:0.562 | Best krc: 0.769 | Best epoch: 3
best model saved
[2023-12-05 18:20:03] INFO (nni/MainThread) Intermediate result: 0.7744329530774655  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 20.59	mae: 16.62	mape: 120.09%	acc@10: 34.67%	acc@20: 66.52%	acc@30: 87.86%	
[2023-12-05 18:20:03] INFO (nni/MainThread) Intermediate result: 20.592961878185438  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.642 | ed:0.921 | hr@1:0.692 | hr@2:0.866 | hr@3:0.914 | acc@1:0.692 | acc@2:0.625 | acc@3:0.589 | Best krc: 0.774 | Best epoch: 12
best model saved
[2023-12-05 18:21:40] INFO (nni/MainThread) Intermediate result: 0.7988183113587574  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 20.4	mae: 16.51	mape: 119.88%	acc@10: 34.79%	acc@20: 66.67%	acc@30: 88.28%	
[2023-12-05 18:21:40] INFO (nni/MainThread) Intermediate result: 20.39505095910364  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.622 | ed:0.911 | hr@1:0.695 | hr@2:0.871 | hr@3:0.914 | acc@1:0.695 | acc@2:0.628 | acc@3:0.59 | Best krc: 0.799 | Best epoch: 13
best model saved
[2023-12-05 18:23:21] INFO (nni/MainThread) Intermediate result: 0.7999846165915251  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 20.13	mae: 16.3	mape: 118.84%	acc@10: 35.31%	acc@20: 67.16%	acc@30: 88.69%	
[2023-12-05 18:23:21] INFO (nni/MainThread) Intermediate result: 20.125667761223802  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.796 | lsd:0.644 | ed:0.927 | hr@1:0.694 | hr@2:0.869 | hr@3:0.911 | acc@1:0.694 | acc@2:0.626 | acc@3:0.582 | Best krc: 0.8 | Best epoch: 14
[2023-12-05 18:24:59] INFO (nni/MainThread) Intermediate result: 0.7964845554613812  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 19.91	mae: 16.15	mape: 118.12%	acc@10: 35.56%	acc@20: 67.59%	acc@30: 89.12%	
[2023-12-05 18:24:59] INFO (nni/MainThread) Intermediate result: 19.905415720530772  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.795 | lsd:0.629 | ed:0.945 | hr@1:0.678 | hr@2:0.866 | hr@3:0.914 | acc@1:0.678 | acc@2:0.617 | acc@3:0.576 | Best krc: 0.8 | Best epoch: 14
[2023-12-05 18:26:37] INFO (nni/MainThread) Intermediate result: 0.7953241754116261  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 19.73	mae: 16.03	mape: 117.71%	acc@10: 35.73%	acc@20: 67.82%	acc@30: 89.52%	
[2023-12-05 18:26:37] INFO (nni/MainThread) Intermediate result: 19.730195152297316  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.65 | ed:0.973 | hr@1:0.659 | hr@2:0.866 | hr@3:0.911 | acc@1:0.659 | acc@2:0.599 | acc@3:0.558 | Best krc: 0.8 | Best epoch: 14
[2023-12-05 18:28:14] INFO (nni/MainThread) Intermediate result: 0.7803579293303823  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 19.54	mae: 15.89	mape: 116.88%	acc@10: 36.15%	acc@20: 68.17%	acc@30: 89.9%	
[2023-12-05 18:28:14] INFO (nni/MainThread) Intermediate result: 19.537919503387172  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.794 | lsd:0.625 | ed:0.932 | hr@1:0.685 | hr@2:0.864 | hr@3:0.915 | acc@1:0.685 | acc@2:0.613 | acc@3:0.578 | Best krc: 0.8 | Best epoch: 14
[2023-12-05 18:29:53] INFO (nni/MainThread) Intermediate result: 0.7938171546829177  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 19.35	mae: 15.76	mape: 116.06%	acc@10: 36.41%	acc@20: 68.52%	acc@30: 90.23%	
[2023-12-05 18:29:53] INFO (nni/MainThread) Intermediate result: 19.351298865790696  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.79 | lsd:0.629 | ed:0.95 | hr@1:0.688 | hr@2:0.864 | hr@3:0.914 | acc@1:0.688 | acc@2:0.608 | acc@3:0.568 | Best krc: 0.8 | Best epoch: 14
[2023-12-05 18:31:30] INFO (nni/MainThread) Intermediate result: 0.7895664755656011  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 19.13	mae: 15.58	mape: 114.87%	acc@10: 36.96%	acc@20: 69.06%	acc@30: 90.56%	
[2023-12-05 18:31:30] INFO (nni/MainThread) Intermediate result: 19.13170664646961  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.603 | ed:0.896 | hr@1:0.701 | hr@2:0.873 | hr@3:0.917 | acc@1:0.701 | acc@2:0.631 | acc@3:0.593 | Best krc: 0.8 | Best epoch: 14
best model saved
[2023-12-05 18:33:09] INFO (nni/MainThread) Intermediate result: 0.8032030600373408  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 19.01	mae: 15.5	mape: 114.47%	acc@10: 37.09%	acc@20: 69.29%	acc@30: 90.78%	
[2023-12-05 18:33:09] INFO (nni/MainThread) Intermediate result: 19.007899200115368  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.791 | lsd:0.643 | ed:0.925 | hr@1:0.687 | hr@2:0.866 | hr@3:0.914 | acc@1:0.687 | acc@2:0.615 | acc@3:0.578 | Best krc: 0.803 | Best epoch: 20
[2023-12-05 18:34:47] INFO (nni/MainThread) Intermediate result: 0.7913572589130089  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 18.82	mae: 15.34	mape: 113.33%	acc@10: 37.64%	acc@20: 69.76%	acc@30: 91.01%	
[2023-12-05 18:34:47] INFO (nni/MainThread) Intermediate result: 18.816883989955222  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.659 | ed:0.952 | hr@1:0.664 | hr@2:0.865 | hr@3:0.915 | acc@1:0.664 | acc@2:0.601 | acc@3:0.565 | Best krc: 0.803 | Best epoch: 20
[2023-12-05 18:36:24] INFO (nni/MainThread) Intermediate result: 0.7820983350323095  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 18.64	mae: 15.21	mape: 112.29%	acc@10: 38.04%	acc@20: 70.29%	acc@30: 91.29%	
[2023-12-05 18:36:24] INFO (nni/MainThread) Intermediate result: 18.63858716212765  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.796 | lsd:0.629 | ed:0.925 | hr@1:0.69 | hr@2:0.87 | hr@3:0.918 | acc@1:0.69 | acc@2:0.615 | acc@3:0.577 | Best krc: 0.803 | Best epoch: 20
[2023-12-05 18:38:02] INFO (nni/MainThread) Intermediate result: 0.7959522635779741  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 18.56	mae: 15.15	mape: 112.16%	acc@10: 38.09%	acc@20: 70.37%	acc@30: 91.44%	
[2023-12-05 18:38:02] INFO (nni/MainThread) Intermediate result: 18.561057010131208  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.798 | lsd:0.635 | ed:0.913 | hr@1:0.693 | hr@2:0.866 | hr@3:0.916 | acc@1:0.693 | acc@2:0.622 | acc@3:0.585 | Best krc: 0.803 | Best epoch: 20
[2023-12-05 18:39:42] INFO (nni/MainThread) Intermediate result: 0.7984535113787408  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 18.39	mae: 15.02	mape: 111.19%	acc@10: 38.46%	acc@20: 70.89%	acc@30: 91.69%	
[2023-12-05 18:39:42] INFO (nni/MainThread) Intermediate result: 18.389415654995936  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.624 | ed:0.919 | hr@1:0.704 | hr@2:0.867 | hr@3:0.92 | acc@1:0.704 | acc@2:0.626 | acc@3:0.587 | Best krc: 0.803 | Best epoch: 20
[2023-12-05 18:41:18] INFO (nni/MainThread) Intermediate result: 0.7999492441031575  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 18.25	mae: 14.91	mape: 110.37%	acc@10: 38.8%	acc@20: 71.24%	acc@30: 91.91%	
[2023-12-05 18:41:18] INFO (nni/MainThread) Intermediate result: 18.24857448544043  (Index 51)
*** Epoch: 26 ***
-----------------G2R RESULT-------------------

val result: krc:0.792 | lsd:0.636 | ed:0.933 | hr@1:0.685 | hr@2:0.866 | hr@3:0.917 | acc@1:0.685 | acc@2:0.611 | acc@3:0.578 | Best krc: 0.803 | Best epoch: 20
[2023-12-05 18:42:55] INFO (nni/MainThread) Intermediate result: 0.7917707481590298  (Index 52)
-----------------ETPA RESULT-------------------
Epoch 26: Validation	rmse: 18.16	mae: 14.84	mape: 110.04%	acc@10: 38.96%	acc@20: 71.44%	acc@30: 92.1%	
[2023-12-05 18:42:55] INFO (nni/MainThread) Intermediate result: 18.16191995746385  (Index 53)
*** Epoch: 27 ***
-----------------G2R RESULT-------------------

val result: krc:0.801 | lsd:0.62 | ed:0.901 | hr@1:0.704 | hr@2:0.869 | hr@3:0.918 | acc@1:0.704 | acc@2:0.634 | acc@3:0.596 | Best krc: 0.803 | Best epoch: 20
[2023-12-05 18:44:33] INFO (nni/MainThread) Intermediate result: 0.8006655651430464  (Index 54)
-----------------ETPA RESULT-------------------
Epoch 27: Validation	rmse: 18.05	mae: 14.76	mape: 109.5%	acc@10: 39.23%	acc@20: 71.67%	acc@30: 92.26%	
[2023-12-05 18:44:33] INFO (nni/MainThread) Intermediate result: 18.054236618641283  (Index 55)
*** Epoch: 28 ***
-----------------G2R RESULT-------------------

val result: krc:0.809 | lsd:0.604 | ed:0.891 | hr@1:0.707 | hr@2:0.875 | hr@3:0.92 | acc@1:0.707 | acc@2:0.639 | acc@3:0.6 | Best krc: 0.803 | Best epoch: 20
best model saved
[2023-12-05 18:46:11] INFO (nni/MainThread) Intermediate result: 0.8092354515878784  (Index 56)
-----------------ETPA RESULT-------------------
Epoch 28: Validation	rmse: 17.95	mae: 14.68	mape: 108.97%	acc@10: 39.5%	acc@20: 71.92%	acc@30: 92.4%	
[2023-12-05 18:46:11] INFO (nni/MainThread) Intermediate result: 17.952644515322437  (Index 57)
*** Epoch: 29 ***
-----------------G2R RESULT-------------------

val result: krc:0.804 | lsd:0.615 | ed:0.904 | hr@1:0.705 | hr@2:0.872 | hr@3:0.919 | acc@1:0.705 | acc@2:0.634 | acc@3:0.595 | Best krc: 0.809 | Best epoch: 28
[2023-12-05 18:47:49] INFO (nni/MainThread) Intermediate result: 0.804085121828891  (Index 58)
-----------------ETPA RESULT-------------------
Epoch 29: Validation	rmse: 17.85	mae: 14.59	mape: 108.26%	acc@10: 39.91%	acc@20: 72.2%	acc@30: 92.54%	
[2023-12-05 18:47:49] INFO (nni/MainThread) Intermediate result: 17.84617711730753  (Index 59)
*** Epoch: 30 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.64 | ed:0.916 | hr@1:0.705 | hr@2:0.866 | hr@3:0.917 | acc@1:0.705 | acc@2:0.63 | acc@3:0.593 | Best krc: 0.809 | Best epoch: 28
[2023-12-05 18:49:24] INFO (nni/MainThread) Intermediate result: 0.798580022707701  (Index 60)
-----------------ETPA RESULT-------------------
Epoch 30: Validation	rmse: 17.75	mae: 14.51	mape: 107.7%	acc@10: 40.22%	acc@20: 72.45%	acc@30: 92.64%	
[2023-12-05 18:49:24] INFO (nni/MainThread) Intermediate result: 17.75040029299831  (Index 61)
*** Epoch: 31 ***
-----------------G2R RESULT-------------------

val result: krc:0.807 | lsd:0.619 | ed:0.901 | hr@1:0.716 | hr@2:0.87 | hr@3:0.916 | acc@1:0.716 | acc@2:0.641 | acc@3:0.601 | Best krc: 0.809 | Best epoch: 28
[2023-12-05 18:51:01] INFO (nni/MainThread) Intermediate result: 0.8069410095645339  (Index 62)
-----------------ETPA RESULT-------------------
Epoch 31: Validation	rmse: 17.67	mae: 14.45	mape: 107.25%	acc@10: 40.43%	acc@20: 72.66%	acc@30: 92.77%	
[2023-12-05 18:51:01] INFO (nni/MainThread) Intermediate result: 17.669476868944347  (Index 63)
*** Epoch: 32 ***
-----------------G2R RESULT-------------------

val result: krc:0.804 | lsd:0.596 | ed:0.92 | hr@1:0.705 | hr@2:0.874 | hr@3:0.916 | acc@1:0.705 | acc@2:0.634 | acc@3:0.588 | Best krc: 0.809 | Best epoch: 28
[2023-12-05 18:52:39] INFO (nni/MainThread) Intermediate result: 0.8042059318841128  (Index 64)
-----------------ETPA RESULT-------------------
Epoch 32: Validation	rmse: 17.63	mae: 14.42	mape: 107.13%	acc@10: 40.53%	acc@20: 72.72%	acc@30: 92.74%	
[2023-12-05 18:52:39] INFO (nni/MainThread) Intermediate result: 17.632003707174185  (Index 65)
*** Epoch: 33 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.626 | ed:0.934 | hr@1:0.693 | hr@2:0.865 | hr@3:0.917 | acc@1:0.693 | acc@2:0.616 | acc@3:0.583 | Best krc: 0.809 | Best epoch: 28
[2023-12-05 18:54:16] INFO (nni/MainThread) Intermediate result: 0.7990609642992679  (Index 66)
-----------------ETPA RESULT-------------------
Epoch 33: Validation	rmse: 17.56	mae: 14.37	mape: 106.82%	acc@10: 40.69%	acc@20: 72.8%	acc@30: 92.84%	
[2023-12-05 18:54:16] INFO (nni/MainThread) Intermediate result: 17.564695795118666  (Index 67)
*** Epoch: 34 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.654 | ed:0.986 | hr@1:0.676 | hr@2:0.863 | hr@3:0.909 | acc@1:0.676 | acc@2:0.598 | acc@3:0.558 | Best krc: 0.809 | Best epoch: 28
[2023-12-05 18:55:54] INFO (nni/MainThread) Intermediate result: 0.7800282358655775  (Index 68)
-----------------ETPA RESULT-------------------
Epoch 34: Validation	rmse: 17.54	mae: 14.35	mape: 106.81%	acc@10: 40.7%	acc@20: 72.85%	acc@30: 92.9%	
[2023-12-05 18:55:54] INFO (nni/MainThread) Intermediate result: 17.53769582660359  (Index 69)
*** Epoch: 35 ***
-----------------G2R RESULT-------------------

val result: krc:0.81 | lsd:0.594 | ed:0.886 | hr@1:0.725 | hr@2:0.875 | hr@3:0.923 | acc@1:0.725 | acc@2:0.645 | acc@3:0.607 | Best krc: 0.809 | Best epoch: 28
best model saved
[2023-12-05 18:57:33] INFO (nni/MainThread) Intermediate result: 0.8104162335906978  (Index 70)
-----------------ETPA RESULT-------------------
Epoch 35: Validation	rmse: 17.46	mae: 14.29	mape: 106.31%	acc@10: 40.97%	acc@20: 73.02%	acc@30: 92.98%	
[2023-12-05 18:57:33] INFO (nni/MainThread) Intermediate result: 17.46352166814606  (Index 71)
*** Epoch: 36 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.629 | ed:0.915 | hr@1:0.718 | hr@2:0.867 | hr@3:0.92 | acc@1:0.718 | acc@2:0.639 | acc@3:0.599 | Best krc: 0.81 | Best epoch: 35
[2023-12-05 18:59:10] INFO (nni/MainThread) Intermediate result: 0.8034193178924269  (Index 72)
-----------------ETPA RESULT-------------------
Epoch 36: Validation	rmse: 17.39	mae: 14.23	mape: 105.9%	acc@10: 41.11%	acc@20: 73.19%	acc@30: 93.09%	
[2023-12-05 18:59:10] INFO (nni/MainThread) Intermediate result: 17.391457968172922  (Index 73)
*** Epoch: 37 ***
-----------------G2R RESULT-------------------

val result: krc:0.802 | lsd:0.631 | ed:0.927 | hr@1:0.716 | hr@2:0.87 | hr@3:0.919 | acc@1:0.716 | acc@2:0.635 | acc@3:0.596 | Best krc: 0.81 | Best epoch: 35
[2023-12-05 19:00:49] INFO (nni/MainThread) Intermediate result: 0.8015013236613586  (Index 74)
-----------------ETPA RESULT-------------------
Epoch 37: Validation	rmse: 17.34	mae: 14.19	mape: 105.62%	acc@10: 41.27%	acc@20: 73.27%	acc@30: 93.17%	
[2023-12-05 19:00:49] INFO (nni/MainThread) Intermediate result: 17.34332744372182  (Index 75)
*** Epoch: 38 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.663 | ed:0.935 | hr@1:0.718 | hr@2:0.866 | hr@3:0.918 | acc@1:0.718 | acc@2:0.634 | acc@3:0.596 | Best krc: 0.81 | Best epoch: 35
[2023-12-05 19:02:28] INFO (nni/MainThread) Intermediate result: 0.8004353310780944  (Index 76)
-----------------ETPA RESULT-------------------
Epoch 38: Validation	rmse: 17.3	mae: 14.16	mape: 105.45%	acc@10: 41.29%	acc@20: 73.33%	acc@30: 93.25%	
[2023-12-05 19:02:28] INFO (nni/MainThread) Intermediate result: 17.304068294781217  (Index 77)
*** Epoch: 39 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.658 | ed:0.967 | hr@1:0.684 | hr@2:0.862 | hr@3:0.912 | acc@1:0.684 | acc@2:0.61 | acc@3:0.567 | Best krc: 0.81 | Best epoch: 35
[2023-12-05 19:04:07] INFO (nni/MainThread) Intermediate result: 0.7820105435059524  (Index 78)
-----------------ETPA RESULT-------------------
Epoch 39: Validation	rmse: 17.22	mae: 14.09	mape: 104.84%	acc@10: 41.59%	acc@20: 73.63%	acc@30: 93.32%	
[2023-12-05 19:04:07] INFO (nni/MainThread) Intermediate result: 17.222147420886447  (Index 79)
*** Epoch: 40 ***
-----------------G2R RESULT-------------------

val result: krc:0.796 | lsd:0.626 | ed:0.928 | hr@1:0.704 | hr@2:0.871 | hr@3:0.92 | acc@1:0.704 | acc@2:0.627 | acc@3:0.587 | Best krc: 0.81 | Best epoch: 35
[2023-12-05 19:05:45] INFO (nni/MainThread) Intermediate result: 0.7964274805988842  (Index 80)
-----------------ETPA RESULT-------------------
Epoch 40: Validation	rmse: 17.18	mae: 14.06	mape: 104.59%	acc@10: 41.73%	acc@20: 73.7%	acc@30: 93.38%	
[2023-12-05 19:05:45] INFO (nni/MainThread) Intermediate result: 17.177168272543256  (Index 81)
*** Epoch: 41 ***
-----------------G2R RESULT-------------------

val result: krc:0.809 | lsd:0.621 | ed:0.909 | hr@1:0.718 | hr@2:0.876 | hr@3:0.92 | acc@1:0.718 | acc@2:0.644 | acc@3:0.6 | Best krc: 0.81 | Best epoch: 35
[2023-12-05 19:07:23] INFO (nni/MainThread) Intermediate result: 0.8093131180144736  (Index 82)
-----------------ETPA RESULT-------------------
Epoch 41: Validation	rmse: 17.17	mae: 14.06	mape: 104.66%	acc@10: 41.63%	acc@20: 73.72%	acc@30: 93.42%	
[2023-12-05 19:07:23] INFO (nni/MainThread) Intermediate result: 17.16645804714558  (Index 83)
*** Epoch: 42 ***
-----------------G2R RESULT-------------------

val result: krc:0.807 | lsd:0.607 | ed:0.902 | hr@1:0.73 | hr@2:0.873 | hr@3:0.923 | acc@1:0.73 | acc@2:0.648 | acc@3:0.608 | Best krc: 0.81 | Best epoch: 35
[2023-12-05 19:09:00] INFO (nni/MainThread) Intermediate result: 0.8073851459072273  (Index 84)
-----------------ETPA RESULT-------------------
Epoch 42: Validation	rmse: 17.14	mae: 14.04	mape: 104.55%	acc@10: 41.74%	acc@20: 73.82%	acc@30: 93.42%	
[2023-12-05 19:09:00] INFO (nni/MainThread) Intermediate result: 17.141138596114292  (Index 85)
*** Epoch: 43 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.612 | ed:0.919 | hr@1:0.714 | hr@2:0.865 | hr@3:0.92 | acc@1:0.714 | acc@2:0.625 | acc@3:0.592 | Best krc: 0.81 | Best epoch: 35
[2023-12-05 19:10:38] INFO (nni/MainThread) Intermediate result: 0.8030846699495585  (Index 86)
-----------------ETPA RESULT-------------------
Epoch 43: Validation	rmse: 17.09	mae: 14.0	mape: 104.25%	acc@10: 41.84%	acc@20: 73.91%	acc@30: 93.49%	
[2023-12-05 19:10:38] INFO (nni/MainThread) Intermediate result: 17.09486802309395  (Index 87)
*** Epoch: 44 ***
-----------------G2R RESULT-------------------

val result: krc:0.794 | lsd:0.612 | ed:0.944 | hr@1:0.686 | hr@2:0.869 | hr@3:0.92 | acc@1:0.686 | acc@2:0.615 | acc@3:0.581 | Best krc: 0.81 | Best epoch: 35
[2023-12-05 19:12:17] INFO (nni/MainThread) Intermediate result: 0.7936104650665211  (Index 88)
-----------------ETPA RESULT-------------------
Epoch 44: Validation	rmse: 17.03	mae: 13.94	mape: 103.71%	acc@10: 42.08%	acc@20: 74.12%	acc@30: 93.56%	
[2023-12-05 19:12:17] INFO (nni/MainThread) Intermediate result: 17.032843032373034  (Index 89)
*** Epoch: 45 ***
-----------------G2R RESULT-------------------

val result: krc:0.802 | lsd:0.638 | ed:0.902 | hr@1:0.702 | hr@2:0.875 | hr@3:0.922 | acc@1:0.702 | acc@2:0.634 | acc@3:0.599 | Best krc: 0.81 | Best epoch: 35
[2023-12-05 19:13:58] INFO (nni/MainThread) Intermediate result: 0.8022792265468259  (Index 90)
-----------------ETPA RESULT-------------------
Epoch 45: Validation	rmse: 17.0	mae: 13.91	mape: 103.46%	acc@10: 42.22%	acc@20: 74.24%	acc@30: 93.59%	
[2023-12-05 19:13:58] INFO (nni/MainThread) Intermediate result: 16.99704374098185  (Index 91)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701795526.56950241701795526.5695157
best model loaded !!!
krc:0.807 | lsd:0.45 | ed:0.894 | hr@1:0.725 | hr@2:0.901 | hr@3:0.942 | acc@1:0.725 | acc@2:0.652 | acc@3:0.608 |

-------------------------------------------------------------
Best epoch for G2R:  35
Best epoch for ETPA:  45
graph2route_pd Evaluation in test: krc:0.807 | lsd:0.45 | ed:0.894 | hr@1:0.725 | hr@2:0.901 | hr@3:0.942 | acc@1:0.725 | acc@2:0.652 | acc@3:0.608 |
RankPETA Evaluation in test: rmse: 13.39	mae: 10.73	mape: 95.01%	acc@10: 54.85%	acc@20: 90.3%	acc@30: 96.62%	
