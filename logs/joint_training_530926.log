Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 1000,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.743 | lsd:0.747 | ed:1.092 | hr@1:0.624 | hr@2:0.845 | hr@3:0.898 | acc@1:0.624 | acc@2:0.556 | acc@3:0.513 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 10:52:24] INFO (nni/MainThread) Intermediate result: 0.7428762058845138  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 28.79	mae: 20.05	mape: 122.58%	acc@10: 35.93%	acc@20: 67.04%	acc@30: 79.26%	
[2023-12-01 10:52:24] INFO (nni/MainThread) Intermediate result: 28.789128222448728  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.682 | ed:1.019 | hr@1:0.631 | hr@2:0.856 | hr@3:0.906 | acc@1:0.631 | acc@2:0.568 | acc@3:0.534 | Best krc: 0.743 | Best epoch: 0
best model saved
[2023-12-01 10:53:00] INFO (nni/MainThread) Intermediate result: 0.7641552895597495  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 26.24	mae: 18.64	mape: 121.27%	acc@10: 39.44%	acc@20: 69.07%	acc@30: 80.37%	
[2023-12-01 10:53:00] INFO (nni/MainThread) Intermediate result: 26.240560764893907  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.695 | ed:1.003 | hr@1:0.636 | hr@2:0.86 | hr@3:0.909 | acc@1:0.636 | acc@2:0.578 | acc@3:0.54 | Best krc: 0.764 | Best epoch: 1
best model saved
[2023-12-01 10:53:32] INFO (nni/MainThread) Intermediate result: 0.7700346989809167  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 24.87	mae: 18.03	mape: 122.72%	acc@10: 39.88%	acc@20: 67.9%	acc@30: 81.73%	
[2023-12-01 10:53:32] INFO (nni/MainThread) Intermediate result: 24.87359136032953  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.701 | ed:1.002 | hr@1:0.634 | hr@2:0.858 | hr@3:0.906 | acc@1:0.634 | acc@2:0.579 | acc@3:0.543 | Best krc: 0.77 | Best epoch: 2
[2023-12-01 10:54:05] INFO (nni/MainThread) Intermediate result: 0.7664804747795566  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 23.3	mae: 17.3	mape: 121.89%	acc@10: 39.54%	acc@20: 68.33%	acc@30: 83.61%	
[2023-12-01 10:54:05] INFO (nni/MainThread) Intermediate result: 23.300722374880753  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.642 | ed:0.975 | hr@1:0.64 | hr@2:0.862 | hr@3:0.908 | acc@1:0.64 | acc@2:0.587 | acc@3:0.547 | Best krc: 0.77 | Best epoch: 2
best model saved
[2023-12-01 10:54:37] INFO (nni/MainThread) Intermediate result: 0.7771472198144697  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 23.14	mae: 17.36	mape: 125.34%	acc@10: 38.44%	acc@20: 67.48%	acc@30: 83.93%	
[2023-12-01 10:54:37] INFO (nni/MainThread) Intermediate result: 23.142591609502368  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.671 | ed:0.975 | hr@1:0.637 | hr@2:0.861 | hr@3:0.909 | acc@1:0.637 | acc@2:0.583 | acc@3:0.547 | Best krc: 0.777 | Best epoch: 4
[2023-12-01 10:55:07] INFO (nni/MainThread) Intermediate result: 0.775398603242941  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 22.7	mae: 17.26	mape: 126.26%	acc@10: 37.65%	acc@20: 67.28%	acc@30: 84.26%	
[2023-12-01 10:55:07] INFO (nni/MainThread) Intermediate result: 22.698609355169317  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.688 | ed:0.975 | hr@1:0.634 | hr@2:0.863 | hr@3:0.911 | acc@1:0.634 | acc@2:0.581 | acc@3:0.546 | Best krc: 0.777 | Best epoch: 4
[2023-12-01 10:55:37] INFO (nni/MainThread) Intermediate result: 0.7737121053168277  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 22.51	mae: 17.32	mape: 127.78%	acc@10: 36.56%	acc@20: 66.46%	acc@30: 84.29%	
[2023-12-01 10:55:37] INFO (nni/MainThread) Intermediate result: 22.51111278151522  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.661 | ed:0.957 | hr@1:0.641 | hr@2:0.864 | hr@3:0.911 | acc@1:0.641 | acc@2:0.587 | acc@3:0.551 | Best krc: 0.777 | Best epoch: 4
[2023-12-01 10:56:08] INFO (nni/MainThread) Intermediate result: 0.776970415614928  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 22.63	mae: 17.51	mape: 129.3%	acc@10: 35.74%	acc@20: 65.79%	acc@30: 84.07%	
[2023-12-01 10:56:08] INFO (nni/MainThread) Intermediate result: 22.63400854394687  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.662 | ed:0.962 | hr@1:0.639 | hr@2:0.861 | hr@3:0.911 | acc@1:0.639 | acc@2:0.582 | acc@3:0.549 | Best krc: 0.777 | Best epoch: 4
[2023-12-01 10:56:40] INFO (nni/MainThread) Intermediate result: 0.7757004051188573  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 22.42	mae: 17.37	mape: 128.83%	acc@10: 35.97%	acc@20: 66.13%	acc@30: 84.12%	
[2023-12-01 10:56:40] INFO (nni/MainThread) Intermediate result: 22.41720172729477  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.659 | ed:0.96 | hr@1:0.638 | hr@2:0.864 | hr@3:0.911 | acc@1:0.638 | acc@2:0.58 | acc@3:0.546 | Best krc: 0.777 | Best epoch: 4
[2023-12-01 10:57:11] INFO (nni/MainThread) Intermediate result: 0.7705855992782096  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 22.3	mae: 17.44	mape: 129.51%	acc@10: 35.15%	acc@20: 65.56%	acc@30: 84.0%	
[2023-12-01 10:57:11] INFO (nni/MainThread) Intermediate result: 22.298256412081543  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.657 | ed:0.954 | hr@1:0.645 | hr@2:0.868 | hr@3:0.912 | acc@1:0.645 | acc@2:0.588 | acc@3:0.554 | Best krc: 0.777 | Best epoch: 4
[2023-12-01 10:57:42] INFO (nni/MainThread) Intermediate result: 0.776972424974174  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 22.16	mae: 17.41	mape: 129.74%	acc@10: 34.78%	acc@20: 65.56%	acc@30: 84.11%	
[2023-12-01 10:57:42] INFO (nni/MainThread) Intermediate result: 22.164606636681693  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.645 | ed:0.954 | hr@1:0.641 | hr@2:0.865 | hr@3:0.911 | acc@1:0.641 | acc@2:0.585 | acc@3:0.553 | Best krc: 0.777 | Best epoch: 4
best model saved
[2023-12-01 10:58:14] INFO (nni/MainThread) Intermediate result: 0.777585483392217  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 22.02	mae: 17.4	mape: 129.81%	acc@10: 34.26%	acc@20: 65.37%	acc@30: 84.2%	
[2023-12-01 10:58:14] INFO (nni/MainThread) Intermediate result: 22.021070519302768  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.662 | ed:0.962 | hr@1:0.64 | hr@2:0.865 | hr@3:0.908 | acc@1:0.64 | acc@2:0.588 | acc@3:0.55 | Best krc: 0.778 | Best epoch: 11
best model saved
[2023-12-01 10:58:46] INFO (nni/MainThread) Intermediate result: 0.7781211491224609  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 21.65	mae: 17.17	mape: 128.32%	acc@10: 34.44%	acc@20: 65.84%	acc@30: 84.81%	
[2023-12-01 10:58:46] INFO (nni/MainThread) Intermediate result: 21.64946362542346  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.648 | ed:0.952 | hr@1:0.642 | hr@2:0.866 | hr@3:0.911 | acc@1:0.642 | acc@2:0.585 | acc@3:0.55 | Best krc: 0.778 | Best epoch: 12
[2023-12-01 10:59:18] INFO (nni/MainThread) Intermediate result: 0.7780883952724791  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 21.47	mae: 17.09	mape: 128.07%	acc@10: 34.29%	acc@20: 66.08%	acc@30: 85.08%	
[2023-12-01 10:59:18] INFO (nni/MainThread) Intermediate result: 21.472328306113965  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.664 | ed:0.989 | hr@1:0.63 | hr@2:0.867 | hr@3:0.913 | acc@1:0.63 | acc@2:0.573 | acc@3:0.539 | Best krc: 0.778 | Best epoch: 12
[2023-12-01 10:59:49] INFO (nni/MainThread) Intermediate result: 0.7685802729877936  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 21.31	mae: 17.01	mape: 127.59%	acc@10: 34.2%	acc@20: 66.22%	acc@30: 85.36%	
[2023-12-01 10:59:49] INFO (nni/MainThread) Intermediate result: 21.30668212268105  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.727 | ed:0.986 | hr@1:0.631 | hr@2:0.859 | hr@3:0.909 | acc@1:0.631 | acc@2:0.57 | acc@3:0.533 | Best krc: 0.778 | Best epoch: 12
[2023-12-01 11:00:22] INFO (nni/MainThread) Intermediate result: 0.7666514401888254  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 21.14	mae: 16.93	mape: 127.04%	acc@10: 34.4%	acc@20: 66.48%	acc@30: 85.6%	
[2023-12-01 11:00:22] INFO (nni/MainThread) Intermediate result: 21.142548972733827  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.675 | ed:0.965 | hr@1:0.634 | hr@2:0.867 | hr@3:0.913 | acc@1:0.634 | acc@2:0.583 | acc@3:0.547 | Best krc: 0.778 | Best epoch: 12
best model saved
[2023-12-01 11:00:52] INFO (nni/MainThread) Intermediate result: 0.778755201623588  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 20.88	mae: 16.75	mape: 125.74%	acc@10: 34.75%	acc@20: 66.88%	acc@30: 85.95%	
[2023-12-01 11:00:52] INFO (nni/MainThread) Intermediate result: 20.880520024383976  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.718 | ed:0.982 | hr@1:0.641 | hr@2:0.865 | hr@3:0.907 | acc@1:0.641 | acc@2:0.582 | acc@3:0.54 | Best krc: 0.779 | Best epoch: 16
[2023-12-01 11:01:23] INFO (nni/MainThread) Intermediate result: 0.7759309248946328  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 20.84	mae: 16.76	mape: 125.9%	acc@10: 34.44%	acc@20: 66.87%	acc@30: 85.95%	
[2023-12-01 11:01:23] INFO (nni/MainThread) Intermediate result: 20.83835661789785  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.674 | ed:0.987 | hr@1:0.636 | hr@2:0.868 | hr@3:0.912 | acc@1:0.636 | acc@2:0.579 | acc@3:0.538 | Best krc: 0.779 | Best epoch: 16
[2023-12-01 11:01:56] INFO (nni/MainThread) Intermediate result: 0.7736246490072463  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 20.63	mae: 16.6	mape: 124.74%	acc@10: 34.81%	acc@20: 67.45%	acc@30: 86.26%	
[2023-12-01 11:01:56] INFO (nni/MainThread) Intermediate result: 20.629327433667903  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.674 | ed:0.986 | hr@1:0.639 | hr@2:0.864 | hr@3:0.911 | acc@1:0.639 | acc@2:0.578 | acc@3:0.544 | Best krc: 0.779 | Best epoch: 16
[2023-12-01 11:02:28] INFO (nni/MainThread) Intermediate result: 0.776168291375987  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 20.46	mae: 16.48	mape: 123.98%	acc@10: 35.02%	acc@20: 67.81%	acc@30: 86.46%	
[2023-12-01 11:02:28] INFO (nni/MainThread) Intermediate result: 20.455357277084687  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.679 | ed:0.967 | hr@1:0.642 | hr@2:0.863 | hr@3:0.912 | acc@1:0.642 | acc@2:0.582 | acc@3:0.549 | Best krc: 0.779 | Best epoch: 16
[2023-12-01 11:03:00] INFO (nni/MainThread) Intermediate result: 0.7741412620643054  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 20.41	mae: 16.46	mape: 123.89%	acc@10: 35.03%	acc@20: 67.9%	acc@30: 86.58%	
[2023-12-01 11:03:00] INFO (nni/MainThread) Intermediate result: 20.41025453434388  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.69 | ed:0.998 | hr@1:0.638 | hr@2:0.861 | hr@3:0.909 | acc@1:0.638 | acc@2:0.573 | acc@3:0.537 | Best krc: 0.779 | Best epoch: 16
[2023-12-01 11:03:30] INFO (nni/MainThread) Intermediate result: 0.7733159606268484  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 20.31	mae: 16.38	mape: 123.43%	acc@10: 35.08%	acc@20: 68.18%	acc@30: 86.72%	
[2023-12-01 11:03:30] INFO (nni/MainThread) Intermediate result: 20.31255152499055  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.684 | ed:0.963 | hr@1:0.644 | hr@2:0.869 | hr@3:0.914 | acc@1:0.644 | acc@2:0.586 | acc@3:0.551 | Best krc: 0.779 | Best epoch: 16
best model saved
[2023-12-01 11:04:02] INFO (nni/MainThread) Intermediate result: 0.7796073948238356  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 20.33	mae: 16.43	mape: 123.86%	acc@10: 34.77%	acc@20: 68.04%	acc@30: 86.73%	
[2023-12-01 11:04:02] INFO (nni/MainThread) Intermediate result: 20.330686939783394  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.678 | ed:0.971 | hr@1:0.641 | hr@2:0.862 | hr@3:0.91 | acc@1:0.641 | acc@2:0.583 | acc@3:0.544 | Best krc: 0.78 | Best epoch: 22
[2023-12-01 11:04:34] INFO (nni/MainThread) Intermediate result: 0.7742459076171363  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 20.27	mae: 16.42	mape: 123.85%	acc@10: 34.63%	acc@20: 67.99%	acc@30: 86.84%	
[2023-12-01 11:04:34] INFO (nni/MainThread) Intermediate result: 20.272307798382673  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.654 | ed:0.959 | hr@1:0.644 | hr@2:0.869 | hr@3:0.915 | acc@1:0.644 | acc@2:0.587 | acc@3:0.553 | Best krc: 0.78 | Best epoch: 22
[2023-12-01 11:05:06] INFO (nni/MainThread) Intermediate result: 0.7781628104846295  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 20.09	mae: 16.28	mape: 122.9%	acc@10: 34.96%	acc@20: 68.4%	acc@30: 87.17%	
[2023-12-01 11:05:06] INFO (nni/MainThread) Intermediate result: 20.094116691938304  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.666 | ed:0.953 | hr@1:0.641 | hr@2:0.866 | hr@3:0.914 | acc@1:0.641 | acc@2:0.589 | acc@3:0.555 | Best krc: 0.78 | Best epoch: 22
[2023-12-01 11:05:38] INFO (nni/MainThread) Intermediate result: 0.7776840536263361  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 19.92	mae: 16.14	mape: 121.75%	acc@10: 35.47%	acc@20: 68.83%	acc@30: 87.41%	
[2023-12-01 11:05:38] INFO (nni/MainThread) Intermediate result: 19.92434925633622  (Index 51)
*** Epoch: 26 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.644 | ed:0.938 | hr@1:0.645 | hr@2:0.871 | hr@3:0.918 | acc@1:0.645 | acc@2:0.591 | acc@3:0.558 | Best krc: 0.78 | Best epoch: 22
[2023-12-01 11:06:12] INFO (nni/MainThread) Intermediate result: 0.779440418041205  (Index 52)
-----------------ETPA RESULT-------------------
Epoch 26: Validation	rmse: 19.9	mae: 16.15	mape: 121.85%	acc@10: 35.31%	acc@20: 68.79%	acc@30: 87.43%	
[2023-12-01 11:06:12] INFO (nni/MainThread) Intermediate result: 19.896507105665957  (Index 53)
*** Epoch: 27 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.66 | ed:0.961 | hr@1:0.64 | hr@2:0.869 | hr@3:0.912 | acc@1:0.64 | acc@2:0.586 | acc@3:0.551 | Best krc: 0.78 | Best epoch: 22
[2023-12-01 11:06:45] INFO (nni/MainThread) Intermediate result: 0.7777150728265726  (Index 54)
-----------------ETPA RESULT-------------------
Epoch 27: Validation	rmse: 19.82	mae: 16.1	mape: 121.47%	acc@10: 35.28%	acc@20: 68.92%	acc@30: 87.57%	
[2023-12-01 11:06:45] INFO (nni/MainThread) Intermediate result: 19.81540828753696  (Index 55)
*** Epoch: 28 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.647 | ed:0.974 | hr@1:0.638 | hr@2:0.868 | hr@3:0.916 | acc@1:0.638 | acc@2:0.579 | acc@3:0.542 | Best krc: 0.78 | Best epoch: 22
[2023-12-01 11:07:17] INFO (nni/MainThread) Intermediate result: 0.7715472863789437  (Index 56)
-----------------ETPA RESULT-------------------
Epoch 28: Validation	rmse: 19.7	mae: 16.01	mape: 120.83%	acc@10: 35.45%	acc@20: 69.17%	acc@30: 87.79%	
[2023-12-01 11:07:17] INFO (nni/MainThread) Intermediate result: 19.696609042332543  (Index 57)
*** Epoch: 29 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.635 | ed:0.947 | hr@1:0.647 | hr@2:0.87 | hr@3:0.917 | acc@1:0.647 | acc@2:0.589 | acc@3:0.554 | Best krc: 0.78 | Best epoch: 22
best model saved
[2023-12-01 11:07:49] INFO (nni/MainThread) Intermediate result: 0.7800789924095565  (Index 58)
-----------------ETPA RESULT-------------------
Epoch 29: Validation	rmse: 19.56	mae: 15.91	mape: 120.05%	acc@10: 35.72%	acc@20: 69.48%	acc@30: 88.05%	
[2023-12-01 11:07:49] INFO (nni/MainThread) Intermediate result: 19.563716837456234  (Index 59)
*** Epoch: 30 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.657 | ed:0.977 | hr@1:0.638 | hr@2:0.867 | hr@3:0.912 | acc@1:0.638 | acc@2:0.585 | acc@3:0.546 | Best krc: 0.78 | Best epoch: 29
[2023-12-01 11:08:21] INFO (nni/MainThread) Intermediate result: 0.7676080670046564  (Index 60)
-----------------ETPA RESULT-------------------
Epoch 30: Validation	rmse: 19.42	mae: 15.79	mape: 119.03%	acc@10: 36.12%	acc@20: 69.8%	acc@30: 88.34%	
[2023-12-01 11:08:21] INFO (nni/MainThread) Intermediate result: 19.419005587321028  (Index 61)
*** Epoch: 31 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.634 | ed:0.978 | hr@1:0.641 | hr@2:0.871 | hr@3:0.915 | acc@1:0.641 | acc@2:0.582 | acc@3:0.543 | Best krc: 0.78 | Best epoch: 29
[2023-12-01 11:08:54] INFO (nni/MainThread) Intermediate result: 0.7742830862638471  (Index 62)
-----------------ETPA RESULT-------------------
Epoch 31: Validation	rmse: 19.3	mae: 15.7	mape: 118.31%	acc@10: 36.41%	acc@20: 70.09%	acc@30: 88.6%	
[2023-12-01 11:08:54] INFO (nni/MainThread) Intermediate result: 19.29624124122689  (Index 63)
*** Epoch: 32 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.711 | ed:0.997 | hr@1:0.639 | hr@2:0.863 | hr@3:0.906 | acc@1:0.639 | acc@2:0.584 | acc@3:0.541 | Best krc: 0.78 | Best epoch: 29
[2023-12-01 11:09:30] INFO (nni/MainThread) Intermediate result: 0.7653228389126947  (Index 64)
-----------------ETPA RESULT-------------------
Epoch 32: Validation	rmse: 19.35	mae: 15.76	mape: 118.79%	acc@10: 36.12%	acc@20: 69.94%	acc@30: 88.54%	
[2023-12-01 11:09:30] INFO (nni/MainThread) Intermediate result: 19.34811588501285  (Index 65)
*** Epoch: 33 ***
-----------------G2R RESULT-------------------

val result: krc:0.783 | lsd:0.636 | ed:0.939 | hr@1:0.646 | hr@2:0.871 | hr@3:0.918 | acc@1:0.646 | acc@2:0.593 | acc@3:0.562 | Best krc: 0.78 | Best epoch: 29
best model saved
[2023-12-01 11:10:05] INFO (nni/MainThread) Intermediate result: 0.7830428823957464  (Index 66)
-----------------ETPA RESULT-------------------
Epoch 33: Validation	rmse: 19.23	mae: 15.66	mape: 118.0%	acc@10: 36.45%	acc@20: 70.27%	acc@30: 88.74%	
[2023-12-01 11:10:05] INFO (nni/MainThread) Intermediate result: 19.231456433858877  (Index 67)
*** Epoch: 34 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.711 | ed:0.975 | hr@1:0.642 | hr@2:0.869 | hr@3:0.912 | acc@1:0.642 | acc@2:0.588 | acc@3:0.551 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 11:10:46] INFO (nni/MainThread) Intermediate result: 0.7736592734056662  (Index 68)
-----------------ETPA RESULT-------------------
Epoch 34: Validation	rmse: 19.15	mae: 15.6	mape: 117.49%	acc@10: 36.61%	acc@20: 70.48%	acc@30: 88.86%	
[2023-12-01 11:10:46] INFO (nni/MainThread) Intermediate result: 19.154214311795865  (Index 69)
*** Epoch: 35 ***
-----------------G2R RESULT-------------------

val result: krc:0.785 | lsd:0.656 | ed:0.928 | hr@1:0.649 | hr@2:0.869 | hr@3:0.916 | acc@1:0.649 | acc@2:0.594 | acc@3:0.562 | Best krc: 0.783 | Best epoch: 33
best model saved
[2023-12-01 11:11:19] INFO (nni/MainThread) Intermediate result: 0.7850369067684327  (Index 70)
-----------------ETPA RESULT-------------------
Epoch 35: Validation	rmse: 19.11	mae: 15.57	mape: 117.35%	acc@10: 36.62%	acc@20: 70.53%	acc@30: 88.94%	
[2023-12-01 11:11:19] INFO (nni/MainThread) Intermediate result: 19.11359885465334  (Index 71)
*** Epoch: 36 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.668 | ed:0.96 | hr@1:0.647 | hr@2:0.868 | hr@3:0.917 | acc@1:0.647 | acc@2:0.59 | acc@3:0.556 | Best krc: 0.785 | Best epoch: 35
[2023-12-01 11:11:54] INFO (nni/MainThread) Intermediate result: 0.7759436291574464  (Index 72)
-----------------ETPA RESULT-------------------
Epoch 36: Validation	rmse: 19.0	mae: 15.49	mape: 116.67%	acc@10: 36.81%	acc@20: 70.8%	acc@30: 89.19%	
[2023-12-01 11:11:54] INFO (nni/MainThread) Intermediate result: 18.998021547711026  (Index 73)
*** Epoch: 37 ***
-----------------G2R RESULT-------------------

val result: krc:0.758 | lsd:0.701 | ed:1.025 | hr@1:0.627 | hr@2:0.862 | hr@3:0.908 | acc@1:0.627 | acc@2:0.573 | acc@3:0.532 | Best krc: 0.785 | Best epoch: 35
[2023-12-01 11:12:35] INFO (nni/MainThread) Intermediate result: 0.7577110431067582  (Index 74)
-----------------ETPA RESULT-------------------
Epoch 37: Validation	rmse: 18.93	mae: 15.44	mape: 116.3%	acc@10: 36.84%	acc@20: 70.92%	acc@30: 89.36%	
[2023-12-01 11:12:35] INFO (nni/MainThread) Intermediate result: 18.93230886342248  (Index 75)
*** Epoch: 38 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.67 | ed:0.986 | hr@1:0.628 | hr@2:0.864 | hr@3:0.912 | acc@1:0.628 | acc@2:0.575 | acc@3:0.541 | Best krc: 0.785 | Best epoch: 35
[2023-12-01 11:13:10] INFO (nni/MainThread) Intermediate result: 0.7700525395671877  (Index 76)
-----------------ETPA RESULT-------------------
Epoch 38: Validation	rmse: 18.87	mae: 15.39	mape: 115.88%	acc@10: 37.01%	acc@20: 71.08%	acc@30: 89.44%	
[2023-12-01 11:13:10] INFO (nni/MainThread) Intermediate result: 18.871465130266657  (Index 77)
*** Epoch: 39 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.661 | ed:0.968 | hr@1:0.641 | hr@2:0.866 | hr@3:0.913 | acc@1:0.641 | acc@2:0.586 | acc@3:0.551 | Best krc: 0.785 | Best epoch: 35
[2023-12-01 11:13:44] INFO (nni/MainThread) Intermediate result: 0.7784702003853731  (Index 78)
-----------------ETPA RESULT-------------------
Epoch 39: Validation	rmse: 18.79	mae: 15.32	mape: 115.26%	acc@10: 37.3%	acc@20: 71.31%	acc@30: 89.52%	
[2023-12-01 11:13:44] INFO (nni/MainThread) Intermediate result: 18.791166988548436  (Index 79)
*** Epoch: 40 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.696 | ed:1.021 | hr@1:0.64 | hr@2:0.862 | hr@3:0.906 | acc@1:0.64 | acc@2:0.579 | acc@3:0.535 | Best krc: 0.785 | Best epoch: 35
[2023-12-01 11:14:17] INFO (nni/MainThread) Intermediate result: 0.7609350461033888  (Index 80)
-----------------ETPA RESULT-------------------
Epoch 40: Validation	rmse: 18.7	mae: 15.25	mape: 114.66%	acc@10: 37.55%	acc@20: 71.52%	acc@30: 89.7%	
[2023-12-01 11:14:17] INFO (nni/MainThread) Intermediate result: 18.70084401038039  (Index 81)
*** Epoch: 41 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.651 | ed:0.942 | hr@1:0.646 | hr@2:0.868 | hr@3:0.914 | acc@1:0.646 | acc@2:0.593 | acc@3:0.56 | Best krc: 0.785 | Best epoch: 35
[2023-12-01 11:14:53] INFO (nni/MainThread) Intermediate result: 0.7816047868955609  (Index 82)
-----------------ETPA RESULT-------------------
Epoch 41: Validation	rmse: 18.67	mae: 15.22	mape: 114.49%	acc@10: 37.56%	acc@20: 71.56%	acc@30: 89.78%	
[2023-12-01 11:14:53] INFO (nni/MainThread) Intermediate result: 18.665351955093865  (Index 83)
*** Epoch: 42 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.636 | ed:0.953 | hr@1:0.647 | hr@2:0.871 | hr@3:0.914 | acc@1:0.647 | acc@2:0.59 | acc@3:0.552 | Best krc: 0.785 | Best epoch: 35
[2023-12-01 11:15:36] INFO (nni/MainThread) Intermediate result: 0.7824751656059044  (Index 84)
-----------------ETPA RESULT-------------------
Epoch 42: Validation	rmse: 18.62	mae: 15.19	mape: 114.2%	acc@10: 37.64%	acc@20: 71.66%	acc@30: 89.84%	
[2023-12-01 11:15:36] INFO (nni/MainThread) Intermediate result: 18.62159360845913  (Index 85)
*** Epoch: 43 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.682 | ed:0.991 | hr@1:0.648 | hr@2:0.865 | hr@3:0.909 | acc@1:0.648 | acc@2:0.585 | acc@3:0.542 | Best krc: 0.785 | Best epoch: 35
[2023-12-01 11:16:14] INFO (nni/MainThread) Intermediate result: 0.7679696623640653  (Index 86)
-----------------ETPA RESULT-------------------
Epoch 43: Validation	rmse: 18.5	mae: 15.08	mape: 113.14%	acc@10: 38.09%	acc@20: 71.98%	acc@30: 89.99%	
[2023-12-01 11:16:14] INFO (nni/MainThread) Intermediate result: 18.501880635132206  (Index 87)
*** Epoch: 44 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.662 | ed:0.924 | hr@1:0.654 | hr@2:0.866 | hr@3:0.915 | acc@1:0.654 | acc@2:0.597 | acc@3:0.566 | Best krc: 0.785 | Best epoch: 35
[2023-12-01 11:16:56] INFO (nni/MainThread) Intermediate result: 0.7822960802497313  (Index 88)
-----------------ETPA RESULT-------------------
Epoch 44: Validation	rmse: 18.44	mae: 15.04	mape: 112.8%	acc@10: 38.16%	acc@20: 72.07%	acc@30: 90.16%	
[2023-12-01 11:16:56] INFO (nni/MainThread) Intermediate result: 18.444063270995855  (Index 89)
*** Epoch: 45 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.665 | ed:0.954 | hr@1:0.645 | hr@2:0.869 | hr@3:0.917 | acc@1:0.645 | acc@2:0.587 | acc@3:0.552 | Best krc: 0.785 | Best epoch: 35
[2023-12-01 11:17:32] INFO (nni/MainThread) Intermediate result: 0.7817752203585171  (Index 90)
-----------------ETPA RESULT-------------------
Epoch 45: Validation	rmse: 18.41	mae: 15.02	mape: 112.56%	acc@10: 38.24%	acc@20: 72.12%	acc@30: 90.19%	
[2023-12-01 11:17:32] INFO (nni/MainThread) Intermediate result: 18.41248904115582  (Index 91)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701424313.22521921701424313.2252312
best model loaded !!!
krc:0.777 | lsd:0.48 | ed:0.973 | hr@1:0.655 | hr@2:0.903 | hr@3:0.94 | acc@1:0.655 | acc@2:0.601 | acc@3:0.554 |

-------------------------------------------------------------
Best epoch for G2R:  35
Best epoch for ETPA:  45
graph2route_pd Evaluation in test: krc:0.777 | lsd:0.48 | ed:0.973 | hr@1:0.655 | hr@2:0.903 | hr@3:0.94 | acc@1:0.655 | acc@2:0.601 | acc@3:0.554 |
RankPETA Evaluation in test: rmse: 15.44	mae: 12.23	mape: 105.95%	acc@10: 46.41%	acc@20: 81.86%	acc@30: 96.2%	
