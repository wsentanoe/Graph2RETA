Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.756 | lsd:0.723 | ed:1.053 | hr@1:0.624 | hr@2:0.86 | hr@3:0.903 | acc@1:0.624 | acc@2:0.563 | acc@3:0.524 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-07 08:30:21] INFO (nni/MainThread) Intermediate result: 0.7556431196133865  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 26.26	mae: 20.73	mape: 67.03%	acc@10: 29.63%	acc@20: 57.41%	acc@30: 76.3%	
[2023-12-07 08:30:21] INFO (nni/MainThread) Intermediate result: 26.25884105208068  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.755 | lsd:0.713 | ed:1.055 | hr@1:0.62 | hr@2:0.857 | hr@3:0.902 | acc@1:0.62 | acc@2:0.561 | acc@3:0.519 | Best krc: 0.756 | Best epoch: 0
[2023-12-07 08:30:54] INFO (nni/MainThread) Intermediate result: 0.7545256463402507  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 27.9	mae: 21.11	mape: 113.06%	acc@10: 30.19%	acc@20: 59.44%	acc@30: 77.41%	
[2023-12-07 08:30:54] INFO (nni/MainThread) Intermediate result: 27.899649119733837  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.753 | lsd:0.729 | ed:1.063 | hr@1:0.62 | hr@2:0.854 | hr@3:0.9 | acc@1:0.62 | acc@2:0.558 | acc@3:0.515 | Best krc: 0.756 | Best epoch: 0
[2023-12-07 08:31:27] INFO (nni/MainThread) Intermediate result: 0.7527953010244223  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 27.85	mae: 21.29	mape: 132.28%	acc@10: 28.77%	acc@20: 59.14%	acc@30: 77.04%	
[2023-12-07 08:31:27] INFO (nni/MainThread) Intermediate result: 27.853590159150293  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.757 | lsd:0.709 | ed:1.05 | hr@1:0.628 | hr@2:0.861 | hr@3:0.906 | acc@1:0.628 | acc@2:0.565 | acc@3:0.524 | Best krc: 0.756 | Best epoch: 0
best model saved
[2023-12-07 08:32:01] INFO (nni/MainThread) Intermediate result: 0.7570394738300289  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 25.81	mae: 20.09	mape: 131.0%	acc@10: 29.63%	acc@20: 60.93%	acc@30: 79.35%	
[2023-12-07 08:32:01] INFO (nni/MainThread) Intermediate result: 25.80908083451799  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.691 | ed:1.014 | hr@1:0.633 | hr@2:0.862 | hr@3:0.905 | acc@1:0.633 | acc@2:0.575 | acc@3:0.53 | Best krc: 0.757 | Best epoch: 3
best model saved
[2023-12-07 08:32:35] INFO (nni/MainThread) Intermediate result: 0.7687101646349569  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 24.8	mae: 19.59	mape: 132.76%	acc@10: 29.63%	acc@20: 61.56%	acc@30: 80.3%	
[2023-12-07 08:32:36] INFO (nni/MainThread) Intermediate result: 24.800078978322098  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.667 | ed:1.004 | hr@1:0.627 | hr@2:0.862 | hr@3:0.913 | acc@1:0.627 | acc@2:0.567 | acc@3:0.534 | Best krc: 0.769 | Best epoch: 4
best model saved
[2023-12-07 08:33:09] INFO (nni/MainThread) Intermediate result: 0.7713214136913308  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 23.96	mae: 19.1	mape: 132.63%	acc@10: 30.25%	acc@20: 62.41%	acc@30: 81.05%	
[2023-12-07 08:33:09] INFO (nni/MainThread) Intermediate result: 23.964124135066154  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.753 | lsd:0.745 | ed:1.05 | hr@1:0.631 | hr@2:0.856 | hr@3:0.902 | acc@1:0.631 | acc@2:0.568 | acc@3:0.527 | Best krc: 0.771 | Best epoch: 5
[2023-12-07 08:33:42] INFO (nni/MainThread) Intermediate result: 0.7531504421666206  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 23.3	mae: 18.69	mape: 131.71%	acc@10: 30.85%	acc@20: 63.23%	acc@30: 81.96%	
[2023-12-07 08:33:42] INFO (nni/MainThread) Intermediate result: 23.301372497822197  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.752 | lsd:0.727 | ed:1.074 | hr@1:0.64 | hr@2:0.86 | hr@3:0.899 | acc@1:0.64 | acc@2:0.572 | acc@3:0.517 | Best krc: 0.771 | Best epoch: 5
[2023-12-07 08:34:14] INFO (nni/MainThread) Intermediate result: 0.7523713268706709  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 22.8	mae: 18.33	mape: 130.69%	acc@10: 31.25%	acc@20: 63.84%	acc@30: 82.78%	
[2023-12-07 08:34:14] INFO (nni/MainThread) Intermediate result: 22.795921951688438  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.666 | ed:0.979 | hr@1:0.63 | hr@2:0.869 | hr@3:0.913 | acc@1:0.63 | acc@2:0.579 | acc@3:0.544 | Best krc: 0.771 | Best epoch: 5
[2023-12-07 08:34:48] INFO (nni/MainThread) Intermediate result: 0.76996372168213  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 22.78	mae: 18.36	mape: 132.12%	acc@10: 31.11%	acc@20: 63.46%	acc@30: 82.76%	
[2023-12-07 08:34:48] INFO (nni/MainThread) Intermediate result: 22.782255462852564  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.638 | ed:0.958 | hr@1:0.643 | hr@2:0.866 | hr@3:0.917 | acc@1:0.643 | acc@2:0.589 | acc@3:0.557 | Best krc: 0.771 | Best epoch: 5
best model saved
[2023-12-07 08:35:22] INFO (nni/MainThread) Intermediate result: 0.7789237460947122  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 22.53	mae: 18.24	mape: 132.05%	acc@10: 31.26%	acc@20: 63.33%	acc@30: 83.22%	
[2023-12-07 08:35:22] INFO (nni/MainThread) Intermediate result: 22.52793807249554  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.666 | ed:0.974 | hr@1:0.639 | hr@2:0.868 | hr@3:0.914 | acc@1:0.639 | acc@2:0.587 | acc@3:0.549 | Best krc: 0.779 | Best epoch: 9
[2023-12-07 08:35:55] INFO (nni/MainThread) Intermediate result: 0.772484866669388  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 22.21	mae: 17.97	mape: 130.44%	acc@10: 31.75%	acc@20: 63.87%	acc@30: 83.67%	
[2023-12-07 08:35:55] INFO (nni/MainThread) Intermediate result: 22.20848813555396  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.678 | ed:0.99 | hr@1:0.627 | hr@2:0.858 | hr@3:0.912 | acc@1:0.627 | acc@2:0.571 | acc@3:0.541 | Best krc: 0.779 | Best epoch: 9
[2023-12-07 08:36:28] INFO (nni/MainThread) Intermediate result: 0.7681859418982288  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 21.95	mae: 17.77	mape: 129.44%	acc@10: 32.19%	acc@20: 64.2%	acc@30: 84.2%	
[2023-12-07 08:36:28] INFO (nni/MainThread) Intermediate result: 21.945631309222627  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.677 | ed:0.986 | hr@1:0.626 | hr@2:0.86 | hr@3:0.91 | acc@1:0.626 | acc@2:0.568 | acc@3:0.534 | Best krc: 0.779 | Best epoch: 9
[2023-12-07 08:37:01] INFO (nni/MainThread) Intermediate result: 0.7676670590094289  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 21.51	mae: 17.39	mape: 126.87%	acc@10: 33.25%	acc@20: 65.24%	acc@30: 84.87%	
[2023-12-07 08:37:01] INFO (nni/MainThread) Intermediate result: 21.507876819254214  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.679 | ed:0.991 | hr@1:0.632 | hr@2:0.862 | hr@3:0.911 | acc@1:0.632 | acc@2:0.575 | acc@3:0.54 | Best krc: 0.779 | Best epoch: 9
[2023-12-07 08:37:34] INFO (nni/MainThread) Intermediate result: 0.7664459370974454  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 21.41	mae: 17.33	mape: 126.66%	acc@10: 33.36%	acc@20: 65.24%	acc@30: 85.11%	
[2023-12-07 08:37:34] INFO (nni/MainThread) Intermediate result: 21.40661698074898  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.641 | ed:0.951 | hr@1:0.647 | hr@2:0.866 | hr@3:0.913 | acc@1:0.647 | acc@2:0.59 | acc@3:0.555 | Best krc: 0.779 | Best epoch: 9
best model saved
[2023-12-07 08:38:08] INFO (nni/MainThread) Intermediate result: 0.7790495562511305  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 21.19	mae: 17.16	mape: 125.73%	acc@10: 33.73%	acc@20: 65.7%	acc@30: 85.41%	
[2023-12-07 08:38:08] INFO (nni/MainThread) Intermediate result: 21.190230432884793  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.65 | ed:0.972 | hr@1:0.638 | hr@2:0.864 | hr@3:0.913 | acc@1:0.638 | acc@2:0.577 | acc@3:0.54 | Best krc: 0.779 | Best epoch: 14
[2023-12-07 08:38:41] INFO (nni/MainThread) Intermediate result: 0.7709439233619381  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 20.84	mae: 16.87	mape: 123.57%	acc@10: 34.44%	acc@20: 66.67%	acc@30: 86.0%	
[2023-12-07 08:38:41] INFO (nni/MainThread) Intermediate result: 20.83769656954563  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.654 | ed:0.966 | hr@1:0.635 | hr@2:0.863 | hr@3:0.912 | acc@1:0.635 | acc@2:0.579 | acc@3:0.544 | Best krc: 0.779 | Best epoch: 14
[2023-12-07 08:39:14] INFO (nni/MainThread) Intermediate result: 0.774624698367593  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 20.53	mae: 16.62	mape: 121.71%	acc@10: 35.01%	acc@20: 67.52%	acc@30: 86.54%	
[2023-12-07 08:39:14] INFO (nni/MainThread) Intermediate result: 20.53175999840532  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.689 | ed:1.013 | hr@1:0.628 | hr@2:0.864 | hr@3:0.91 | acc@1:0.628 | acc@2:0.572 | acc@3:0.534 | Best krc: 0.779 | Best epoch: 14
[2023-12-07 08:39:46] INFO (nni/MainThread) Intermediate result: 0.7643125065512473  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 20.32	mae: 16.45	mape: 120.55%	acc@10: 35.29%	acc@20: 68.07%	acc@30: 86.89%	
[2023-12-07 08:39:46] INFO (nni/MainThread) Intermediate result: 20.319316039378073  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.64 | ed:0.954 | hr@1:0.647 | hr@2:0.866 | hr@3:0.915 | acc@1:0.647 | acc@2:0.592 | acc@3:0.557 | Best krc: 0.779 | Best epoch: 14
[2023-12-07 08:40:20] INFO (nni/MainThread) Intermediate result: 0.7788700586689219  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 20.08	mae: 16.25	mape: 119.1%	acc@10: 35.77%	acc@20: 68.65%	acc@30: 87.29%	
[2023-12-07 08:40:20] INFO (nni/MainThread) Intermediate result: 20.076364344172312  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.657 | ed:0.989 | hr@1:0.636 | hr@2:0.866 | hr@3:0.911 | acc@1:0.636 | acc@2:0.582 | acc@3:0.543 | Best krc: 0.779 | Best epoch: 14
[2023-12-07 08:40:53] INFO (nni/MainThread) Intermediate result: 0.7713750668188796  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 19.92	mae: 16.12	mape: 118.28%	acc@10: 36.17%	acc@20: 69.13%	acc@30: 87.46%	
[2023-12-07 08:40:53] INFO (nni/MainThread) Intermediate result: 19.919938619050175  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.67 | ed:1.016 | hr@1:0.629 | hr@2:0.866 | hr@3:0.912 | acc@1:0.629 | acc@2:0.571 | acc@3:0.532 | Best krc: 0.779 | Best epoch: 14
[2023-12-07 08:41:25] INFO (nni/MainThread) Intermediate result: 0.7650124818904883  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 19.68	mae: 15.92	mape: 116.79%	acc@10: 36.68%	acc@20: 69.74%	acc@30: 87.85%	
[2023-12-07 08:41:25] INFO (nni/MainThread) Intermediate result: 19.6796886457176  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.697 | ed:1.018 | hr@1:0.634 | hr@2:0.861 | hr@3:0.907 | acc@1:0.634 | acc@2:0.575 | acc@3:0.531 | Best krc: 0.779 | Best epoch: 14
[2023-12-07 08:41:59] INFO (nni/MainThread) Intermediate result: 0.7589426386015805  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 19.45	mae: 15.72	mape: 114.98%	acc@10: 37.47%	acc@20: 70.34%	acc@30: 88.2%	
[2023-12-07 08:41:59] INFO (nni/MainThread) Intermediate result: 19.451763955018507  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.691 | ed:1.011 | hr@1:0.635 | hr@2:0.862 | hr@3:0.905 | acc@1:0.635 | acc@2:0.575 | acc@3:0.534 | Best krc: 0.779 | Best epoch: 14
[2023-12-07 08:42:32] INFO (nni/MainThread) Intermediate result: 0.7629836736002018  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 19.26	mae: 15.56	mape: 113.74%	acc@10: 37.92%	acc@20: 70.77%	acc@30: 88.45%	
[2023-12-07 08:42:32] INFO (nni/MainThread) Intermediate result: 19.264166946488995  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.646 | ed:0.982 | hr@1:0.632 | hr@2:0.863 | hr@3:0.913 | acc@1:0.632 | acc@2:0.573 | acc@3:0.539 | Best krc: 0.779 | Best epoch: 14
[2023-12-07 08:43:05] INFO (nni/MainThread) Intermediate result: 0.7725433759102319  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 19.15	mae: 15.47	mape: 113.16%	acc@10: 38.12%	acc@20: 71.06%	acc@30: 88.58%	
[2023-12-07 08:43:05] INFO (nni/MainThread) Intermediate result: 19.15491493459185  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.668 | ed:0.967 | hr@1:0.634 | hr@2:0.865 | hr@3:0.912 | acc@1:0.634 | acc@2:0.58 | acc@3:0.548 | Best krc: 0.779 | Best epoch: 14
[2023-12-07 08:43:38] INFO (nni/MainThread) Intermediate result: 0.7761248969819149  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 19.01	mae: 15.34	mape: 112.17%	acc@10: 38.52%	acc@20: 71.48%	acc@30: 88.76%	
[2023-12-07 08:43:38] INFO (nni/MainThread) Intermediate result: 19.01193616739854  (Index 49)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701934188.7657311701934188.7657495
best model loaded !!!
krc:0.771 | lsd:0.493 | ed:0.976 | hr@1:0.653 | hr@2:0.902 | hr@3:0.937 | acc@1:0.653 | acc@2:0.603 | acc@3:0.557 |

-------------------------------------------------------------
Best epoch for G2R:  14
Best epoch for ETPA:  24
graph2route_pd Evaluation in test: krc:0.771 | lsd:0.493 | ed:0.976 | hr@1:0.653 | hr@2:0.902 | hr@3:0.937 | acc@1:0.653 | acc@2:0.603 | acc@3:0.557 |
RankPETA Evaluation in test: rmse: 13.58	mae: 10.8	mape: 97.04%	acc@10: 53.59%	acc@20: 88.19%	acc@30: 97.05%	
