Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 9999,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.606 | lsd:1.294 | ed:1.489 | hr@1:0.585 | hr@2:0.738 | hr@3:0.837 | acc@1:0.585 | acc@2:0.437 | acc@3:0.408 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-18 16:21:54] INFO (nni/MainThread) Intermediate result: 0.6064505896862697  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 23.38	mae: 17.29	mape: 104.74%	acc@10: 40.37%	acc@20: 70.0%	acc@30: 83.7%	
[2023-12-18 16:21:54] INFO (nni/MainThread) Intermediate result: 23.376545737661928  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.735 | lsd:0.831 | ed:1.119 | hr@1:0.643 | hr@2:0.834 | hr@3:0.893 | acc@1:0.643 | acc@2:0.551 | acc@3:0.509 | Best krc: 0.606 | Best epoch: 0
best model saved
[2023-12-18 16:22:20] INFO (nni/MainThread) Intermediate result: 0.734681698809377  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 22.97	mae: 17.03	mape: 109.17%	acc@10: 41.85%	acc@20: 70.19%	acc@30: 82.96%	
[2023-12-18 16:22:20] INFO (nni/MainThread) Intermediate result: 22.96934026910179  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.696 | ed:0.996 | hr@1:0.656 | hr@2:0.861 | hr@3:0.912 | acc@1:0.656 | acc@2:0.589 | acc@3:0.555 | Best krc: 0.735 | Best epoch: 1
best model saved
[2023-12-18 16:22:46] INFO (nni/MainThread) Intermediate result: 0.7717184805510123  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 21.51	mae: 15.97	mape: 103.02%	acc@10: 44.69%	acc@20: 72.47%	acc@30: 84.07%	
[2023-12-18 16:22:46] INFO (nni/MainThread) Intermediate result: 21.51067668706724  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.664 | ed:0.976 | hr@1:0.65 | hr@2:0.868 | hr@3:0.914 | acc@1:0.65 | acc@2:0.587 | acc@3:0.554 | Best krc: 0.772 | Best epoch: 2
best model saved
[2023-12-18 16:23:12] INFO (nni/MainThread) Intermediate result: 0.779094525128631  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 20.86	mae: 15.65	mape: 104.86%	acc@10: 44.35%	acc@20: 72.31%	acc@30: 85.09%	
[2023-12-18 16:23:12] INFO (nni/MainThread) Intermediate result: 20.858156007627006  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.699 | ed:0.994 | hr@1:0.65 | hr@2:0.862 | hr@3:0.911 | acc@1:0.65 | acc@2:0.584 | acc@3:0.551 | Best krc: 0.779 | Best epoch: 3
[2023-12-18 16:23:37] INFO (nni/MainThread) Intermediate result: 0.7753636261550559  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 20.36	mae: 15.34	mape: 104.17%	acc@10: 44.81%	acc@20: 73.26%	acc@30: 85.56%	
[2023-12-18 16:23:37] INFO (nni/MainThread) Intermediate result: 20.358570846000973  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.715 | ed:1.035 | hr@1:0.643 | hr@2:0.855 | hr@3:0.904 | acc@1:0.643 | acc@2:0.575 | acc@3:0.532 | Best krc: 0.779 | Best epoch: 3
[2023-12-18 16:24:02] INFO (nni/MainThread) Intermediate result: 0.7597819625191728  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 19.94	mae: 15.09	mape: 104.0%	acc@10: 44.69%	acc@20: 73.89%	acc@30: 86.23%	
[2023-12-18 16:24:02] INFO (nni/MainThread) Intermediate result: 19.936307166474624  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.687 | ed:1.007 | hr@1:0.65 | hr@2:0.863 | hr@3:0.907 | acc@1:0.65 | acc@2:0.587 | acc@3:0.542 | Best krc: 0.779 | Best epoch: 3
[2023-12-18 16:24:28] INFO (nni/MainThread) Intermediate result: 0.766291464612409  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 19.48	mae: 14.81	mape: 102.63%	acc@10: 44.97%	acc@20: 74.76%	acc@30: 86.93%	
[2023-12-18 16:24:28] INFO (nni/MainThread) Intermediate result: 19.477879466126286  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.649 | ed:0.944 | hr@1:0.652 | hr@2:0.867 | hr@3:0.916 | acc@1:0.652 | acc@2:0.594 | acc@3:0.562 | Best krc: 0.779 | Best epoch: 3
best model saved
[2023-12-18 16:24:54] INFO (nni/MainThread) Intermediate result: 0.7820417898511471  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.1	mae: 14.59	mape: 102.43%	acc@10: 45.05%	acc@20: 75.28%	acc@30: 87.45%	
[2023-12-18 16:24:54] INFO (nni/MainThread) Intermediate result: 19.103796235244385  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.787 | lsd:0.641 | ed:0.94 | hr@1:0.654 | hr@2:0.871 | hr@3:0.915 | acc@1:0.654 | acc@2:0.6 | acc@3:0.567 | Best krc: 0.782 | Best epoch: 7
best model saved
[2023-12-18 16:25:20] INFO (nni/MainThread) Intermediate result: 0.7868543903261875  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.93	mae: 14.59	mape: 103.34%	acc@10: 44.36%	acc@20: 74.9%	acc@30: 88.19%	
[2023-12-18 16:25:20] INFO (nni/MainThread) Intermediate result: 18.93218291497644  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.663 | ed:0.969 | hr@1:0.654 | hr@2:0.87 | hr@3:0.916 | acc@1:0.654 | acc@2:0.596 | acc@3:0.563 | Best krc: 0.787 | Best epoch: 8
[2023-12-18 16:25:46] INFO (nni/MainThread) Intermediate result: 0.7804922325079736  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.59	mae: 14.37	mape: 102.02%	acc@10: 44.7%	acc@20: 75.41%	acc@30: 88.81%	
[2023-12-18 16:25:46] INFO (nni/MainThread) Intermediate result: 18.58801676285874  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.786 | lsd:0.633 | ed:0.955 | hr@1:0.657 | hr@2:0.87 | hr@3:0.917 | acc@1:0.657 | acc@2:0.6 | acc@3:0.566 | Best krc: 0.787 | Best epoch: 8
[2023-12-18 16:26:11] INFO (nni/MainThread) Intermediate result: 0.7859925557608112  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 18.37	mae: 14.24	mape: 101.57%	acc@10: 44.85%	acc@20: 75.82%	acc@30: 89.06%	
[2023-12-18 16:26:11] INFO (nni/MainThread) Intermediate result: 18.374540989790294  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.793 | lsd:0.618 | ed:0.912 | hr@1:0.666 | hr@2:0.873 | hr@3:0.918 | acc@1:0.666 | acc@2:0.61 | acc@3:0.578 | Best krc: 0.787 | Best epoch: 8
best model saved
[2023-12-18 16:26:38] INFO (nni/MainThread) Intermediate result: 0.7931371130933876  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 18.19	mae: 14.11	mape: 101.17%	acc@10: 45.0%	acc@20: 76.17%	acc@30: 89.29%	
[2023-12-18 16:26:38] INFO (nni/MainThread) Intermediate result: 18.192457157783764  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.658 | ed:0.98 | hr@1:0.654 | hr@2:0.869 | hr@3:0.913 | acc@1:0.654 | acc@2:0.595 | acc@3:0.558 | Best krc: 0.793 | Best epoch: 11
[2023-12-18 16:27:03] INFO (nni/MainThread) Intermediate result: 0.7754845313393629  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 18.01	mae: 14.03	mape: 100.86%	acc@10: 44.9%	acc@20: 76.24%	acc@30: 89.74%	
[2023-12-18 16:27:03] INFO (nni/MainThread) Intermediate result: 18.009785379179434  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.694 | ed:1.014 | hr@1:0.646 | hr@2:0.865 | hr@3:0.907 | acc@1:0.646 | acc@2:0.586 | acc@3:0.546 | Best krc: 0.793 | Best epoch: 11
[2023-12-18 16:27:29] INFO (nni/MainThread) Intermediate result: 0.7687873308249348  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.81	mae: 13.88	mape: 99.94%	acc@10: 45.42%	acc@20: 76.69%	acc@30: 90.05%	
[2023-12-18 16:27:29] INFO (nni/MainThread) Intermediate result: 17.814719304271705  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.669 | ed:1.014 | hr@1:0.64 | hr@2:0.863 | hr@3:0.907 | acc@1:0.64 | acc@2:0.578 | acc@3:0.539 | Best krc: 0.793 | Best epoch: 11
[2023-12-18 16:27:54] INFO (nni/MainThread) Intermediate result: 0.7691276696873548  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.68	mae: 13.8	mape: 99.39%	acc@10: 45.53%	acc@20: 76.96%	acc@30: 90.25%	
[2023-12-18 16:27:54] INFO (nni/MainThread) Intermediate result: 17.68130492066495  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.673 | ed:0.986 | hr@1:0.651 | hr@2:0.865 | hr@3:0.91 | acc@1:0.651 | acc@2:0.589 | acc@3:0.545 | Best krc: 0.793 | Best epoch: 11
[2023-12-18 16:28:20] INFO (nni/MainThread) Intermediate result: 0.7711746479564582  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 17.73	mae: 13.88	mape: 100.34%	acc@10: 44.95%	acc@20: 76.64%	acc@30: 90.21%	
[2023-12-18 16:28:20] INFO (nni/MainThread) Intermediate result: 17.725763067170767  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.757 | lsd:0.702 | ed:1.037 | hr@1:0.62 | hr@2:0.859 | hr@3:0.907 | acc@1:0.62 | acc@2:0.559 | acc@3:0.521 | Best krc: 0.793 | Best epoch: 11
[2023-12-18 16:28:46] INFO (nni/MainThread) Intermediate result: 0.7571480601213875  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 17.64	mae: 13.81	mape: 99.84%	acc@10: 45.23%	acc@20: 76.99%	acc@30: 90.26%	
[2023-12-18 16:28:46] INFO (nni/MainThread) Intermediate result: 17.637562739720167  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.671 | ed:0.994 | hr@1:0.648 | hr@2:0.864 | hr@3:0.911 | acc@1:0.648 | acc@2:0.585 | acc@3:0.542 | Best krc: 0.793 | Best epoch: 11
[2023-12-18 16:29:11] INFO (nni/MainThread) Intermediate result: 0.7695717523177077  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 17.44	mae: 13.68	mape: 98.67%	acc@10: 45.6%	acc@20: 77.45%	acc@30: 90.64%	
[2023-12-18 16:29:11] INFO (nni/MainThread) Intermediate result: 17.444973776108935  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.672 | ed:1.002 | hr@1:0.633 | hr@2:0.87 | hr@3:0.912 | acc@1:0.633 | acc@2:0.582 | acc@3:0.544 | Best krc: 0.793 | Best epoch: 11
[2023-12-18 16:29:37] INFO (nni/MainThread) Intermediate result: 0.768430783131264  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 17.3	mae: 13.59	mape: 98.05%	acc@10: 45.87%	acc@20: 77.74%	acc@30: 90.88%	
[2023-12-18 16:29:37] INFO (nni/MainThread) Intermediate result: 17.303599495016638  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.66 | ed:0.945 | hr@1:0.653 | hr@2:0.871 | hr@3:0.916 | acc@1:0.653 | acc@2:0.599 | acc@3:0.565 | Best krc: 0.793 | Best epoch: 11
[2023-12-18 16:30:02] INFO (nni/MainThread) Intermediate result: 0.7822943708383149  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 17.16	mae: 13.48	mape: 97.13%	acc@10: 46.13%	acc@20: 78.07%	acc@30: 91.13%	
[2023-12-18 16:30:02] INFO (nni/MainThread) Intermediate result: 17.159876797394652  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.784 | lsd:0.64 | ed:0.949 | hr@1:0.653 | hr@2:0.87 | hr@3:0.915 | acc@1:0.653 | acc@2:0.596 | acc@3:0.559 | Best krc: 0.793 | Best epoch: 11
[2023-12-18 16:30:28] INFO (nni/MainThread) Intermediate result: 0.7837801444535157  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 17.06	mae: 13.41	mape: 96.48%	acc@10: 46.31%	acc@20: 78.32%	acc@30: 91.27%	
[2023-12-18 16:30:28] INFO (nni/MainThread) Intermediate result: 17.05799899843785  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.711 | ed:1.025 | hr@1:0.632 | hr@2:0.862 | hr@3:0.905 | acc@1:0.632 | acc@2:0.578 | acc@3:0.533 | Best krc: 0.793 | Best epoch: 11
[2023-12-18 16:30:55] INFO (nni/MainThread) Intermediate result: 0.7646444954096902  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.96	mae: 13.35	mape: 96.03%	acc@10: 46.43%	acc@20: 78.47%	acc@30: 91.48%	
[2023-12-18 16:30:55] INFO (nni/MainThread) Intermediate result: 16.956387148426973  (Index 43)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702912888.73940441702912888.7394197
best model loaded !!!
krc:0.787 | lsd:0.456 | ed:0.934 | hr@1:0.671 | hr@2:0.907 | hr@3:0.941 | acc@1:0.671 | acc@2:0.618 | acc@3:0.574 |

-------------------------------------------------------------
Best epoch for G2R:  11
Best epoch for ETPA:  21
graph2route_pd Evaluation in test: krc:0.787 | lsd:0.456 | ed:0.934 | hr@1:0.671 | hr@2:0.907 | hr@3:0.941 | acc@1:0.671 | acc@2:0.618 | acc@3:0.574 |
RankPETA Evaluation in test: rmse: 11.83	mae: 8.94	mape: 65.32%	acc@10: 64.56%	acc@20: 92.41%	acc@30: 97.47%	
