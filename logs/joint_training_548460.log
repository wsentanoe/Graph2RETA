Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 9999,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.579 | lsd:1.436 | ed:1.528 | hr@1:0.58 | hr@2:0.712 | hr@3:0.823 | acc@1:0.58 | acc@2:0.425 | acc@3:0.394 | Best krc: -1 | Best epoch: -1
best model saved
[2024-01-10 10:54:53] INFO (nni/MainThread) Intermediate result: 0.5787757397989143  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 23.37	mae: 17.29	mape: 104.89%	acc@10: 40.37%	acc@20: 70.0%	acc@30: 83.7%	
[2024-01-10 10:54:53] INFO (nni/MainThread) Intermediate result: 23.365105641128476  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.707 | lsd:0.925 | ed:1.202 | hr@1:0.631 | hr@2:0.815 | hr@3:0.882 | acc@1:0.631 | acc@2:0.525 | acc@3:0.485 | Best krc: 0.579 | Best epoch: 0
best model saved
[2024-01-10 10:56:45] INFO (nni/MainThread) Intermediate result: 0.707069023544756  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 22.58	mae: 16.62	mape: 105.78%	acc@10: 43.33%	acc@20: 71.3%	acc@30: 82.78%	
[2024-01-10 10:56:45] INFO (nni/MainThread) Intermediate result: 22.576330176045705  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.746 | lsd:0.778 | ed:1.066 | hr@1:0.647 | hr@2:0.844 | hr@3:0.9 | acc@1:0.647 | acc@2:0.572 | acc@3:0.53 | Best krc: 0.707 | Best epoch: 1
best model saved
[2024-01-10 10:58:35] INFO (nni/MainThread) Intermediate result: 0.7460549979745433  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 21.86	mae: 16.03	mape: 103.63%	acc@10: 46.3%	acc@20: 71.98%	acc@30: 83.09%	
[2024-01-10 10:58:35] INFO (nni/MainThread) Intermediate result: 21.861144601847563  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.729 | ed:1.036 | hr@1:0.655 | hr@2:0.855 | hr@3:0.907 | acc@1:0.655 | acc@2:0.579 | acc@3:0.54 | Best krc: 0.746 | Best epoch: 2
best model saved
[2024-01-10 11:00:26] INFO (nni/MainThread) Intermediate result: 0.7611008548043967  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 21.43	mae: 15.95	mape: 107.26%	acc@10: 44.91%	acc@20: 72.41%	acc@30: 83.98%	
[2024-01-10 11:00:26] INFO (nni/MainThread) Intermediate result: 21.42990524506685  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.787 | lsd:0.678 | ed:0.982 | hr@1:0.687 | hr@2:0.858 | hr@3:0.914 | acc@1:0.687 | acc@2:0.606 | acc@3:0.573 | Best krc: 0.761 | Best epoch: 3
best model saved
[2024-01-10 11:02:17] INFO (nni/MainThread) Intermediate result: 0.7867884102164819  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 20.56	mae: 15.4	mape: 104.66%	acc@10: 45.7%	acc@20: 73.26%	acc@30: 85.19%	
[2024-01-10 11:02:17] INFO (nni/MainThread) Intermediate result: 20.56395223641733  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.793 | lsd:0.644 | ed:0.943 | hr@1:0.682 | hr@2:0.869 | hr@3:0.918 | acc@1:0.682 | acc@2:0.612 | acc@3:0.582 | Best krc: 0.787 | Best epoch: 4
best model saved
[2024-01-10 11:04:08] INFO (nni/MainThread) Intermediate result: 0.7926131880395105  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 19.8	mae: 14.87	mape: 102.23%	acc@10: 46.36%	acc@20: 74.38%	acc@30: 86.48%	
[2024-01-10 11:04:08] INFO (nni/MainThread) Intermediate result: 19.79512320435484  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.806 | lsd:0.614 | ed:0.902 | hr@1:0.725 | hr@2:0.87 | hr@3:0.918 | acc@1:0.725 | acc@2:0.644 | acc@3:0.605 | Best krc: 0.793 | Best epoch: 5
best model saved
[2024-01-10 11:05:59] INFO (nni/MainThread) Intermediate result: 0.8061784823219015  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 19.51	mae: 14.83	mape: 103.59%	acc@10: 45.13%	acc@20: 74.18%	acc@30: 87.04%	
[2024-01-10 11:05:59] INFO (nni/MainThread) Intermediate result: 19.506340886130943  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.756 | lsd:0.705 | ed:1.031 | hr@1:0.645 | hr@2:0.862 | hr@3:0.909 | acc@1:0.645 | acc@2:0.581 | acc@3:0.538 | Best krc: 0.806 | Best epoch: 6
[2024-01-10 11:07:49] INFO (nni/MainThread) Intermediate result: 0.7559035073333279  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.09	mae: 14.59	mape: 102.7%	acc@10: 45.28%	acc@20: 74.77%	acc@30: 87.92%	
[2024-01-10 11:07:49] INFO (nni/MainThread) Intermediate result: 19.088669954014787  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.802 | lsd:0.627 | ed:0.901 | hr@1:0.7 | hr@2:0.871 | hr@3:0.917 | acc@1:0.7 | acc@2:0.631 | acc@3:0.593 | Best krc: 0.806 | Best epoch: 6
[2024-01-10 11:09:39] INFO (nni/MainThread) Intermediate result: 0.8016206731291995  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.6	mae: 14.27	mape: 101.03%	acc@10: 45.72%	acc@20: 75.47%	acc@30: 88.85%	
[2024-01-10 11:09:39] INFO (nni/MainThread) Intermediate result: 18.6043781856678  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.812 | lsd:0.607 | ed:0.884 | hr@1:0.723 | hr@2:0.874 | hr@3:0.92 | acc@1:0.723 | acc@2:0.649 | acc@3:0.613 | Best krc: 0.806 | Best epoch: 6
best model saved
[2024-01-10 11:11:31] INFO (nni/MainThread) Intermediate result: 0.81184819067635  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.19	mae: 13.95	mape: 99.1%	acc@10: 46.67%	acc@20: 76.3%	acc@30: 89.41%	
[2024-01-10 11:11:31] INFO (nni/MainThread) Intermediate result: 18.1901663242194  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.579 | ed:0.879 | hr@1:0.711 | hr@2:0.88 | hr@3:0.921 | acc@1:0.711 | acc@2:0.644 | acc@3:0.605 | Best krc: 0.812 | Best epoch: 9
[2024-01-10 11:13:22] INFO (nni/MainThread) Intermediate result: 0.8084013804783371  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 17.9	mae: 13.74	mape: 97.73%	acc@10: 47.17%	acc@20: 76.9%	acc@30: 89.8%	
[2024-01-10 11:13:22] INFO (nni/MainThread) Intermediate result: 17.90127517465964  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.809 | lsd:0.624 | ed:0.89 | hr@1:0.719 | hr@2:0.869 | hr@3:0.923 | acc@1:0.719 | acc@2:0.64 | acc@3:0.607 | Best krc: 0.812 | Best epoch: 9
[2024-01-10 11:15:12] INFO (nni/MainThread) Intermediate result: 0.8086056274775123  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.64	mae: 13.55	mape: 96.13%	acc@10: 47.78%	acc@20: 77.38%	acc@30: 90.19%	
[2024-01-10 11:15:12] INFO (nni/MainThread) Intermediate result: 17.64368807146448  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.81 | lsd:0.605 | ed:0.887 | hr@1:0.715 | hr@2:0.87 | hr@3:0.919 | acc@1:0.715 | acc@2:0.643 | acc@3:0.606 | Best krc: 0.812 | Best epoch: 9
[2024-01-10 11:17:02] INFO (nni/MainThread) Intermediate result: 0.8096204648806311  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.42	mae: 13.42	mape: 95.37%	acc@10: 48.06%	acc@20: 77.86%	acc@30: 90.6%	
[2024-01-10 11:17:02] INFO (nni/MainThread) Intermediate result: 17.415650686675605  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.809 | lsd:0.619 | ed:0.882 | hr@1:0.728 | hr@2:0.868 | hr@3:0.921 | acc@1:0.728 | acc@2:0.647 | acc@3:0.612 | Best krc: 0.812 | Best epoch: 9
[2024-01-10 11:18:52] INFO (nni/MainThread) Intermediate result: 0.8090590411709782  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.32	mae: 13.36	mape: 95.3%	acc@10: 48.2%	acc@20: 77.99%	acc@30: 90.61%	
[2024-01-10 11:18:52] INFO (nni/MainThread) Intermediate result: 17.322673708807006  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.796 | lsd:0.642 | ed:0.933 | hr@1:0.702 | hr@2:0.861 | hr@3:0.915 | acc@1:0.702 | acc@2:0.622 | acc@3:0.585 | Best krc: 0.812 | Best epoch: 9
[2024-01-10 11:20:44] INFO (nni/MainThread) Intermediate result: 0.7963745600300037  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.17	mae: 13.26	mape: 94.64%	acc@10: 48.27%	acc@20: 78.27%	acc@30: 90.86%	
[2024-01-10 11:20:44] INFO (nni/MainThread) Intermediate result: 17.16734599197654  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.812 | lsd:0.624 | ed:0.882 | hr@1:0.727 | hr@2:0.864 | hr@3:0.919 | acc@1:0.727 | acc@2:0.638 | acc@3:0.606 | Best krc: 0.812 | Best epoch: 9
best model saved
[2024-01-10 11:22:36] INFO (nni/MainThread) Intermediate result: 0.8122018437278603  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 16.99	mae: 13.12	mape: 93.52%	acc@10: 48.77%	acc@20: 78.61%	acc@30: 91.09%	
[2024-01-10 11:22:36] INFO (nni/MainThread) Intermediate result: 16.990801262075664  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.819 | lsd:0.58 | ed:0.85 | hr@1:0.727 | hr@2:0.873 | hr@3:0.925 | acc@1:0.727 | acc@2:0.651 | acc@3:0.62 | Best krc: 0.812 | Best epoch: 15
best model saved
[2024-01-10 11:24:27] INFO (nni/MainThread) Intermediate result: 0.8188891860863876  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 16.93	mae: 13.07	mape: 93.09%	acc@10: 49.02%	acc@20: 78.74%	acc@30: 91.11%	
[2024-01-10 11:24:27] INFO (nni/MainThread) Intermediate result: 16.92957452843978  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.599 | ed:0.879 | hr@1:0.715 | hr@2:0.878 | hr@3:0.921 | acc@1:0.715 | acc@2:0.649 | acc@3:0.617 | Best krc: 0.819 | Best epoch: 16
[2024-01-10 11:26:18] INFO (nni/MainThread) Intermediate result: 0.8108672282874294  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 16.87	mae: 13.05	mape: 93.0%	acc@10: 48.99%	acc@20: 78.83%	acc@30: 91.26%	
[2024-01-10 11:26:18] INFO (nni/MainThread) Intermediate result: 16.86824073559708  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.814 | lsd:0.603 | ed:0.865 | hr@1:0.721 | hr@2:0.877 | hr@3:0.926 | acc@1:0.721 | acc@2:0.651 | acc@3:0.624 | Best krc: 0.819 | Best epoch: 16
[2024-01-10 11:28:08] INFO (nni/MainThread) Intermediate result: 0.8136576914801663  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.79	mae: 13.0	mape: 92.48%	acc@10: 49.14%	acc@20: 78.99%	acc@30: 91.38%	
[2024-01-10 11:28:08] INFO (nni/MainThread) Intermediate result: 16.786054266382898  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.816 | lsd:0.596 | ed:0.864 | hr@1:0.729 | hr@2:0.873 | hr@3:0.925 | acc@1:0.729 | acc@2:0.65 | acc@3:0.616 | Best krc: 0.819 | Best epoch: 16
[2024-01-10 11:29:59] INFO (nni/MainThread) Intermediate result: 0.8159101311003366  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.66	mae: 12.9	mape: 91.69%	acc@10: 49.41%	acc@20: 79.22%	acc@30: 91.57%	
[2024-01-10 11:29:59] INFO (nni/MainThread) Intermediate result: 16.658405204853008  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.603 | ed:0.898 | hr@1:0.722 | hr@2:0.873 | hr@3:0.924 | acc@1:0.722 | acc@2:0.64 | acc@3:0.605 | Best krc: 0.819 | Best epoch: 16
[2024-01-10 11:31:50] INFO (nni/MainThread) Intermediate result: 0.8079276263097863  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.53	mae: 12.8	mape: 90.66%	acc@10: 49.66%	acc@20: 79.45%	acc@30: 91.75%	
[2024-01-10 11:31:50] INFO (nni/MainThread) Intermediate result: 16.528835527261233  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.812 | lsd:0.593 | ed:0.885 | hr@1:0.724 | hr@2:0.873 | hr@3:0.923 | acc@1:0.724 | acc@2:0.647 | acc@3:0.61 | Best krc: 0.819 | Best epoch: 16
[2024-01-10 11:33:40] INFO (nni/MainThread) Intermediate result: 0.8118001210436715  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.42	mae: 12.73	mape: 90.14%	acc@10: 49.71%	acc@20: 79.68%	acc@30: 91.92%	
[2024-01-10 11:33:40] INFO (nni/MainThread) Intermediate result: 16.420242195005436  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.806 | lsd:0.602 | ed:0.888 | hr@1:0.72 | hr@2:0.873 | hr@3:0.922 | acc@1:0.72 | acc@2:0.641 | acc@3:0.603 | Best krc: 0.819 | Best epoch: 16
[2024-01-10 11:35:31] INFO (nni/MainThread) Intermediate result: 0.8060767524431712  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.31	mae: 12.64	mape: 89.22%	acc@10: 50.02%	acc@20: 79.9%	acc@30: 92.06%	
[2024-01-10 11:35:31] INFO (nni/MainThread) Intermediate result: 16.31018681130947  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.817 | lsd:0.607 | ed:0.865 | hr@1:0.735 | hr@2:0.87 | hr@3:0.923 | acc@1:0.735 | acc@2:0.654 | acc@3:0.62 | Best krc: 0.819 | Best epoch: 16
[2024-01-10 11:37:21] INFO (nni/MainThread) Intermediate result: 0.8173448346338594  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 16.24	mae: 12.6	mape: 88.88%	acc@10: 50.05%	acc@20: 80.05%	acc@30: 92.21%	
[2024-01-10 11:37:21] INFO (nni/MainThread) Intermediate result: 16.242977019639444  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.817 | lsd:0.573 | ed:0.857 | hr@1:0.724 | hr@2:0.876 | hr@3:0.927 | acc@1:0.724 | acc@2:0.65 | acc@3:0.619 | Best krc: 0.819 | Best epoch: 16
[2024-01-10 11:39:12] INFO (nni/MainThread) Intermediate result: 0.8166624144936344  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 16.15	mae: 12.53	mape: 88.18%	acc@10: 50.19%	acc@20: 80.21%	acc@30: 92.34%	
[2024-01-10 11:39:12] INFO (nni/MainThread) Intermediate result: 16.15032157746344  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.816 | lsd:0.609 | ed:0.859 | hr@1:0.717 | hr@2:0.874 | hr@3:0.923 | acc@1:0.717 | acc@2:0.645 | acc@3:0.61 | Best krc: 0.819 | Best epoch: 16
[2024-01-10 11:41:03] INFO (nni/MainThread) Intermediate result: 0.8164646090925058  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 16.09	mae: 12.49	mape: 87.73%	acc@10: 50.26%	acc@20: 80.31%	acc@30: 92.45%	
[2024-01-10 11:41:03] INFO (nni/MainThread) Intermediate result: 16.086337522577296  (Index 51)
*** Epoch: 26 ***
-----------------G2R RESULT-------------------

val result: krc:0.814 | lsd:0.582 | ed:0.882 | hr@1:0.718 | hr@2:0.877 | hr@3:0.927 | acc@1:0.718 | acc@2:0.645 | acc@3:0.609 | Best krc: 0.819 | Best epoch: 16
[2024-01-10 11:42:53] INFO (nni/MainThread) Intermediate result: 0.8141875902523039  (Index 52)
-----------------ETPA RESULT-------------------
Epoch 26: Validation	rmse: 16.01	mae: 12.44	mape: 87.31%	acc@10: 50.34%	acc@20: 80.48%	acc@30: 92.57%	
[2024-01-10 11:42:53] INFO (nni/MainThread) Intermediate result: 16.010052769132976  (Index 53)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1704880383.0125791704880383.0125923
best model loaded !!!
krc:0.809 | lsd:0.44 | ed:0.892 | hr@1:0.722 | hr@2:0.903 | hr@3:0.945 | acc@1:0.722 | acc@2:0.652 | acc@3:0.607 |

-------------------------------------------------------------
Best epoch for G2R:  16
Best epoch for ETPA:  26
graph2route_pd Evaluation in test: krc:0.809 | lsd:0.44 | ed:0.892 | hr@1:0.722 | hr@2:0.903 | hr@3:0.945 | acc@1:0.722 | acc@2:0.652 | acc@3:0.607 |
RankPETA Evaluation in test: rmse: 13.02	mae: 10.39	mape: 89.74%	acc@10: 54.01%	acc@20: 87.76%	acc@30: 97.05%	
