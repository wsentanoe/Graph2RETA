Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 100,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 1999,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.719 | lsd:0.855 | ed:1.139 | hr@1:0.616 | hr@2:0.836 | hr@3:0.886 | acc@1:0.616 | acc@2:0.544 | acc@3:0.487 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-05 17:15:03] INFO (nni/MainThread) Intermediate result: 0.7192578339408248  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 26.65	mae: 21.03	mape: 66.92%	acc@10: 29.63%	acc@20: 55.19%	acc@30: 76.67%	
[2023-12-05 17:15:03] INFO (nni/MainThread) Intermediate result: 26.646626889896872  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.752 | lsd:0.716 | ed:1.057 | hr@1:0.618 | hr@2:0.859 | hr@3:0.903 | acc@1:0.618 | acc@2:0.557 | acc@3:0.52 | Best krc: 0.719 | Best epoch: 0
best model saved
[2023-12-05 17:15:28] INFO (nni/MainThread) Intermediate result: 0.7517538598343144  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 25.09	mae: 20.08	mape: 106.69%	acc@10: 31.11%	acc@20: 56.11%	acc@30: 77.41%	
[2023-12-05 17:15:28] INFO (nni/MainThread) Intermediate result: 25.088865818562265  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.75 | lsd:0.73 | ed:1.049 | hr@1:0.627 | hr@2:0.851 | hr@3:0.898 | acc@1:0.627 | acc@2:0.56 | acc@3:0.518 | Best krc: 0.752 | Best epoch: 1
[2023-12-05 17:15:52] INFO (nni/MainThread) Intermediate result: 0.7503741777987515  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 24.26	mae: 19.62	mape: 119.92%	acc@10: 29.88%	acc@20: 57.9%	acc@30: 79.26%	
[2023-12-05 17:15:52] INFO (nni/MainThread) Intermediate result: 24.257583981029715  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.748 | lsd:0.76 | ed:1.069 | hr@1:0.631 | hr@2:0.855 | hr@3:0.899 | acc@1:0.631 | acc@2:0.567 | acc@3:0.518 | Best krc: 0.752 | Best epoch: 1
[2023-12-05 17:16:15] INFO (nni/MainThread) Intermediate result: 0.7476239671517327  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 23.75	mae: 19.11	mape: 124.02%	acc@10: 30.74%	acc@20: 60.09%	acc@30: 80.74%	
[2023-12-05 17:16:15] INFO (nni/MainThread) Intermediate result: 23.74593335267136  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.674 | ed:1.019 | hr@1:0.633 | hr@2:0.864 | hr@3:0.911 | acc@1:0.633 | acc@2:0.572 | acc@3:0.533 | Best krc: 0.752 | Best epoch: 1
best model saved
[2023-12-05 17:16:42] INFO (nni/MainThread) Intermediate result: 0.7661648494180194  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 23.59	mae: 18.74	mape: 126.12%	acc@10: 31.63%	acc@20: 61.85%	acc@30: 81.7%	
[2023-12-05 17:16:42] INFO (nni/MainThread) Intermediate result: 23.594499774256516  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.667 | ed:0.995 | hr@1:0.637 | hr@2:0.858 | hr@3:0.908 | acc@1:0.637 | acc@2:0.577 | acc@3:0.539 | Best krc: 0.766 | Best epoch: 4
best model saved
[2023-12-05 17:17:08] INFO (nni/MainThread) Intermediate result: 0.7704490515072063  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 23.0	mae: 18.26	mape: 125.99%	acc@10: 32.16%	acc@20: 63.64%	acc@30: 82.78%	
[2023-12-05 17:17:08] INFO (nni/MainThread) Intermediate result: 23.000281499246675  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.696 | ed:1.022 | hr@1:0.625 | hr@2:0.847 | hr@3:0.9 | acc@1:0.625 | acc@2:0.565 | acc@3:0.523 | Best krc: 0.77 | Best epoch: 5
[2023-12-05 17:17:31] INFO (nni/MainThread) Intermediate result: 0.7628620944230914  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 21.97	mae: 17.44	mape: 121.15%	acc@10: 34.44%	acc@20: 65.71%	acc@30: 84.6%	
[2023-12-05 17:17:32] INFO (nni/MainThread) Intermediate result: 21.973710794290874  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.708 | ed:1.001 | hr@1:0.633 | hr@2:0.856 | hr@3:0.908 | acc@1:0.633 | acc@2:0.576 | acc@3:0.542 | Best krc: 0.77 | Best epoch: 5
[2023-12-05 17:17:56] INFO (nni/MainThread) Intermediate result: 0.762791787881425  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 21.3	mae: 16.82	mape: 117.01%	acc@10: 36.76%	acc@20: 67.18%	acc@30: 85.74%	
[2023-12-05 17:17:56] INFO (nni/MainThread) Intermediate result: 21.30428346027149  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.671 | ed:1.013 | hr@1:0.635 | hr@2:0.866 | hr@3:0.908 | acc@1:0.635 | acc@2:0.578 | acc@3:0.538 | Best krc: 0.77 | Best epoch: 5
best model saved
[2023-12-05 17:18:21] INFO (nni/MainThread) Intermediate result: 0.7715647587444702  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 20.71	mae: 16.35	mape: 114.49%	acc@10: 37.94%	acc@20: 68.23%	acc@30: 86.71%	
[2023-12-05 17:18:21] INFO (nni/MainThread) Intermediate result: 20.713087110057334  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.698 | ed:0.988 | hr@1:0.638 | hr@2:0.861 | hr@3:0.908 | acc@1:0.638 | acc@2:0.582 | acc@3:0.548 | Best krc: 0.772 | Best epoch: 8
best model saved
[2023-12-05 17:18:47] INFO (nni/MainThread) Intermediate result: 0.7718393611441273  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 20.15	mae: 15.9	mape: 111.46%	acc@10: 39.3%	acc@20: 69.59%	acc@30: 87.63%	
[2023-12-05 17:18:47] INFO (nni/MainThread) Intermediate result: 20.145295292643556  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.699 | ed:0.997 | hr@1:0.639 | hr@2:0.862 | hr@3:0.909 | acc@1:0.639 | acc@2:0.58 | acc@3:0.544 | Best krc: 0.772 | Best epoch: 9
[2023-12-05 17:19:12] INFO (nni/MainThread) Intermediate result: 0.7656749126272518  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 19.67	mae: 15.52	mape: 108.77%	acc@10: 40.57%	acc@20: 70.81%	acc@30: 88.38%	
[2023-12-05 17:19:12] INFO (nni/MainThread) Intermediate result: 19.66965235796464  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.749 | lsd:0.752 | ed:1.057 | hr@1:0.625 | hr@2:0.854 | hr@3:0.897 | acc@1:0.625 | acc@2:0.563 | acc@3:0.517 | Best krc: 0.772 | Best epoch: 9
[2023-12-05 17:19:37] INFO (nni/MainThread) Intermediate result: 0.7489790188434701  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 19.26	mae: 15.2	mape: 106.78%	acc@10: 41.45%	acc@20: 71.91%	acc@30: 89.01%	
[2023-12-05 17:19:37] INFO (nni/MainThread) Intermediate result: 19.25866145412095  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.676 | ed:0.983 | hr@1:0.642 | hr@2:0.865 | hr@3:0.909 | acc@1:0.642 | acc@2:0.585 | acc@3:0.546 | Best krc: 0.772 | Best epoch: 9
[2023-12-05 17:20:03] INFO (nni/MainThread) Intermediate result: 0.7701445080369436  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 18.86	mae: 14.88	mape: 104.3%	acc@10: 42.56%	acc@20: 72.91%	acc@30: 89.66%	
[2023-12-05 17:20:03] INFO (nni/MainThread) Intermediate result: 18.856288045375074  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.668 | ed:0.99 | hr@1:0.646 | hr@2:0.863 | hr@3:0.909 | acc@1:0.646 | acc@2:0.584 | acc@3:0.54 | Best krc: 0.772 | Best epoch: 9
[2023-12-05 17:20:27] INFO (nni/MainThread) Intermediate result: 0.769519246239841  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 18.55	mae: 14.63	mape: 102.78%	acc@10: 43.31%	acc@20: 73.54%	acc@30: 90.16%	
[2023-12-05 17:20:27] INFO (nni/MainThread) Intermediate result: 18.55159562271446  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.67 | ed:0.986 | hr@1:0.644 | hr@2:0.863 | hr@3:0.911 | acc@1:0.644 | acc@2:0.585 | acc@3:0.547 | Best krc: 0.772 | Best epoch: 9
best model saved
[2023-12-05 17:20:52] INFO (nni/MainThread) Intermediate result: 0.7735620437150825  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 18.34	mae: 14.49	mape: 102.22%	acc@10: 43.41%	acc@20: 73.9%	acc@30: 90.49%	
[2023-12-05 17:20:52] INFO (nni/MainThread) Intermediate result: 18.34283458265258  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.66 | ed:0.976 | hr@1:0.647 | hr@2:0.864 | hr@3:0.913 | acc@1:0.647 | acc@2:0.584 | acc@3:0.548 | Best krc: 0.774 | Best epoch: 14
best model saved
[2023-12-05 17:21:19] INFO (nni/MainThread) Intermediate result: 0.7750847678613312  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 18.12	mae: 14.31	mape: 101.13%	acc@10: 43.94%	acc@20: 74.42%	acc@30: 90.81%	
[2023-12-05 17:21:19] INFO (nni/MainThread) Intermediate result: 18.11801975160724  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.662 | ed:0.981 | hr@1:0.639 | hr@2:0.861 | hr@3:0.912 | acc@1:0.639 | acc@2:0.575 | acc@3:0.54 | Best krc: 0.775 | Best epoch: 15
[2023-12-05 17:21:44] INFO (nni/MainThread) Intermediate result: 0.7722543197138738  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 17.87	mae: 14.11	mape: 99.68%	acc@10: 44.64%	acc@20: 74.99%	acc@30: 91.13%	
[2023-12-05 17:21:44] INFO (nni/MainThread) Intermediate result: 17.866252533713286  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.673 | ed:0.971 | hr@1:0.641 | hr@2:0.858 | hr@3:0.909 | acc@1:0.641 | acc@2:0.582 | acc@3:0.548 | Best krc: 0.775 | Best epoch: 15
[2023-12-05 17:22:08] INFO (nni/MainThread) Intermediate result: 0.7724250375933804  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 17.68	mae: 13.96	mape: 98.8%	acc@10: 45.1%	acc@20: 75.43%	acc@30: 91.44%	
[2023-12-05 17:22:08] INFO (nni/MainThread) Intermediate result: 17.676898669590532  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.689 | ed:0.993 | hr@1:0.642 | hr@2:0.863 | hr@3:0.91 | acc@1:0.642 | acc@2:0.584 | acc@3:0.549 | Best krc: 0.775 | Best epoch: 15
[2023-12-05 17:22:35] INFO (nni/MainThread) Intermediate result: 0.7698879546015532  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 17.47	mae: 13.79	mape: 97.34%	acc@10: 45.73%	acc@20: 75.96%	acc@30: 91.72%	
[2023-12-05 17:22:35] INFO (nni/MainThread) Intermediate result: 17.465704729786083  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.687 | ed:0.994 | hr@1:0.642 | hr@2:0.862 | hr@3:0.908 | acc@1:0.642 | acc@2:0.583 | acc@3:0.545 | Best krc: 0.775 | Best epoch: 15
[2023-12-05 17:22:59] INFO (nni/MainThread) Intermediate result: 0.7689169464683238  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 17.28	mae: 13.63	mape: 95.92%	acc@10: 46.31%	acc@20: 76.44%	acc@30: 91.96%	
[2023-12-05 17:22:59] INFO (nni/MainThread) Intermediate result: 17.27919737333249  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.692 | ed:1.016 | hr@1:0.631 | hr@2:0.86 | hr@3:0.909 | acc@1:0.631 | acc@2:0.575 | acc@3:0.535 | Best krc: 0.775 | Best epoch: 15
[2023-12-05 17:23:23] INFO (nni/MainThread) Intermediate result: 0.7604643105036633  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 17.13	mae: 13.51	mape: 95.0%	acc@10: 46.77%	acc@20: 76.79%	acc@30: 92.15%	
[2023-12-05 17:23:23] INFO (nni/MainThread) Intermediate result: 17.132758124849843  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.715 | ed:1.032 | hr@1:0.62 | hr@2:0.857 | hr@3:0.904 | acc@1:0.62 | acc@2:0.564 | acc@3:0.523 | Best krc: 0.775 | Best epoch: 15
[2023-12-05 17:23:47] INFO (nni/MainThread) Intermediate result: 0.7586364653177071  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 17.04	mae: 13.44	mape: 94.77%	acc@10: 46.82%	acc@20: 76.97%	acc@30: 92.27%	
[2023-12-05 17:23:47] INFO (nni/MainThread) Intermediate result: 17.035373590824324  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.703 | ed:1.016 | hr@1:0.639 | hr@2:0.86 | hr@3:0.905 | acc@1:0.639 | acc@2:0.579 | acc@3:0.536 | Best krc: 0.775 | Best epoch: 15
[2023-12-05 17:24:11] INFO (nni/MainThread) Intermediate result: 0.7652402506884359  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.91	mae: 13.35	mape: 94.2%	acc@10: 47.0%	acc@20: 77.29%	acc@30: 92.43%	
[2023-12-05 17:24:11] INFO (nni/MainThread) Intermediate result: 16.914198131813073  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.67 | ed:0.973 | hr@1:0.643 | hr@2:0.864 | hr@3:0.913 | acc@1:0.643 | acc@2:0.585 | acc@3:0.554 | Best krc: 0.775 | Best epoch: 15
[2023-12-05 17:24:36] INFO (nni/MainThread) Intermediate result: 0.774940077493641  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 16.78	mae: 13.24	mape: 93.08%	acc@10: 47.47%	acc@20: 77.56%	acc@30: 92.58%	
[2023-12-05 17:24:36] INFO (nni/MainThread) Intermediate result: 16.78280446765871  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.69 | ed:1.017 | hr@1:0.632 | hr@2:0.861 | hr@3:0.908 | acc@1:0.632 | acc@2:0.568 | acc@3:0.531 | Best krc: 0.775 | Best epoch: 15
[2023-12-05 17:25:01] INFO (nni/MainThread) Intermediate result: 0.7625246074918134  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 16.67	mae: 13.14	mape: 92.29%	acc@10: 47.82%	acc@20: 77.84%	acc@30: 92.73%	
[2023-12-05 17:25:01] INFO (nni/MainThread) Intermediate result: 16.665323339912682  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.682 | ed:0.992 | hr@1:0.636 | hr@2:0.862 | hr@3:0.912 | acc@1:0.636 | acc@2:0.574 | acc@3:0.542 | Best krc: 0.775 | Best epoch: 15
[2023-12-05 17:25:27] INFO (nni/MainThread) Intermediate result: 0.7688372635639797  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 16.55	mae: 13.04	mape: 91.34%	acc@10: 48.26%	acc@20: 78.11%	acc@30: 92.83%	
[2023-12-05 17:25:27] INFO (nni/MainThread) Intermediate result: 16.55244468053606  (Index 51)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701792878.49788931701792878.4979024
best model loaded !!!
krc:0.767 | lsd:0.493 | ed:0.997 | hr@1:0.66 | hr@2:0.898 | hr@3:0.936 | acc@1:0.66 | acc@2:0.602 | acc@3:0.544 |

-------------------------------------------------------------
Best epoch for G2R:  15
Best epoch for ETPA:  25
graph2route_pd Evaluation in test: krc:0.767 | lsd:0.493 | ed:0.997 | hr@1:0.66 | hr@2:0.898 | hr@3:0.936 | acc@1:0.66 | acc@2:0.602 | acc@3:0.544 |
RankPETA Evaluation in test: rmse: 12.39	mae: 9.61	mape: 80.52%	acc@10: 59.49%	acc@20: 90.72%	acc@30: 97.47%	
