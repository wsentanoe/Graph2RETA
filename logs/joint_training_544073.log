Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 8888,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.742 | lsd:0.791 | ed:1.048 | hr@1:0.632 | hr@2:0.844 | hr@3:0.894 | acc@1:0.632 | acc@2:0.569 | acc@3:0.525 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-18 10:07:53] INFO (nni/MainThread) Intermediate result: 0.7423623816627752  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.6	mae: 18.94	mape: 65.57%	acc@10: 32.22%	acc@20: 62.22%	acc@30: 79.63%	
[2023-12-18 10:07:53] INFO (nni/MainThread) Intermediate result: 24.601748570271255  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.75 | lsd:0.749 | ed:1.033 | hr@1:0.627 | hr@2:0.853 | hr@3:0.902 | acc@1:0.627 | acc@2:0.574 | acc@3:0.528 | Best krc: 0.742 | Best epoch: 0
best model saved
[2023-12-18 10:09:29] INFO (nni/MainThread) Intermediate result: 0.7498107732038646  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 24.62	mae: 18.07	mape: 87.31%	acc@10: 36.85%	acc@20: 67.41%	acc@30: 81.11%	
[2023-12-18 10:09:29] INFO (nni/MainThread) Intermediate result: 24.61508624872387  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.727 | ed:1.023 | hr@1:0.63 | hr@2:0.853 | hr@3:0.905 | acc@1:0.63 | acc@2:0.566 | acc@3:0.525 | Best krc: 0.75 | Best epoch: 1
best model saved
[2023-12-18 10:11:05] INFO (nni/MainThread) Intermediate result: 0.759916204218784  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 23.57	mae: 17.33	mape: 95.92%	acc@10: 39.38%	acc@20: 69.38%	acc@30: 82.59%	
[2023-12-18 10:11:05] INFO (nni/MainThread) Intermediate result: 23.574293466166417  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.756 | lsd:0.742 | ed:1.029 | hr@1:0.634 | hr@2:0.854 | hr@3:0.903 | acc@1:0.634 | acc@2:0.572 | acc@3:0.528 | Best krc: 0.76 | Best epoch: 2
[2023-12-18 10:12:40] INFO (nni/MainThread) Intermediate result: 0.7555811731063153  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 22.62	mae: 16.92	mape: 101.09%	acc@10: 39.26%	acc@20: 69.54%	acc@30: 83.8%	
[2023-12-18 10:12:40] INFO (nni/MainThread) Intermediate result: 22.624872892098683  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.696 | ed:1.007 | hr@1:0.633 | hr@2:0.861 | hr@3:0.902 | acc@1:0.633 | acc@2:0.575 | acc@3:0.533 | Best krc: 0.76 | Best epoch: 2
best model saved
[2023-12-18 10:14:15] INFO (nni/MainThread) Intermediate result: 0.7635220039155324  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 21.52	mae: 16.34	mape: 101.69%	acc@10: 39.11%	acc@20: 70.44%	acc@30: 85.26%	
[2023-12-18 10:14:15] INFO (nni/MainThread) Intermediate result: 21.519745743801014  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.711 | ed:1.0 | hr@1:0.636 | hr@2:0.86 | hr@3:0.907 | acc@1:0.636 | acc@2:0.585 | acc@3:0.542 | Best krc: 0.764 | Best epoch: 4
[2023-12-18 10:15:50] INFO (nni/MainThread) Intermediate result: 0.7611696347507453  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 20.74	mae: 15.89	mape: 101.78%	acc@10: 39.94%	acc@20: 71.3%	acc@30: 86.6%	
[2023-12-18 10:15:50] INFO (nni/MainThread) Intermediate result: 20.743424082674146  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.701 | ed:1.001 | hr@1:0.634 | hr@2:0.859 | hr@3:0.907 | acc@1:0.634 | acc@2:0.579 | acc@3:0.534 | Best krc: 0.764 | Best epoch: 4
best model saved
[2023-12-18 10:17:27] INFO (nni/MainThread) Intermediate result: 0.7653780209005396  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 20.25	mae: 15.6	mape: 102.25%	acc@10: 40.11%	acc@20: 71.69%	acc@30: 87.2%	
[2023-12-18 10:17:27] INFO (nni/MainThread) Intermediate result: 20.246614201328637  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.69 | ed:1.006 | hr@1:0.638 | hr@2:0.863 | hr@3:0.906 | acc@1:0.638 | acc@2:0.581 | acc@3:0.539 | Best krc: 0.765 | Best epoch: 6
best model saved
[2023-12-18 10:19:05] INFO (nni/MainThread) Intermediate result: 0.7690834168665389  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.72	mae: 15.28	mape: 101.58%	acc@10: 40.56%	acc@20: 72.31%	acc@30: 88.15%	
[2023-12-18 10:19:05] INFO (nni/MainThread) Intermediate result: 19.7153042721572  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.657 | ed:0.972 | hr@1:0.661 | hr@2:0.865 | hr@3:0.912 | acc@1:0.661 | acc@2:0.602 | acc@3:0.563 | Best krc: 0.769 | Best epoch: 7
best model saved
[2023-12-18 10:20:42] INFO (nni/MainThread) Intermediate result: 0.7803900101582656  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 19.27	mae: 14.93	mape: 100.07%	acc@10: 41.73%	acc@20: 73.33%	acc@30: 88.77%	
[2023-12-18 10:20:42] INFO (nni/MainThread) Intermediate result: 19.27111842746852  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.792 | lsd:0.648 | ed:0.942 | hr@1:0.688 | hr@2:0.867 | hr@3:0.916 | acc@1:0.688 | acc@2:0.621 | acc@3:0.583 | Best krc: 0.78 | Best epoch: 8
best model saved
[2023-12-18 10:22:19] INFO (nni/MainThread) Intermediate result: 0.7923034648876364  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 19.01	mae: 14.76	mape: 99.66%	acc@10: 42.33%	acc@20: 73.7%	acc@30: 89.07%	
[2023-12-18 10:22:19] INFO (nni/MainThread) Intermediate result: 19.012938628718807  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.781 | lsd:0.663 | ed:0.964 | hr@1:0.656 | hr@2:0.865 | hr@3:0.909 | acc@1:0.656 | acc@2:0.599 | acc@3:0.563 | Best krc: 0.792 | Best epoch: 9
[2023-12-18 10:23:54] INFO (nni/MainThread) Intermediate result: 0.7805328438909549  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 18.58	mae: 14.44	mape: 97.47%	acc@10: 43.3%	acc@20: 74.68%	acc@30: 89.76%	
[2023-12-18 10:23:54] INFO (nni/MainThread) Intermediate result: 18.575551037272888  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.781 | lsd:0.663 | ed:0.962 | hr@1:0.665 | hr@2:0.866 | hr@3:0.912 | acc@1:0.665 | acc@2:0.605 | acc@3:0.566 | Best krc: 0.792 | Best epoch: 9
[2023-12-18 10:25:29] INFO (nni/MainThread) Intermediate result: 0.7808212199467118  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 18.23	mae: 14.17	mape: 95.71%	acc@10: 44.2%	acc@20: 75.34%	acc@30: 90.25%	
[2023-12-18 10:25:29] INFO (nni/MainThread) Intermediate result: 18.227657724442736  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.651 | ed:0.979 | hr@1:0.672 | hr@2:0.863 | hr@3:0.909 | acc@1:0.672 | acc@2:0.601 | acc@3:0.557 | Best krc: 0.792 | Best epoch: 9
[2023-12-18 10:27:05] INFO (nni/MainThread) Intermediate result: 0.7824152769933268  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 18.04	mae: 14.04	mape: 95.24%	acc@10: 44.42%	acc@20: 75.87%	acc@30: 90.48%	
[2023-12-18 10:27:05] INFO (nni/MainThread) Intermediate result: 18.03514908654918  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.79 | lsd:0.653 | ed:0.947 | hr@1:0.69 | hr@2:0.861 | hr@3:0.91 | acc@1:0.69 | acc@2:0.614 | acc@3:0.571 | Best krc: 0.792 | Best epoch: 9
[2023-12-18 10:28:41] INFO (nni/MainThread) Intermediate result: 0.7900779037639554  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.79	mae: 13.87	mape: 94.35%	acc@10: 45.03%	acc@20: 76.35%	acc@30: 90.87%	
[2023-12-18 10:28:41] INFO (nni/MainThread) Intermediate result: 17.791042414567073  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.788 | lsd:0.674 | ed:0.965 | hr@1:0.683 | hr@2:0.863 | hr@3:0.909 | acc@1:0.683 | acc@2:0.614 | acc@3:0.566 | Best krc: 0.792 | Best epoch: 9
[2023-12-18 10:30:16] INFO (nni/MainThread) Intermediate result: 0.7880984228163939  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.59	mae: 13.71	mape: 93.29%	acc@10: 45.48%	acc@20: 76.77%	acc@30: 91.16%	
[2023-12-18 10:30:16] INFO (nni/MainThread) Intermediate result: 17.59448926256745  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.79 | lsd:0.646 | ed:0.943 | hr@1:0.69 | hr@2:0.869 | hr@3:0.916 | acc@1:0.69 | acc@2:0.617 | acc@3:0.574 | Best krc: 0.792 | Best epoch: 9
[2023-12-18 10:31:50] INFO (nni/MainThread) Intermediate result: 0.7896508799788206  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 17.35	mae: 13.53	mape: 92.04%	acc@10: 46.2%	acc@20: 77.25%	acc@30: 91.46%	
[2023-12-18 10:31:50] INFO (nni/MainThread) Intermediate result: 17.35205852732516  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.666 | ed:0.996 | hr@1:0.655 | hr@2:0.865 | hr@3:0.911 | acc@1:0.655 | acc@2:0.593 | acc@3:0.55 | Best krc: 0.792 | Best epoch: 9
[2023-12-18 10:33:27] INFO (nni/MainThread) Intermediate result: 0.7766312393334693  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 17.19	mae: 13.41	mape: 91.2%	acc@10: 46.69%	acc@20: 77.58%	acc@30: 91.7%	
[2023-12-18 10:33:27] INFO (nni/MainThread) Intermediate result: 17.19122373506856  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.656 | ed:0.964 | hr@1:0.673 | hr@2:0.865 | hr@3:0.911 | acc@1:0.673 | acc@2:0.606 | acc@3:0.564 | Best krc: 0.792 | Best epoch: 9
[2023-12-18 10:35:03] INFO (nni/MainThread) Intermediate result: 0.7821461069821366  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 17.02	mae: 13.29	mape: 90.39%	acc@10: 47.06%	acc@20: 77.9%	acc@30: 91.93%	
[2023-12-18 10:35:03] INFO (nni/MainThread) Intermediate result: 17.019929553508987  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.785 | lsd:0.677 | ed:0.965 | hr@1:0.676 | hr@2:0.866 | hr@3:0.908 | acc@1:0.676 | acc@2:0.611 | acc@3:0.567 | Best krc: 0.792 | Best epoch: 9
[2023-12-18 10:36:38] INFO (nni/MainThread) Intermediate result: 0.7846536119470094  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.89	mae: 13.21	mape: 89.99%	acc@10: 47.13%	acc@20: 78.15%	acc@30: 92.12%	
[2023-12-18 10:36:38] INFO (nni/MainThread) Intermediate result: 16.89314923309264  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.786 | lsd:0.681 | ed:0.956 | hr@1:0.697 | hr@2:0.858 | hr@3:0.909 | acc@1:0.697 | acc@2:0.618 | acc@3:0.572 | Best krc: 0.792 | Best epoch: 9
[2023-12-18 10:38:14] INFO (nni/MainThread) Intermediate result: 0.7857229168991301  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.75	mae: 13.11	mape: 89.19%	acc@10: 47.52%	acc@20: 78.46%	acc@30: 92.28%	
[2023-12-18 10:38:14] INFO (nni/MainThread) Intermediate result: 16.75241975259882  (Index 39)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702890378.94169551702890378.94171
best model loaded !!!
krc:0.785 | lsd:0.491 | ed:0.95 | hr@1:0.692 | hr@2:0.899 | hr@3:0.935 | acc@1:0.692 | acc@2:0.633 | acc@3:0.579 |

-------------------------------------------------------------
Best epoch for G2R:  9
Best epoch for ETPA:  19
graph2route_pd Evaluation in test: krc:0.785 | lsd:0.491 | ed:0.95 | hr@1:0.692 | hr@2:0.899 | hr@3:0.935 | acc@1:0.692 | acc@2:0.633 | acc@3:0.579 |
RankPETA Evaluation in test: rmse: 12.9	mae: 9.85	mape: 83.35%	acc@10: 62.45%	acc@20: 88.19%	acc@30: 96.2%	
