Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 8888,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.738 | lsd:0.802 | ed:1.065 | hr@1:0.613 | hr@2:0.84 | hr@3:0.895 | acc@1:0.613 | acc@2:0.547 | acc@3:0.509 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-16 11:54:00] INFO (nni/MainThread) Intermediate result: 0.7378809265035763  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.65	mae: 18.97	mape: 65.08%	acc@10: 35.56%	acc@20: 62.22%	acc@30: 79.26%	
[2023-12-16 11:54:00] INFO (nni/MainThread) Intermediate result: 24.64908502517132  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.687 | ed:0.999 | hr@1:0.633 | hr@2:0.862 | hr@3:0.91 | acc@1:0.633 | acc@2:0.577 | acc@3:0.54 | Best krc: 0.738 | Best epoch: 0
best model saved
[2023-12-16 11:54:27] INFO (nni/MainThread) Intermediate result: 0.7629783955538217  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 24.9	mae: 18.33	mape: 88.75%	acc@10: 39.44%	acc@20: 66.11%	acc@30: 80.56%	
[2023-12-16 11:54:27] INFO (nni/MainThread) Intermediate result: 24.902581987256074  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.689 | ed:1.007 | hr@1:0.631 | hr@2:0.859 | hr@3:0.907 | acc@1:0.631 | acc@2:0.569 | acc@3:0.534 | Best krc: 0.763 | Best epoch: 1
best model saved
[2023-12-16 11:54:54] INFO (nni/MainThread) Intermediate result: 0.7663599196961679  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 23.42	mae: 17.34	mape: 94.88%	acc@10: 40.62%	acc@20: 68.4%	acc@30: 82.96%	
[2023-12-16 11:54:54] INFO (nni/MainThread) Intermediate result: 23.420101804420955  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.671 | ed:0.991 | hr@1:0.631 | hr@2:0.862 | hr@3:0.912 | acc@1:0.631 | acc@2:0.574 | acc@3:0.541 | Best krc: 0.766 | Best epoch: 2
best model saved
[2023-12-16 11:55:20] INFO (nni/MainThread) Intermediate result: 0.7706591748305783  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 22.23	mae: 16.7	mape: 97.81%	acc@10: 40.74%	acc@20: 69.63%	acc@30: 84.07%	
[2023-12-16 11:55:20] INFO (nni/MainThread) Intermediate result: 22.22583442328064  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.754 | lsd:0.724 | ed:1.031 | hr@1:0.621 | hr@2:0.856 | hr@3:0.903 | acc@1:0.621 | acc@2:0.567 | acc@3:0.526 | Best krc: 0.771 | Best epoch: 3
[2023-12-16 11:55:46] INFO (nni/MainThread) Intermediate result: 0.75443395937493  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 21.55	mae: 16.46	mape: 101.93%	acc@10: 39.85%	acc@20: 69.85%	acc@30: 85.11%	
[2023-12-16 11:55:46] INFO (nni/MainThread) Intermediate result: 21.547263303017573  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.661 | ed:0.988 | hr@1:0.633 | hr@2:0.866 | hr@3:0.912 | acc@1:0.633 | acc@2:0.577 | acc@3:0.541 | Best krc: 0.771 | Best epoch: 3
[2023-12-16 11:56:12] INFO (nni/MainThread) Intermediate result: 0.7686055614695755  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 20.89	mae: 16.1	mape: 102.6%	acc@10: 40.37%	acc@20: 70.74%	acc@30: 86.11%	
[2023-12-16 11:56:12] INFO (nni/MainThread) Intermediate result: 20.893233418843465  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.685 | ed:0.998 | hr@1:0.627 | hr@2:0.861 | hr@3:0.911 | acc@1:0.627 | acc@2:0.571 | acc@3:0.537 | Best krc: 0.771 | Best epoch: 3
[2023-12-16 11:56:38] INFO (nni/MainThread) Intermediate result: 0.7672024689427401  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 20.42	mae: 15.82	mape: 103.06%	acc@10: 40.37%	acc@20: 71.16%	acc@30: 86.83%	
[2023-12-16 11:56:38] INFO (nni/MainThread) Intermediate result: 20.417278445828433  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.708 | ed:1.024 | hr@1:0.636 | hr@2:0.856 | hr@3:0.907 | acc@1:0.636 | acc@2:0.573 | acc@3:0.531 | Best krc: 0.771 | Best epoch: 3
[2023-12-16 11:57:04] INFO (nni/MainThread) Intermediate result: 0.7603191719938549  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.64	mae: 15.25	mape: 100.12%	acc@10: 41.81%	acc@20: 72.69%	acc@30: 88.1%	
[2023-12-16 11:57:04] INFO (nni/MainThread) Intermediate result: 19.639376899912364  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.678 | ed:0.987 | hr@1:0.629 | hr@2:0.861 | hr@3:0.909 | acc@1:0.629 | acc@2:0.572 | acc@3:0.539 | Best krc: 0.771 | Best epoch: 3
[2023-12-16 11:57:30] INFO (nni/MainThread) Intermediate result: 0.7666656555156773  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.94	mae: 14.72	mape: 97.11%	acc@10: 43.33%	acc@20: 74.24%	acc@30: 89.09%	
[2023-12-16 11:57:30] INFO (nni/MainThread) Intermediate result: 18.944295302575526  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.695 | ed:1.0 | hr@1:0.634 | hr@2:0.864 | hr@3:0.904 | acc@1:0.634 | acc@2:0.58 | acc@3:0.538 | Best krc: 0.771 | Best epoch: 3
[2023-12-16 11:57:56] INFO (nni/MainThread) Intermediate result: 0.7631333870424382  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.39	mae: 14.31	mape: 94.95%	acc@10: 44.33%	acc@20: 75.56%	acc@30: 89.96%	
[2023-12-16 11:57:56] INFO (nni/MainThread) Intermediate result: 18.385042536258535  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.757 | lsd:0.705 | ed:1.027 | hr@1:0.622 | hr@2:0.861 | hr@3:0.902 | acc@1:0.622 | acc@2:0.568 | acc@3:0.526 | Best krc: 0.771 | Best epoch: 3
[2023-12-16 11:58:23] INFO (nni/MainThread) Intermediate result: 0.7569777094919203  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 17.98	mae: 14.03	mape: 93.41%	acc@10: 45.15%	acc@20: 76.43%	acc@30: 90.67%	
[2023-12-16 11:58:23] INFO (nni/MainThread) Intermediate result: 17.9800770290001  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.684 | ed:1.007 | hr@1:0.628 | hr@2:0.865 | hr@3:0.906 | acc@1:0.628 | acc@2:0.575 | acc@3:0.537 | Best krc: 0.771 | Best epoch: 3
[2023-12-16 11:58:50] INFO (nni/MainThread) Intermediate result: 0.766983020056916  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.59	mae: 13.74	mape: 91.92%	acc@10: 45.86%	acc@20: 77.31%	acc@30: 91.17%	
[2023-12-16 11:58:50] INFO (nni/MainThread) Intermediate result: 17.594274862860722  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.674 | ed:0.992 | hr@1:0.638 | hr@2:0.864 | hr@3:0.907 | acc@1:0.638 | acc@2:0.583 | acc@3:0.539 | Best krc: 0.771 | Best epoch: 3
[2023-12-16 11:59:16] INFO (nni/MainThread) Intermediate result: 0.7689053005974739  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.31	mae: 13.54	mape: 90.92%	acc@10: 46.38%	acc@20: 78.06%	acc@30: 91.62%	
[2023-12-16 11:59:16] INFO (nni/MainThread) Intermediate result: 17.30598374928638  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.699 | ed:1.005 | hr@1:0.632 | hr@2:0.861 | hr@3:0.906 | acc@1:0.632 | acc@2:0.579 | acc@3:0.538 | Best krc: 0.771 | Best epoch: 3
[2023-12-16 11:59:43] INFO (nni/MainThread) Intermediate result: 0.7644318835223951  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.12	mae: 13.41	mape: 90.48%	acc@10: 46.69%	acc@20: 78.57%	acc@30: 91.83%	
[2023-12-16 11:59:43] INFO (nni/MainThread) Intermediate result: 17.124053417348936  (Index 27)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702724013.3109981702724013.3110116
best model loaded !!!
krc:0.768 | lsd:0.494 | ed:0.994 | hr@1:0.65 | hr@2:0.9 | hr@3:0.937 | acc@1:0.65 | acc@2:0.597 | acc@3:0.548 |

-------------------------------------------------------------
Best epoch for G2R:  3
Best epoch for ETPA:  13
graph2route_pd Evaluation in test: krc:0.768 | lsd:0.494 | ed:0.994 | hr@1:0.65 | hr@2:0.9 | hr@3:0.937 | acc@1:0.65 | acc@2:0.597 | acc@3:0.548 |
RankPETA Evaluation in test: rmse: 14.14	mae: 10.89	mape: 97.24%	acc@10: 54.01%	acc@20: 87.34%	acc@30: 95.78%	
