Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 1000,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.75 | lsd:0.726 | ed:1.052 | hr@1:0.625 | hr@2:0.849 | hr@3:0.9 | acc@1:0.625 | acc@2:0.561 | acc@3:0.526 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-18 11:09:35] INFO (nni/MainThread) Intermediate result: 0.7497624628363587  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.4	mae: 19.21	mape: 72.63%	acc@10: 31.85%	acc@20: 59.63%	acc@30: 79.63%	
[2023-12-18 11:09:35] INFO (nni/MainThread) Intermediate result: 24.397471862895575  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.758 | lsd:0.714 | ed:1.044 | hr@1:0.626 | hr@2:0.859 | hr@3:0.907 | acc@1:0.626 | acc@2:0.566 | acc@3:0.532 | Best krc: 0.75 | Best epoch: 0
best model saved
[2023-12-18 11:10:02] INFO (nni/MainThread) Intermediate result: 0.7579435835666706  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 25.53	mae: 19.52	mape: 108.08%	acc@10: 32.59%	acc@20: 62.22%	acc@30: 80.37%	
[2023-12-18 11:10:02] INFO (nni/MainThread) Intermediate result: 25.527502035606677  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.758 | lsd:0.736 | ed:1.049 | hr@1:0.633 | hr@2:0.856 | hr@3:0.901 | acc@1:0.633 | acc@2:0.566 | acc@3:0.526 | Best krc: 0.758 | Best epoch: 1
best model saved
[2023-12-18 11:10:29] INFO (nni/MainThread) Intermediate result: 0.7584067570512697  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 23.87	mae: 18.45	mape: 111.96%	acc@10: 34.81%	acc@20: 64.44%	acc@30: 82.1%	
[2023-12-18 11:10:29] INFO (nni/MainThread) Intermediate result: 23.873267129263308  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.694 | ed:1.011 | hr@1:0.636 | hr@2:0.856 | hr@3:0.905 | acc@1:0.636 | acc@2:0.574 | acc@3:0.535 | Best krc: 0.758 | Best epoch: 2
best model saved
[2023-12-18 11:10:55] INFO (nni/MainThread) Intermediate result: 0.763117656768728  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 23.15	mae: 18.0	mape: 115.15%	acc@10: 35.46%	acc@20: 65.37%	acc@30: 83.24%	
[2023-12-18 11:10:55] INFO (nni/MainThread) Intermediate result: 23.14516488491543  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.693 | ed:0.999 | hr@1:0.643 | hr@2:0.862 | hr@3:0.907 | acc@1:0.643 | acc@2:0.579 | acc@3:0.539 | Best krc: 0.763 | Best epoch: 3
best model saved
[2023-12-18 11:11:22] INFO (nni/MainThread) Intermediate result: 0.7674005086073298  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 21.82	mae: 17.0	mape: 110.8%	acc@10: 37.78%	acc@20: 68.0%	acc@30: 85.04%	
[2023-12-18 11:11:22] INFO (nni/MainThread) Intermediate result: 21.821621430881724  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.687 | ed:1.023 | hr@1:0.639 | hr@2:0.858 | hr@3:0.907 | acc@1:0.639 | acc@2:0.574 | acc@3:0.531 | Best krc: 0.767 | Best epoch: 4
[2023-12-18 11:11:48] INFO (nni/MainThread) Intermediate result: 0.7629056703389892  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 20.87	mae: 16.35	mape: 108.42%	acc@10: 38.33%	acc@20: 69.32%	acc@30: 86.67%	
[2023-12-18 11:11:48] INFO (nni/MainThread) Intermediate result: 20.870988001857892  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.687 | ed:1.04 | hr@1:0.635 | hr@2:0.861 | hr@3:0.908 | acc@1:0.635 | acc@2:0.574 | acc@3:0.53 | Best krc: 0.767 | Best epoch: 4
[2023-12-18 11:12:14] INFO (nni/MainThread) Intermediate result: 0.7618366054745591  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 20.08	mae: 15.77	mape: 105.48%	acc@10: 39.52%	acc@20: 71.06%	acc@30: 87.72%	
[2023-12-18 11:12:14] INFO (nni/MainThread) Intermediate result: 20.078331639826633  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.75 | lsd:0.717 | ed:1.059 | hr@1:0.619 | hr@2:0.853 | hr@3:0.906 | acc@1:0.619 | acc@2:0.558 | acc@3:0.517 | Best krc: 0.767 | Best epoch: 4
[2023-12-18 11:12:39] INFO (nni/MainThread) Intermediate result: 0.7504475401195995  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.48	mae: 15.3	mape: 102.77%	acc@10: 40.93%	acc@20: 72.31%	acc@30: 88.56%	
[2023-12-18 11:12:40] INFO (nni/MainThread) Intermediate result: 19.478379312789098  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.722 | ed:1.014 | hr@1:0.628 | hr@2:0.863 | hr@3:0.905 | acc@1:0.628 | acc@2:0.578 | acc@3:0.537 | Best krc: 0.767 | Best epoch: 4
[2023-12-18 11:13:05] INFO (nni/MainThread) Intermediate result: 0.7630143899404943  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 19.01	mae: 14.92	mape: 100.77%	acc@10: 42.14%	acc@20: 73.37%	acc@30: 89.18%	
[2023-12-18 11:13:05] INFO (nni/MainThread) Intermediate result: 19.01397424996309  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.755 | lsd:0.734 | ed:1.034 | hr@1:0.622 | hr@2:0.857 | hr@3:0.902 | acc@1:0.622 | acc@2:0.566 | acc@3:0.529 | Best krc: 0.767 | Best epoch: 4
[2023-12-18 11:13:31] INFO (nni/MainThread) Intermediate result: 0.7550353036492085  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.62	mae: 14.59	mape: 98.71%	acc@10: 43.15%	acc@20: 74.3%	acc@30: 89.52%	
[2023-12-18 11:13:31] INFO (nni/MainThread) Intermediate result: 18.616306471659232  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.677 | ed:0.987 | hr@1:0.637 | hr@2:0.863 | hr@3:0.91 | acc@1:0.637 | acc@2:0.577 | acc@3:0.54 | Best krc: 0.767 | Best epoch: 4
[2023-12-18 11:13:57] INFO (nni/MainThread) Intermediate result: 0.7658544170043952  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 18.26	mae: 14.32	mape: 97.17%	acc@10: 44.04%	acc@20: 75.15%	acc@30: 89.97%	
[2023-12-18 11:13:57] INFO (nni/MainThread) Intermediate result: 18.25903145824553  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.756 | lsd:0.707 | ed:1.029 | hr@1:0.63 | hr@2:0.857 | hr@3:0.904 | acc@1:0.63 | acc@2:0.568 | acc@3:0.526 | Best krc: 0.767 | Best epoch: 4
[2023-12-18 11:14:23] INFO (nni/MainThread) Intermediate result: 0.7560890232862247  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.95	mae: 14.06	mape: 95.32%	acc@10: 44.91%	acc@20: 75.71%	acc@30: 90.34%	
[2023-12-18 11:14:23] INFO (nni/MainThread) Intermediate result: 17.94798750099651  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.672 | ed:1.005 | hr@1:0.63 | hr@2:0.864 | hr@3:0.91 | acc@1:0.63 | acc@2:0.573 | acc@3:0.531 | Best krc: 0.767 | Best epoch: 4
best model saved
[2023-12-18 11:14:51] INFO (nni/MainThread) Intermediate result: 0.7685556051100433  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.76	mae: 13.91	mape: 94.78%	acc@10: 45.41%	acc@20: 76.21%	acc@30: 90.6%	
[2023-12-18 11:14:51] INFO (nni/MainThread) Intermediate result: 17.763490328007258  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.659 | ed:0.978 | hr@1:0.635 | hr@2:0.864 | hr@3:0.913 | acc@1:0.635 | acc@2:0.579 | acc@3:0.546 | Best krc: 0.769 | Best epoch: 12
best model saved
[2023-12-18 11:15:18] INFO (nni/MainThread) Intermediate result: 0.7754441140973717  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.5	mae: 13.71	mape: 93.57%	acc@10: 45.87%	acc@20: 76.93%	acc@30: 90.98%	
[2023-12-18 11:15:18] INFO (nni/MainThread) Intermediate result: 17.500399470999906  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.669 | ed:1.001 | hr@1:0.632 | hr@2:0.866 | hr@3:0.913 | acc@1:0.632 | acc@2:0.578 | acc@3:0.542 | Best krc: 0.775 | Best epoch: 13
[2023-12-18 11:15:44] INFO (nni/MainThread) Intermediate result: 0.766458559497475  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.29	mae: 13.54	mape: 92.46%	acc@10: 46.35%	acc@20: 77.38%	acc@30: 91.28%	
[2023-12-18 11:15:44] INFO (nni/MainThread) Intermediate result: 17.294722923843192  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.645 | ed:0.949 | hr@1:0.647 | hr@2:0.868 | hr@3:0.912 | acc@1:0.647 | acc@2:0.595 | acc@3:0.557 | Best krc: 0.775 | Best epoch: 13
best model saved
[2023-12-18 11:16:11] INFO (nni/MainThread) Intermediate result: 0.7819286454529132  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 17.08	mae: 13.37	mape: 91.27%	acc@10: 46.85%	acc@20: 77.94%	acc@30: 91.64%	
[2023-12-18 11:16:12] INFO (nni/MainThread) Intermediate result: 17.080269238522636  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.648 | ed:0.958 | hr@1:0.644 | hr@2:0.868 | hr@3:0.912 | acc@1:0.644 | acc@2:0.589 | acc@3:0.552 | Best krc: 0.782 | Best epoch: 15
[2023-12-18 11:16:39] INFO (nni/MainThread) Intermediate result: 0.7761798000538708  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 16.89	mae: 13.23	mape: 90.43%	acc@10: 47.17%	acc@20: 78.39%	acc@30: 91.92%	
[2023-12-18 11:16:39] INFO (nni/MainThread) Intermediate result: 16.89257341402576  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.646 | ed:0.972 | hr@1:0.64 | hr@2:0.866 | hr@3:0.913 | acc@1:0.64 | acc@2:0.581 | acc@3:0.544 | Best krc: 0.782 | Best epoch: 15
[2023-12-18 11:17:07] INFO (nni/MainThread) Intermediate result: 0.7724881515349378  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 16.72	mae: 13.11	mape: 89.35%	acc@10: 47.61%	acc@20: 78.91%	acc@30: 92.18%	
[2023-12-18 11:17:07] INFO (nni/MainThread) Intermediate result: 16.71966573553898  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.672 | ed:1.012 | hr@1:0.627 | hr@2:0.861 | hr@3:0.909 | acc@1:0.627 | acc@2:0.569 | acc@3:0.529 | Best krc: 0.782 | Best epoch: 15
[2023-12-18 11:17:35] INFO (nni/MainThread) Intermediate result: 0.764710119270679  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.59	mae: 13.0	mape: 88.68%	acc@10: 47.93%	acc@20: 79.18%	acc@30: 92.34%	
[2023-12-18 11:17:35] INFO (nni/MainThread) Intermediate result: 16.58688384319684  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.659 | ed:0.945 | hr@1:0.65 | hr@2:0.863 | hr@3:0.913 | acc@1:0.65 | acc@2:0.589 | acc@3:0.555 | Best krc: 0.782 | Best epoch: 15
[2023-12-18 11:18:02] INFO (nni/MainThread) Intermediate result: 0.7815521051200982  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.48	mae: 12.92	mape: 88.28%	acc@10: 48.11%	acc@20: 79.46%	acc@30: 92.52%	
[2023-12-18 11:18:02] INFO (nni/MainThread) Intermediate result: 16.48144376789928  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.69 | ed:0.99 | hr@1:0.636 | hr@2:0.864 | hr@3:0.908 | acc@1:0.636 | acc@2:0.58 | acc@3:0.537 | Best krc: 0.782 | Best epoch: 15
[2023-12-18 11:18:28] INFO (nni/MainThread) Intermediate result: 0.7675549911229842  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.38	mae: 12.84	mape: 87.74%	acc@10: 48.34%	acc@20: 79.65%	acc@30: 92.65%	
[2023-12-18 11:18:28] INFO (nni/MainThread) Intermediate result: 16.379009009668078  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.646 | ed:0.949 | hr@1:0.646 | hr@2:0.866 | hr@3:0.913 | acc@1:0.646 | acc@2:0.59 | acc@3:0.555 | Best krc: 0.782 | Best epoch: 15
[2023-12-18 11:18:55] INFO (nni/MainThread) Intermediate result: 0.7796621522900488  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.26	mae: 12.76	mape: 86.98%	acc@10: 48.67%	acc@20: 79.88%	acc@30: 92.81%	
[2023-12-18 11:18:55] INFO (nni/MainThread) Intermediate result: 16.264354192175382  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.679 | ed:1.0 | hr@1:0.63 | hr@2:0.865 | hr@3:0.91 | acc@1:0.63 | acc@2:0.574 | acc@3:0.534 | Best krc: 0.782 | Best epoch: 15
[2023-12-18 11:19:22] INFO (nni/MainThread) Intermediate result: 0.7652591888184367  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.2	mae: 12.71	mape: 86.77%	acc@10: 48.78%	acc@20: 79.98%	acc@30: 92.93%	
[2023-12-18 11:19:22] INFO (nni/MainThread) Intermediate result: 16.200000134964064  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.654 | ed:0.984 | hr@1:0.639 | hr@2:0.866 | hr@3:0.91 | acc@1:0.639 | acc@2:0.583 | acc@3:0.542 | Best krc: 0.782 | Best epoch: 15
[2023-12-18 11:19:50] INFO (nni/MainThread) Intermediate result: 0.7677861007638008  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 16.12	mae: 12.64	mape: 86.23%	acc@10: 49.06%	acc@20: 80.19%	acc@30: 93.01%	
[2023-12-18 11:19:50] INFO (nni/MainThread) Intermediate result: 16.115554293273615  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.666 | ed:0.956 | hr@1:0.649 | hr@2:0.866 | hr@3:0.913 | acc@1:0.649 | acc@2:0.591 | acc@3:0.553 | Best krc: 0.782 | Best epoch: 15
[2023-12-18 11:20:18] INFO (nni/MainThread) Intermediate result: 0.7781267267931021  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 16.02	mae: 12.56	mape: 85.36%	acc@10: 49.38%	acc@20: 80.39%	acc@30: 93.13%	
[2023-12-18 11:20:18] INFO (nni/MainThread) Intermediate result: 16.01887179944983  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.652 | ed:0.963 | hr@1:0.639 | hr@2:0.867 | hr@3:0.914 | acc@1:0.639 | acc@2:0.585 | acc@3:0.55 | Best krc: 0.782 | Best epoch: 15
[2023-12-18 11:20:47] INFO (nni/MainThread) Intermediate result: 0.7769655937998745  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 15.94	mae: 12.49	mape: 84.45%	acc@10: 49.7%	acc@20: 80.58%	acc@30: 93.22%	
[2023-12-18 11:20:47] INFO (nni/MainThread) Intermediate result: 15.94064552823559  (Index 51)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702894148.7868051702894148.7868178
best model loaded !!!
krc:0.768 | lsd:0.501 | ed:0.999 | hr@1:0.646 | hr@2:0.901 | hr@3:0.935 | acc@1:0.646 | acc@2:0.601 | acc@3:0.55 |

-------------------------------------------------------------
Best epoch for G2R:  15
Best epoch for ETPA:  25
graph2route_pd Evaluation in test: krc:0.768 | lsd:0.501 | ed:0.999 | hr@1:0.646 | hr@2:0.901 | hr@3:0.935 | acc@1:0.646 | acc@2:0.601 | acc@3:0.55 |
RankPETA Evaluation in test: rmse: 11.44	mae: 8.85	mape: 67.55%	acc@10: 65.82%	acc@20: 93.67%	acc@30: 97.89%	
