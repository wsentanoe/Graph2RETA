Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 1000,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.75 | lsd:0.725 | ed:1.064 | hr@1:0.637 | hr@2:0.849 | hr@3:0.899 | acc@1:0.637 | acc@2:0.568 | acc@3:0.525 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-19 09:21:46] INFO (nni/MainThread) Intermediate result: 0.7497885968021515  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.38	mae: 19.18	mape: 72.57%	acc@10: 32.22%	acc@20: 59.63%	acc@30: 79.63%	
[2023-12-19 09:21:46] INFO (nni/MainThread) Intermediate result: 24.37568358416462  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.751 | lsd:0.721 | ed:1.063 | hr@1:0.621 | hr@2:0.852 | hr@3:0.902 | acc@1:0.621 | acc@2:0.561 | acc@3:0.521 | Best krc: 0.75 | Best epoch: 0
best model saved
[2023-12-19 09:22:10] INFO (nni/MainThread) Intermediate result: 0.7513415069602214  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 25.29	mae: 19.45	mape: 108.54%	acc@10: 32.59%	acc@20: 61.11%	acc@30: 80.37%	
[2023-12-19 09:22:10] INFO (nni/MainThread) Intermediate result: 25.290956101827827  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.727 | ed:1.027 | hr@1:0.631 | hr@2:0.852 | hr@3:0.904 | acc@1:0.631 | acc@2:0.57 | acc@3:0.529 | Best krc: 0.751 | Best epoch: 1
best model saved
[2023-12-19 09:22:34] INFO (nni/MainThread) Intermediate result: 0.7603433910823504  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 23.79	mae: 18.35	mape: 111.85%	acc@10: 34.44%	acc@20: 64.32%	acc@30: 82.59%	
[2023-12-19 09:22:34] INFO (nni/MainThread) Intermediate result: 23.78655781777955  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.758 | lsd:0.716 | ed:1.024 | hr@1:0.616 | hr@2:0.855 | hr@3:0.906 | acc@1:0.616 | acc@2:0.56 | acc@3:0.527 | Best krc: 0.76 | Best epoch: 2
[2023-12-19 09:22:58] INFO (nni/MainThread) Intermediate result: 0.7581745433953568  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 23.22	mae: 18.0	mape: 116.3%	acc@10: 34.81%	acc@20: 65.09%	acc@30: 83.24%	
[2023-12-19 09:22:58] INFO (nni/MainThread) Intermediate result: 23.224525121906545  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.724 | ed:0.99 | hr@1:0.629 | hr@2:0.858 | hr@3:0.909 | acc@1:0.629 | acc@2:0.571 | acc@3:0.541 | Best krc: 0.76 | Best epoch: 2
best model saved
[2023-12-19 09:23:22] INFO (nni/MainThread) Intermediate result: 0.7667776981637932  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 21.86	mae: 16.99	mape: 111.76%	acc@10: 37.19%	acc@20: 67.63%	acc@30: 85.19%	
[2023-12-19 09:23:22] INFO (nni/MainThread) Intermediate result: 21.857378284223692  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.691 | ed:0.979 | hr@1:0.631 | hr@2:0.864 | hr@3:0.909 | acc@1:0.631 | acc@2:0.578 | acc@3:0.545 | Best krc: 0.767 | Best epoch: 4
best model saved
[2023-12-19 09:23:46] INFO (nni/MainThread) Intermediate result: 0.7680552228868799  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 20.86	mae: 16.31	mape: 109.07%	acc@10: 38.21%	acc@20: 68.89%	acc@30: 87.04%	
[2023-12-19 09:23:46] INFO (nni/MainThread) Intermediate result: 20.856221593152718  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.663 | ed:0.976 | hr@1:0.635 | hr@2:0.869 | hr@3:0.912 | acc@1:0.635 | acc@2:0.582 | acc@3:0.549 | Best krc: 0.768 | Best epoch: 5
best model saved
[2023-12-19 09:24:10] INFO (nni/MainThread) Intermediate result: 0.7755198145228752  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 20.09	mae: 15.78	mape: 106.87%	acc@10: 38.78%	acc@20: 70.26%	acc@30: 88.25%	
[2023-12-19 09:24:10] INFO (nni/MainThread) Intermediate result: 20.091407143928727  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.665 | ed:0.947 | hr@1:0.649 | hr@2:0.867 | hr@3:0.913 | acc@1:0.649 | acc@2:0.595 | acc@3:0.556 | Best krc: 0.776 | Best epoch: 6
best model saved
[2023-12-19 09:24:35] INFO (nni/MainThread) Intermediate result: 0.7815471076074486  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.42	mae: 15.25	mape: 103.28%	acc@10: 40.46%	acc@20: 71.94%	acc@30: 89.07%	
[2023-12-19 09:24:35] INFO (nni/MainThread) Intermediate result: 19.423824482367863  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.643 | ed:0.939 | hr@1:0.646 | hr@2:0.869 | hr@3:0.914 | acc@1:0.646 | acc@2:0.593 | acc@3:0.56 | Best krc: 0.782 | Best epoch: 7
best model saved
[2023-12-19 09:24:59] INFO (nni/MainThread) Intermediate result: 0.782472281641499  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.92	mae: 14.85	mape: 100.88%	acc@10: 41.85%	acc@20: 73.13%	acc@30: 89.71%	
[2023-12-19 09:24:59] INFO (nni/MainThread) Intermediate result: 18.916188029171085  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.671 | ed:0.955 | hr@1:0.645 | hr@2:0.867 | hr@3:0.913 | acc@1:0.645 | acc@2:0.59 | acc@3:0.557 | Best krc: 0.782 | Best epoch: 8
[2023-12-19 09:25:23] INFO (nni/MainThread) Intermediate result: 0.7801373408369472  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.49	mae: 14.52	mape: 98.76%	acc@10: 42.85%	acc@20: 74.19%	acc@30: 90.33%	
[2023-12-19 09:25:23] INFO (nni/MainThread) Intermediate result: 18.486451910557342  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.724 | ed:1.002 | hr@1:0.635 | hr@2:0.868 | hr@3:0.906 | acc@1:0.635 | acc@2:0.585 | acc@3:0.54 | Best krc: 0.782 | Best epoch: 8
[2023-12-19 09:25:46] INFO (nni/MainThread) Intermediate result: 0.7645877557639691  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 18.15	mae: 14.26	mape: 97.28%	acc@10: 43.7%	acc@20: 75.02%	acc@30: 90.71%	
[2023-12-19 09:25:46] INFO (nni/MainThread) Intermediate result: 18.150649815994797  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.73 | ed:1.014 | hr@1:0.627 | hr@2:0.863 | hr@3:0.902 | acc@1:0.627 | acc@2:0.577 | acc@3:0.532 | Best krc: 0.782 | Best epoch: 8
[2023-12-19 09:26:10] INFO (nni/MainThread) Intermediate result: 0.7628216166738246  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.82	mae: 13.99	mape: 95.14%	acc@10: 44.72%	acc@20: 75.74%	acc@30: 91.05%	
[2023-12-19 09:26:10] INFO (nni/MainThread) Intermediate result: 17.81823498081995  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.758 | lsd:0.695 | ed:1.051 | hr@1:0.621 | hr@2:0.861 | hr@3:0.907 | acc@1:0.621 | acc@2:0.56 | acc@3:0.515 | Best krc: 0.782 | Best epoch: 8
[2023-12-19 09:26:33] INFO (nni/MainThread) Intermediate result: 0.7576096704474493  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.63	mae: 13.83	mape: 94.6%	acc@10: 45.07%	acc@20: 76.27%	acc@30: 91.31%	
[2023-12-19 09:26:33] INFO (nni/MainThread) Intermediate result: 17.625889723053344  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.781 | lsd:0.653 | ed:0.959 | hr@1:0.652 | hr@2:0.87 | hr@3:0.912 | acc@1:0.652 | acc@2:0.597 | acc@3:0.558 | Best krc: 0.782 | Best epoch: 8
[2023-12-19 09:26:57] INFO (nni/MainThread) Intermediate result: 0.7805664875538073  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.38	mae: 13.64	mape: 93.53%	acc@10: 45.58%	acc@20: 76.98%	acc@30: 91.69%	
[2023-12-19 09:26:57] INFO (nni/MainThread) Intermediate result: 17.37876831326699  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.786 | lsd:0.643 | ed:0.923 | hr@1:0.661 | hr@2:0.869 | hr@3:0.914 | acc@1:0.661 | acc@2:0.606 | acc@3:0.571 | Best krc: 0.782 | Best epoch: 8
best model saved
[2023-12-19 09:27:22] INFO (nni/MainThread) Intermediate result: 0.7860145609948845  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.18	mae: 13.49	mape: 92.44%	acc@10: 46.1%	acc@20: 77.43%	acc@30: 91.9%	
[2023-12-19 09:27:22] INFO (nni/MainThread) Intermediate result: 17.181820953499358  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.784 | lsd:0.635 | ed:0.94 | hr@1:0.653 | hr@2:0.872 | hr@3:0.916 | acc@1:0.653 | acc@2:0.602 | acc@3:0.564 | Best krc: 0.786 | Best epoch: 14
[2023-12-19 09:27:45] INFO (nni/MainThread) Intermediate result: 0.7844026730690483  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 16.98	mae: 13.33	mape: 91.29%	acc@10: 46.64%	acc@20: 77.96%	acc@30: 92.25%	
[2023-12-19 09:27:45] INFO (nni/MainThread) Intermediate result: 16.975665176673147  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.677 | ed:0.982 | hr@1:0.635 | hr@2:0.865 | hr@3:0.909 | acc@1:0.635 | acc@2:0.578 | acc@3:0.539 | Best krc: 0.786 | Best epoch: 14
[2023-12-19 09:28:09] INFO (nni/MainThread) Intermediate result: 0.771691323138634  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 16.79	mae: 13.18	mape: 90.31%	acc@10: 47.17%	acc@20: 78.47%	acc@30: 92.53%	
[2023-12-19 09:28:09] INFO (nni/MainThread) Intermediate result: 16.79202421426621  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.675 | ed:0.974 | hr@1:0.643 | hr@2:0.868 | hr@3:0.909 | acc@1:0.643 | acc@2:0.588 | acc@3:0.548 | Best krc: 0.786 | Best epoch: 14
[2023-12-19 09:28:32] INFO (nni/MainThread) Intermediate result: 0.7780638791482692  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 16.62	mae: 13.05	mape: 89.19%	acc@10: 47.72%	acc@20: 78.91%	acc@30: 92.8%	
[2023-12-19 09:28:32] INFO (nni/MainThread) Intermediate result: 16.621227002605604  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.649 | ed:0.955 | hr@1:0.644 | hr@2:0.868 | hr@3:0.915 | acc@1:0.644 | acc@2:0.588 | acc@3:0.553 | Best krc: 0.786 | Best epoch: 14
[2023-12-19 09:28:56] INFO (nni/MainThread) Intermediate result: 0.7790467842413621  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.49	mae: 12.94	mape: 88.5%	acc@10: 48.13%	acc@20: 79.16%	acc@30: 92.96%	
[2023-12-19 09:28:56] INFO (nni/MainThread) Intermediate result: 16.487156161849917  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.646 | ed:0.964 | hr@1:0.637 | hr@2:0.867 | hr@3:0.914 | acc@1:0.637 | acc@2:0.581 | acc@3:0.548 | Best krc: 0.786 | Best epoch: 14
[2023-12-19 09:29:20] INFO (nni/MainThread) Intermediate result: 0.776378377812571  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.37	mae: 12.84	mape: 87.95%	acc@10: 48.41%	acc@20: 79.48%	acc@30: 93.09%	
[2023-12-19 09:29:20] INFO (nni/MainThread) Intermediate result: 16.36848728261974  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.783 | lsd:0.646 | ed:0.94 | hr@1:0.649 | hr@2:0.869 | hr@3:0.914 | acc@1:0.649 | acc@2:0.596 | acc@3:0.56 | Best krc: 0.786 | Best epoch: 14
[2023-12-19 09:29:44] INFO (nni/MainThread) Intermediate result: 0.7825441494002929  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.35	mae: 12.86	mape: 88.62%	acc@10: 48.15%	acc@20: 79.31%	acc@30: 93.19%	
[2023-12-19 09:29:44] INFO (nni/MainThread) Intermediate result: 16.35229061069939  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.656 | ed:0.984 | hr@1:0.634 | hr@2:0.871 | hr@3:0.913 | acc@1:0.634 | acc@2:0.579 | acc@3:0.541 | Best krc: 0.786 | Best epoch: 14
[2023-12-19 09:30:08] INFO (nni/MainThread) Intermediate result: 0.7716139013296862  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.24	mae: 12.78	mape: 87.99%	acc@10: 48.45%	acc@20: 79.6%	acc@30: 93.37%	
[2023-12-19 09:30:08] INFO (nni/MainThread) Intermediate result: 16.2434996097759  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.785 | lsd:0.644 | ed:0.946 | hr@1:0.646 | hr@2:0.873 | hr@3:0.918 | acc@1:0.646 | acc@2:0.592 | acc@3:0.561 | Best krc: 0.786 | Best epoch: 14
[2023-12-19 09:30:32] INFO (nni/MainThread) Intermediate result: 0.7847969491519994  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.16	mae: 12.71	mape: 87.58%	acc@10: 48.7%	acc@20: 79.79%	acc@30: 93.46%	
[2023-12-19 09:30:32] INFO (nni/MainThread) Intermediate result: 16.162218381784445  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.664 | ed:0.99 | hr@1:0.636 | hr@2:0.867 | hr@3:0.91 | acc@1:0.636 | acc@2:0.581 | acc@3:0.538 | Best krc: 0.786 | Best epoch: 14
[2023-12-19 09:30:55] INFO (nni/MainThread) Intermediate result: 0.7732760209716922  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 16.07	mae: 12.63	mape: 87.02%	acc@10: 48.98%	acc@20: 79.98%	acc@30: 93.55%	
[2023-12-19 09:30:55] INFO (nni/MainThread) Intermediate result: 16.072379821106438  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.677 | ed:0.987 | hr@1:0.639 | hr@2:0.866 | hr@3:0.91 | acc@1:0.639 | acc@2:0.583 | acc@3:0.544 | Best krc: 0.786 | Best epoch: 14
[2023-12-19 09:31:19] INFO (nni/MainThread) Intermediate result: 0.7701486209138154  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 15.99	mae: 12.55	mape: 86.08%	acc@10: 49.44%	acc@20: 80.18%	acc@30: 93.61%	
[2023-12-19 09:31:19] INFO (nni/MainThread) Intermediate result: 15.988134275815044  (Index 49)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702974082.58188531702974082.5819
best model loaded !!!
krc:0.775 | lsd:0.495 | ed:0.972 | hr@1:0.662 | hr@2:0.902 | hr@3:0.936 | acc@1:0.662 | acc@2:0.612 | acc@3:0.561 |

-------------------------------------------------------------
Best epoch for G2R:  14
Best epoch for ETPA:  24
graph2route_pd Evaluation in test: krc:0.775 | lsd:0.495 | ed:0.972 | hr@1:0.662 | hr@2:0.902 | hr@3:0.936 | acc@1:0.662 | acc@2:0.612 | acc@3:0.561 |
RankPETA Evaluation in test: rmse: 11.56	mae: 8.87	mape: 73.01%	acc@10: 64.56%	acc@20: 91.98%	acc@30: 97.89%	
