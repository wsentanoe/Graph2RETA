Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.0005,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 1000,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.743 | lsd:0.799 | ed:1.1 | hr@1:0.638 | hr@2:0.843 | hr@3:0.894 | acc@1:0.638 | acc@2:0.558 | acc@3:0.515 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-06 20:20:23] INFO (nni/MainThread) Intermediate result: 0.7433406904679313  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 27.85	mae: 22.46	mape: 73.09%	acc@10: 25.19%	acc@20: 51.11%	acc@30: 72.22%	
[2023-12-06 20:20:23] INFO (nni/MainThread) Intermediate result: 27.851941617335562  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.757 | lsd:0.745 | ed:1.051 | hr@1:0.638 | hr@2:0.854 | hr@3:0.904 | acc@1:0.638 | acc@2:0.571 | acc@3:0.529 | Best krc: 0.743 | Best epoch: 0
best model saved
[2023-12-06 20:22:04] INFO (nni/MainThread) Intermediate result: 0.7569781556926289  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 26.31	mae: 20.35	mape: 90.66%	acc@10: 34.07%	acc@20: 58.33%	acc@30: 75.19%	
[2023-12-06 20:22:04] INFO (nni/MainThread) Intermediate result: 26.313952773780937  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.699 | ed:1.036 | hr@1:0.634 | hr@2:0.854 | hr@3:0.908 | acc@1:0.634 | acc@2:0.568 | acc@3:0.531 | Best krc: 0.757 | Best epoch: 1
best model saved
[2023-12-06 20:23:44] INFO (nni/MainThread) Intermediate result: 0.759644849150752  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 25.85	mae: 19.75	mape: 105.1%	acc@10: 34.44%	acc@20: 61.48%	acc@30: 77.53%	
[2023-12-06 20:23:44] INFO (nni/MainThread) Intermediate result: 25.845884917605943  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.681 | ed:0.982 | hr@1:0.645 | hr@2:0.86 | hr@3:0.907 | acc@1:0.645 | acc@2:0.585 | acc@3:0.55 | Best krc: 0.76 | Best epoch: 2
best model saved
[2023-12-06 20:25:21] INFO (nni/MainThread) Intermediate result: 0.7744738614961614  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 25.8	mae: 19.73	mape: 115.8%	acc@10: 33.33%	acc@20: 61.76%	acc@30: 78.33%	
[2023-12-06 20:25:21] INFO (nni/MainThread) Intermediate result: 25.79634012244749  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.713 | ed:1.014 | hr@1:0.642 | hr@2:0.857 | hr@3:0.907 | acc@1:0.642 | acc@2:0.581 | acc@3:0.547 | Best krc: 0.774 | Best epoch: 3
[2023-12-06 20:26:58] INFO (nni/MainThread) Intermediate result: 0.768562206550838  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 25.56	mae: 19.62	mape: 122.61%	acc@10: 33.11%	acc@20: 61.7%	acc@30: 79.33%	
[2023-12-06 20:26:58] INFO (nni/MainThread) Intermediate result: 25.555187973934405  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.722 | ed:1.014 | hr@1:0.632 | hr@2:0.857 | hr@3:0.906 | acc@1:0.632 | acc@2:0.571 | acc@3:0.537 | Best krc: 0.774 | Best epoch: 3
[2023-12-06 20:28:41] INFO (nni/MainThread) Intermediate result: 0.7632212756392904  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 25.08	mae: 19.42	mape: 126.06%	acc@10: 32.53%	acc@20: 61.42%	acc@30: 80.0%	
[2023-12-06 20:28:41] INFO (nni/MainThread) Intermediate result: 25.0764074769554  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.684 | ed:1.001 | hr@1:0.636 | hr@2:0.863 | hr@3:0.908 | acc@1:0.636 | acc@2:0.578 | acc@3:0.543 | Best krc: 0.774 | Best epoch: 3
[2023-12-06 20:30:20] INFO (nni/MainThread) Intermediate result: 0.7712075522657069  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 24.51	mae: 19.16	mape: 127.83%	acc@10: 32.49%	acc@20: 61.22%	acc@30: 80.69%	
[2023-12-06 20:30:20] INFO (nni/MainThread) Intermediate result: 24.509507009056545  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.712 | ed:1.007 | hr@1:0.634 | hr@2:0.858 | hr@3:0.907 | acc@1:0.634 | acc@2:0.575 | acc@3:0.538 | Best krc: 0.774 | Best epoch: 3
[2023-12-06 20:31:58] INFO (nni/MainThread) Intermediate result: 0.7630445190042916  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 23.87	mae: 18.77	mape: 127.31%	acc@10: 32.59%	acc@20: 61.94%	acc@30: 81.71%	
[2023-12-06 20:31:58] INFO (nni/MainThread) Intermediate result: 23.866925255616337  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.693 | ed:1.017 | hr@1:0.634 | hr@2:0.857 | hr@3:0.903 | acc@1:0.634 | acc@2:0.574 | acc@3:0.53 | Best krc: 0.774 | Best epoch: 3
[2023-12-06 20:33:38] INFO (nni/MainThread) Intermediate result: 0.7627301335565437  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 23.49	mae: 18.53	mape: 127.52%	acc@10: 32.51%	acc@20: 62.72%	acc@30: 82.3%	
[2023-12-06 20:33:38] INFO (nni/MainThread) Intermediate result: 23.490577432694735  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.668 | ed:0.999 | hr@1:0.638 | hr@2:0.864 | hr@3:0.908 | acc@1:0.638 | acc@2:0.582 | acc@3:0.546 | Best krc: 0.774 | Best epoch: 3
[2023-12-06 20:35:17] INFO (nni/MainThread) Intermediate result: 0.7704184235010646  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 23.05	mae: 18.26	mape: 127.24%	acc@10: 32.56%	acc@20: 63.15%	acc@30: 83.07%	
[2023-12-06 20:35:17] INFO (nni/MainThread) Intermediate result: 23.05212818011285  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.697 | ed:0.993 | hr@1:0.636 | hr@2:0.864 | hr@3:0.91 | acc@1:0.636 | acc@2:0.578 | acc@3:0.547 | Best krc: 0.774 | Best epoch: 3
[2023-12-06 20:36:56] INFO (nni/MainThread) Intermediate result: 0.7740254171649013  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 22.69	mae: 18.03	mape: 126.75%	acc@10: 32.79%	acc@20: 63.67%	acc@30: 83.64%	
[2023-12-06 20:36:56] INFO (nni/MainThread) Intermediate result: 22.69464646048819  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.675 | ed:0.964 | hr@1:0.651 | hr@2:0.863 | hr@3:0.91 | acc@1:0.651 | acc@2:0.595 | acc@3:0.56 | Best krc: 0.774 | Best epoch: 3
best model saved
[2023-12-06 20:38:33] INFO (nni/MainThread) Intermediate result: 0.780255954186868  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 22.29	mae: 17.75	mape: 125.42%	acc@10: 33.46%	acc@20: 64.41%	acc@30: 84.26%	
[2023-12-06 20:38:33] INFO (nni/MainThread) Intermediate result: 22.28850155457474  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.697 | ed:0.979 | hr@1:0.648 | hr@2:0.864 | hr@3:0.91 | acc@1:0.648 | acc@2:0.592 | acc@3:0.552 | Best krc: 0.78 | Best epoch: 11
[2023-12-06 20:40:10] INFO (nni/MainThread) Intermediate result: 0.7758056952197747  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 21.91	mae: 17.48	mape: 124.01%	acc@10: 34.13%	acc@20: 65.04%	acc@30: 84.84%	
[2023-12-06 20:40:10] INFO (nni/MainThread) Intermediate result: 21.91298265087217  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.668 | ed:0.969 | hr@1:0.647 | hr@2:0.863 | hr@3:0.912 | acc@1:0.647 | acc@2:0.592 | acc@3:0.558 | Best krc: 0.78 | Best epoch: 11
[2023-12-06 20:41:48] INFO (nni/MainThread) Intermediate result: 0.7802161416940603  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 21.55	mae: 17.23	mape: 122.79%	acc@10: 34.42%	acc@20: 65.69%	acc@30: 85.48%	
[2023-12-06 20:41:48] INFO (nni/MainThread) Intermediate result: 21.55317279722271  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.791 | lsd:0.68 | ed:0.947 | hr@1:0.668 | hr@2:0.865 | hr@3:0.909 | acc@1:0.668 | acc@2:0.61 | acc@3:0.57 | Best krc: 0.78 | Best epoch: 11
best model saved
[2023-12-06 20:43:26] INFO (nni/MainThread) Intermediate result: 0.7907138646710139  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 21.34	mae: 17.09	mape: 122.42%	acc@10: 34.64%	acc@20: 65.95%	acc@30: 85.83%	
[2023-12-06 20:43:26] INFO (nni/MainThread) Intermediate result: 21.341396746948877  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.797 | lsd:0.634 | ed:0.916 | hr@1:0.681 | hr@2:0.868 | hr@3:0.911 | acc@1:0.681 | acc@2:0.62 | acc@3:0.581 | Best krc: 0.791 | Best epoch: 14
best model saved
[2023-12-06 20:45:05] INFO (nni/MainThread) Intermediate result: 0.7974301644524643  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 21.18	mae: 16.99	mape: 122.25%	acc@10: 34.63%	acc@20: 66.04%	acc@30: 86.0%	
[2023-12-06 20:45:05] INFO (nni/MainThread) Intermediate result: 21.182551337917598  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.643 | ed:0.925 | hr@1:0.697 | hr@2:0.867 | hr@3:0.913 | acc@1:0.697 | acc@2:0.626 | acc@3:0.586 | Best krc: 0.797 | Best epoch: 15
best model saved
[2023-12-06 20:46:47] INFO (nni/MainThread) Intermediate result: 0.80033248909506  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 20.88	mae: 16.77	mape: 120.94%	acc@10: 35.12%	acc@20: 66.64%	acc@30: 86.45%	
[2023-12-06 20:46:47] INFO (nni/MainThread) Intermediate result: 20.88029050547195  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.791 | lsd:0.647 | ed:0.942 | hr@1:0.671 | hr@2:0.868 | hr@3:0.915 | acc@1:0.671 | acc@2:0.61 | acc@3:0.572 | Best krc: 0.8 | Best epoch: 16
[2023-12-06 20:48:27] INFO (nni/MainThread) Intermediate result: 0.791375384239398  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 20.66	mae: 16.62	mape: 120.19%	acc@10: 35.21%	acc@20: 67.06%	acc@30: 86.81%	
[2023-12-06 20:48:27] INFO (nni/MainThread) Intermediate result: 20.657905419442272  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.798 | lsd:0.655 | ed:0.93 | hr@1:0.688 | hr@2:0.873 | hr@3:0.918 | acc@1:0.688 | acc@2:0.622 | acc@3:0.585 | Best krc: 0.8 | Best epoch: 16
[2023-12-06 20:50:05] INFO (nni/MainThread) Intermediate result: 0.7983955903850963  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 20.48	mae: 16.5	mape: 119.66%	acc@10: 35.32%	acc@20: 67.29%	acc@30: 87.12%	
[2023-12-06 20:50:05] INFO (nni/MainThread) Intermediate result: 20.477707445630845  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.799 | lsd:0.651 | ed:0.929 | hr@1:0.693 | hr@2:0.863 | hr@3:0.913 | acc@1:0.693 | acc@2:0.621 | acc@3:0.587 | Best krc: 0.8 | Best epoch: 16
[2023-12-06 20:51:42] INFO (nni/MainThread) Intermediate result: 0.798819633458899  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 20.19	mae: 16.27	mape: 118.0%	acc@10: 35.81%	acc@20: 67.98%	acc@30: 87.65%	
[2023-12-06 20:51:42] INFO (nni/MainThread) Intermediate result: 20.185554509276592  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.65 | ed:0.919 | hr@1:0.705 | hr@2:0.869 | hr@3:0.914 | acc@1:0.705 | acc@2:0.638 | acc@3:0.601 | Best krc: 0.8 | Best epoch: 16
best model saved
[2023-12-06 20:53:21] INFO (nni/MainThread) Intermediate result: 0.800368440123578  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 20.1	mae: 16.22	mape: 117.98%	acc@10: 35.78%	acc@20: 68.02%	acc@30: 87.78%	
[2023-12-06 20:53:21] INFO (nni/MainThread) Intermediate result: 20.101961349631136  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.809 | lsd:0.62 | ed:0.891 | hr@1:0.711 | hr@2:0.871 | hr@3:0.918 | acc@1:0.711 | acc@2:0.638 | acc@3:0.602 | Best krc: 0.8 | Best epoch: 20
best model saved
[2023-12-06 20:55:05] INFO (nni/MainThread) Intermediate result: 0.8092831559119273  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 19.91	mae: 16.08	mape: 117.28%	acc@10: 35.94%	acc@20: 68.42%	acc@30: 88.13%	
[2023-12-06 20:55:05] INFO (nni/MainThread) Intermediate result: 19.905821230737534  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.653 | ed:0.903 | hr@1:0.71 | hr@2:0.87 | hr@3:0.917 | acc@1:0.71 | acc@2:0.634 | acc@3:0.596 | Best krc: 0.809 | Best epoch: 21
[2023-12-06 20:56:49] INFO (nni/MainThread) Intermediate result: 0.8079475817385742  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 19.7	mae: 15.93	mape: 116.29%	acc@10: 36.31%	acc@20: 68.87%	acc@30: 88.47%	
[2023-12-06 20:56:49] INFO (nni/MainThread) Intermediate result: 19.701271515151856  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.797 | lsd:0.653 | ed:0.94 | hr@1:0.693 | hr@2:0.871 | hr@3:0.914 | acc@1:0.693 | acc@2:0.626 | acc@3:0.583 | Best krc: 0.809 | Best epoch: 21
[2023-12-06 20:58:31] INFO (nni/MainThread) Intermediate result: 0.7970618935551161  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 19.51	mae: 15.78	mape: 115.29%	acc@10: 36.74%	acc@20: 69.37%	acc@30: 88.78%	
[2023-12-06 20:58:31] INFO (nni/MainThread) Intermediate result: 19.508734074943188  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.651 | ed:0.913 | hr@1:0.69 | hr@2:0.871 | hr@3:0.918 | acc@1:0.69 | acc@2:0.62 | acc@3:0.585 | Best krc: 0.809 | Best epoch: 21
[2023-12-06 21:00:13] INFO (nni/MainThread) Intermediate result: 0.8000166763874679  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 19.35	mae: 15.66	mape: 114.62%	acc@10: 37.04%	acc@20: 69.76%	acc@30: 89.07%	
[2023-12-06 21:00:13] INFO (nni/MainThread) Intermediate result: 19.34900223770609  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.8 | lsd:0.641 | ed:0.917 | hr@1:0.696 | hr@2:0.872 | hr@3:0.917 | acc@1:0.696 | acc@2:0.629 | acc@3:0.588 | Best krc: 0.809 | Best epoch: 21
[2023-12-06 21:01:53] INFO (nni/MainThread) Intermediate result: 0.8004783278067056  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 19.2	mae: 15.54	mape: 113.94%	acc@10: 37.28%	acc@20: 70.04%	acc@30: 89.3%	
[2023-12-06 21:01:53] INFO (nni/MainThread) Intermediate result: 19.203549407343868  (Index 51)
*** Epoch: 26 ***
-----------------G2R RESULT-------------------

val result: krc:0.797 | lsd:0.633 | ed:0.913 | hr@1:0.692 | hr@2:0.869 | hr@3:0.918 | acc@1:0.692 | acc@2:0.629 | acc@3:0.592 | Best krc: 0.809 | Best epoch: 21
[2023-12-06 21:03:34] INFO (nni/MainThread) Intermediate result: 0.7971036856388848  (Index 52)
-----------------ETPA RESULT-------------------
Epoch 26: Validation	rmse: 19.06	mae: 15.43	mape: 113.28%	acc@10: 37.57%	acc@20: 70.4%	acc@30: 89.53%	
[2023-12-06 21:03:34] INFO (nni/MainThread) Intermediate result: 19.0570254953575  (Index 53)
*** Epoch: 27 ***
-----------------G2R RESULT-------------------

val result: krc:0.796 | lsd:0.648 | ed:0.93 | hr@1:0.703 | hr@2:0.871 | hr@3:0.92 | acc@1:0.703 | acc@2:0.634 | acc@3:0.595 | Best krc: 0.809 | Best epoch: 21
[2023-12-06 21:05:16] INFO (nni/MainThread) Intermediate result: 0.7957988135688182  (Index 54)
-----------------ETPA RESULT-------------------
Epoch 27: Validation	rmse: 18.93	mae: 15.34	mape: 112.71%	acc@10: 37.76%	acc@20: 70.67%	acc@30: 89.8%	
[2023-12-06 21:05:16] INFO (nni/MainThread) Intermediate result: 18.9252048723838  (Index 55)
*** Epoch: 28 ***
-----------------G2R RESULT-------------------

val result: krc:0.802 | lsd:0.626 | ed:0.928 | hr@1:0.698 | hr@2:0.868 | hr@3:0.918 | acc@1:0.698 | acc@2:0.628 | acc@3:0.591 | Best krc: 0.809 | Best epoch: 21
[2023-12-06 21:06:59] INFO (nni/MainThread) Intermediate result: 0.80185170899644  (Index 56)
-----------------ETPA RESULT-------------------
Epoch 28: Validation	rmse: 18.84	mae: 15.27	mape: 112.47%	acc@10: 37.93%	acc@20: 70.86%	acc@30: 89.95%	
[2023-12-06 21:06:59] INFO (nni/MainThread) Intermediate result: 18.836578306346574  (Index 57)
*** Epoch: 29 ***
-----------------G2R RESULT-------------------

val result: krc:0.807 | lsd:0.609 | ed:0.897 | hr@1:0.705 | hr@2:0.875 | hr@3:0.918 | acc@1:0.705 | acc@2:0.642 | acc@3:0.6 | Best krc: 0.809 | Best epoch: 21
[2023-12-06 21:08:38] INFO (nni/MainThread) Intermediate result: 0.8074369220149719  (Index 58)
-----------------ETPA RESULT-------------------
Epoch 29: Validation	rmse: 18.69	mae: 15.15	mape: 111.67%	acc@10: 38.3%	acc@20: 71.25%	acc@30: 90.21%	
[2023-12-06 21:08:38] INFO (nni/MainThread) Intermediate result: 18.68829874081603  (Index 59)
*** Epoch: 30 ***
-----------------G2R RESULT-------------------

val result: krc:0.813 | lsd:0.586 | ed:0.881 | hr@1:0.71 | hr@2:0.877 | hr@3:0.919 | acc@1:0.71 | acc@2:0.645 | acc@3:0.608 | Best krc: 0.809 | Best epoch: 21
best model saved
[2023-12-06 21:10:19] INFO (nni/MainThread) Intermediate result: 0.8134582358806234  (Index 60)
-----------------ETPA RESULT-------------------
Epoch 30: Validation	rmse: 18.57	mae: 15.06	mape: 111.07%	acc@10: 38.66%	acc@20: 71.52%	acc@30: 90.42%	
[2023-12-06 21:10:19] INFO (nni/MainThread) Intermediate result: 18.570181177450632  (Index 61)
*** Epoch: 31 ***
-----------------G2R RESULT-------------------

val result: krc:0.807 | lsd:0.615 | ed:0.902 | hr@1:0.691 | hr@2:0.868 | hr@3:0.916 | acc@1:0.691 | acc@2:0.625 | acc@3:0.593 | Best krc: 0.813 | Best epoch: 30
[2023-12-06 21:11:59] INFO (nni/MainThread) Intermediate result: 0.8070170277341242  (Index 62)
-----------------ETPA RESULT-------------------
Epoch 31: Validation	rmse: 18.48	mae: 14.99	mape: 110.74%	acc@10: 38.82%	acc@20: 71.67%	acc@30: 90.56%	
[2023-12-06 21:11:59] INFO (nni/MainThread) Intermediate result: 18.48418422528051  (Index 63)
*** Epoch: 32 ***
-----------------G2R RESULT-------------------

val result: krc:0.801 | lsd:0.609 | ed:0.928 | hr@1:0.684 | hr@2:0.866 | hr@3:0.914 | acc@1:0.684 | acc@2:0.614 | acc@3:0.573 | Best krc: 0.813 | Best epoch: 30
[2023-12-06 21:13:40] INFO (nni/MainThread) Intermediate result: 0.8007640421894905  (Index 64)
-----------------ETPA RESULT-------------------
Epoch 32: Validation	rmse: 18.41	mae: 14.93	mape: 110.45%	acc@10: 39.01%	acc@20: 71.84%	acc@30: 90.63%	
[2023-12-06 21:13:40] INFO (nni/MainThread) Intermediate result: 18.410305939844235  (Index 65)
*** Epoch: 33 ***
-----------------G2R RESULT-------------------

val result: krc:0.81 | lsd:0.596 | ed:0.895 | hr@1:0.692 | hr@2:0.873 | hr@3:0.919 | acc@1:0.692 | acc@2:0.631 | acc@3:0.595 | Best krc: 0.813 | Best epoch: 30
[2023-12-06 21:15:21] INFO (nni/MainThread) Intermediate result: 0.8101589398309992  (Index 66)
-----------------ETPA RESULT-------------------
Epoch 33: Validation	rmse: 18.31	mae: 14.85	mape: 109.91%	acc@10: 39.25%	acc@20: 72.08%	acc@30: 90.8%	
[2023-12-06 21:15:21] INFO (nni/MainThread) Intermediate result: 18.31197386567921  (Index 67)
*** Epoch: 34 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.602 | ed:0.916 | hr@1:0.689 | hr@2:0.867 | hr@3:0.918 | acc@1:0.689 | acc@2:0.623 | acc@3:0.585 | Best krc: 0.813 | Best epoch: 30
[2023-12-06 21:16:59] INFO (nni/MainThread) Intermediate result: 0.8028400908068595  (Index 68)
-----------------ETPA RESULT-------------------
Epoch 34: Validation	rmse: 18.24	mae: 14.79	mape: 109.58%	acc@10: 39.54%	acc@20: 72.24%	acc@30: 90.88%	
[2023-12-06 21:16:59] INFO (nni/MainThread) Intermediate result: 18.239134603483418  (Index 69)
*** Epoch: 35 ***
-----------------G2R RESULT-------------------

val result: krc:0.801 | lsd:0.621 | ed:0.923 | hr@1:0.688 | hr@2:0.869 | hr@3:0.917 | acc@1:0.688 | acc@2:0.624 | acc@3:0.585 | Best krc: 0.813 | Best epoch: 30
[2023-12-06 21:18:41] INFO (nni/MainThread) Intermediate result: 0.8006695880679263  (Index 70)
-----------------ETPA RESULT-------------------
Epoch 35: Validation	rmse: 18.17	mae: 14.73	mape: 109.29%	acc@10: 39.68%	acc@20: 72.35%	acc@30: 91.01%	
[2023-12-06 21:18:41] INFO (nni/MainThread) Intermediate result: 18.16884853458938  (Index 71)
*** Epoch: 36 ***
-----------------G2R RESULT-------------------

val result: krc:0.81 | lsd:0.598 | ed:0.893 | hr@1:0.704 | hr@2:0.877 | hr@3:0.922 | acc@1:0.704 | acc@2:0.641 | acc@3:0.603 | Best krc: 0.813 | Best epoch: 30
[2023-12-06 21:20:20] INFO (nni/MainThread) Intermediate result: 0.8102635980029945  (Index 72)
-----------------ETPA RESULT-------------------
Epoch 36: Validation	rmse: 18.11	mae: 14.69	mape: 109.05%	acc@10: 39.83%	acc@20: 72.45%	acc@30: 91.05%	
[2023-12-06 21:20:20] INFO (nni/MainThread) Intermediate result: 18.109461893140328  (Index 73)
*** Epoch: 37 ***
-----------------G2R RESULT-------------------

val result: krc:0.813 | lsd:0.603 | ed:0.877 | hr@1:0.711 | hr@2:0.877 | hr@3:0.922 | acc@1:0.711 | acc@2:0.645 | acc@3:0.61 | Best krc: 0.813 | Best epoch: 30
[2023-12-06 21:21:58] INFO (nni/MainThread) Intermediate result: 0.8125058280720721  (Index 74)
-----------------ETPA RESULT-------------------
Epoch 37: Validation	rmse: 18.0	mae: 14.59	mape: 108.21%	acc@10: 40.22%	acc@20: 72.77%	acc@30: 91.2%	
[2023-12-06 21:21:58] INFO (nni/MainThread) Intermediate result: 18.003664727241365  (Index 75)
*** Epoch: 38 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.576 | ed:0.909 | hr@1:0.697 | hr@2:0.877 | hr@3:0.919 | acc@1:0.697 | acc@2:0.626 | acc@3:0.589 | Best krc: 0.813 | Best epoch: 30
[2023-12-06 21:23:40] INFO (nni/MainThread) Intermediate result: 0.8034217349477515  (Index 76)
-----------------ETPA RESULT-------------------
Epoch 38: Validation	rmse: 17.92	mae: 14.52	mape: 107.7%	acc@10: 40.47%	acc@20: 72.98%	acc@30: 91.35%	
[2023-12-06 21:23:40] INFO (nni/MainThread) Intermediate result: 17.91703688631287  (Index 77)
*** Epoch: 39 ***
-----------------G2R RESULT-------------------

val result: krc:0.818 | lsd:0.573 | ed:0.857 | hr@1:0.723 | hr@2:0.881 | hr@3:0.926 | acc@1:0.723 | acc@2:0.654 | acc@3:0.614 | Best krc: 0.813 | Best epoch: 30
best model saved
[2023-12-06 21:25:26] INFO (nni/MainThread) Intermediate result: 0.8177327758963089  (Index 78)
-----------------ETPA RESULT-------------------
Epoch 39: Validation	rmse: 17.81	mae: 14.43	mape: 106.95%	acc@10: 40.81%	acc@20: 73.29%	acc@30: 91.48%	
[2023-12-06 21:25:26] INFO (nni/MainThread) Intermediate result: 17.81084558460163  (Index 79)
*** Epoch: 40 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.575 | ed:0.897 | hr@1:0.708 | hr@2:0.879 | hr@3:0.924 | acc@1:0.708 | acc@2:0.637 | acc@3:0.599 | Best krc: 0.818 | Best epoch: 39
[2023-12-06 21:27:06] INFO (nni/MainThread) Intermediate result: 0.8084784065632338  (Index 80)
-----------------ETPA RESULT-------------------
Epoch 40: Validation	rmse: 17.78	mae: 14.4	mape: 106.87%	acc@10: 40.84%	acc@20: 73.33%	acc@30: 91.5%	
[2023-12-06 21:27:06] INFO (nni/MainThread) Intermediate result: 17.777543678886456  (Index 81)
*** Epoch: 41 ***
-----------------G2R RESULT-------------------

val result: krc:0.805 | lsd:0.588 | ed:0.912 | hr@1:0.718 | hr@2:0.878 | hr@3:0.922 | acc@1:0.718 | acc@2:0.64 | acc@3:0.598 | Best krc: 0.818 | Best epoch: 39
[2023-12-06 21:28:45] INFO (nni/MainThread) Intermediate result: 0.8049351940388232  (Index 82)
-----------------ETPA RESULT-------------------
Epoch 41: Validation	rmse: 17.74	mae: 14.37	mape: 106.77%	acc@10: 40.88%	acc@20: 73.39%	acc@30: 91.59%	
[2023-12-06 21:28:45] INFO (nni/MainThread) Intermediate result: 17.737121277383462  (Index 83)
*** Epoch: 42 ***
-----------------G2R RESULT-------------------

val result: krc:0.814 | lsd:0.605 | ed:0.879 | hr@1:0.723 | hr@2:0.879 | hr@3:0.927 | acc@1:0.723 | acc@2:0.652 | acc@3:0.619 | Best krc: 0.818 | Best epoch: 39
[2023-12-06 21:30:33] INFO (nni/MainThread) Intermediate result: 0.813675644344643  (Index 84)
-----------------ETPA RESULT-------------------
Epoch 42: Validation	rmse: 17.66	mae: 14.31	mape: 106.33%	acc@10: 41.12%	acc@20: 73.57%	acc@30: 91.72%	
[2023-12-06 21:30:33] INFO (nni/MainThread) Intermediate result: 17.66094979006082  (Index 85)
*** Epoch: 43 ***
-----------------G2R RESULT-------------------

val result: krc:0.802 | lsd:0.613 | ed:0.906 | hr@1:0.707 | hr@2:0.873 | hr@3:0.922 | acc@1:0.707 | acc@2:0.637 | acc@3:0.6 | Best krc: 0.818 | Best epoch: 39
[2023-12-06 21:32:23] INFO (nni/MainThread) Intermediate result: 0.8021835101852589  (Index 86)
-----------------ETPA RESULT-------------------
Epoch 43: Validation	rmse: 17.59	mae: 14.25	mape: 105.93%	acc@10: 41.3%	acc@20: 73.77%	acc@30: 91.84%	
[2023-12-06 21:32:23] INFO (nni/MainThread) Intermediate result: 17.588011675564168  (Index 87)
*** Epoch: 44 ***
-----------------G2R RESULT-------------------

val result: krc:0.806 | lsd:0.608 | ed:0.893 | hr@1:0.71 | hr@2:0.871 | hr@3:0.923 | acc@1:0.71 | acc@2:0.637 | acc@3:0.604 | Best krc: 0.818 | Best epoch: 39
[2023-12-06 21:34:12] INFO (nni/MainThread) Intermediate result: 0.8061239283801593  (Index 88)
-----------------ETPA RESULT-------------------
Epoch 44: Validation	rmse: 17.5	mae: 14.18	mape: 105.31%	acc@10: 41.6%	acc@20: 74.02%	acc@30: 91.98%	
[2023-12-06 21:34:12] INFO (nni/MainThread) Intermediate result: 17.50194235270534  (Index 89)
*** Epoch: 45 ***
-----------------G2R RESULT-------------------

val result: krc:0.814 | lsd:0.619 | ed:0.873 | hr@1:0.719 | hr@2:0.876 | hr@3:0.925 | acc@1:0.719 | acc@2:0.65 | acc@3:0.613 | Best krc: 0.818 | Best epoch: 39
[2023-12-06 21:36:00] INFO (nni/MainThread) Intermediate result: 0.814289158670444  (Index 90)
-----------------ETPA RESULT-------------------
Epoch 45: Validation	rmse: 17.44	mae: 14.13	mape: 104.92%	acc@10: 41.74%	acc@20: 74.16%	acc@30: 92.09%	
[2023-12-06 21:36:00] INFO (nni/MainThread) Intermediate result: 17.435921198975198  (Index 91)
*** Epoch: 46 ***
-----------------G2R RESULT-------------------

val result: krc:0.813 | lsd:0.574 | ed:0.884 | hr@1:0.726 | hr@2:0.879 | hr@3:0.925 | acc@1:0.726 | acc@2:0.652 | acc@3:0.611 | Best krc: 0.818 | Best epoch: 39
[2023-12-06 21:37:53] INFO (nni/MainThread) Intermediate result: 0.812902450672455  (Index 92)
-----------------ETPA RESULT-------------------
Epoch 46: Validation	rmse: 17.39	mae: 14.1	mape: 104.68%	acc@10: 41.82%	acc@20: 74.27%	acc@30: 92.19%	
[2023-12-06 21:37:53] INFO (nni/MainThread) Intermediate result: 17.3904550037123  (Index 93)
*** Epoch: 47 ***
-----------------G2R RESULT-------------------

val result: krc:0.817 | lsd:0.589 | ed:0.866 | hr@1:0.736 | hr@2:0.873 | hr@3:0.922 | acc@1:0.736 | acc@2:0.662 | acc@3:0.62 | Best krc: 0.818 | Best epoch: 39
[2023-12-06 21:39:45] INFO (nni/MainThread) Intermediate result: 0.8168501944540423  (Index 94)
-----------------ETPA RESULT-------------------
Epoch 47: Validation	rmse: 17.31	mae: 14.03	mape: 104.1%	acc@10: 42.1%	acc@20: 74.48%	acc@30: 92.29%	
[2023-12-06 21:39:45] INFO (nni/MainThread) Intermediate result: 17.313356739678913  (Index 95)
*** Epoch: 48 ***
-----------------G2R RESULT-------------------

val result: krc:0.815 | lsd:0.592 | ed:0.876 | hr@1:0.728 | hr@2:0.877 | hr@3:0.925 | acc@1:0.728 | acc@2:0.656 | acc@3:0.611 | Best krc: 0.818 | Best epoch: 39
[2023-12-06 21:41:37] INFO (nni/MainThread) Intermediate result: 0.8151698404431241  (Index 96)
-----------------ETPA RESULT-------------------
Epoch 48: Validation	rmse: 17.27	mae: 14.0	mape: 103.89%	acc@10: 42.17%	acc@20: 74.57%	acc@30: 92.37%	
[2023-12-06 21:41:37] INFO (nni/MainThread) Intermediate result: 17.271284325287358  (Index 97)
*** Epoch: 49 ***
-----------------G2R RESULT-------------------

val result: krc:0.814 | lsd:0.587 | ed:0.882 | hr@1:0.732 | hr@2:0.876 | hr@3:0.922 | acc@1:0.732 | acc@2:0.655 | acc@3:0.611 | Best krc: 0.818 | Best epoch: 39
[2023-12-06 21:43:28] INFO (nni/MainThread) Intermediate result: 0.813779325016754  (Index 98)
-----------------ETPA RESULT-------------------
Epoch 49: Validation	rmse: 17.22	mae: 13.96	mape: 103.62%	acc@10: 42.29%	acc@20: 74.7%	acc@30: 92.47%	
[2023-12-06 21:43:28] INFO (nni/MainThread) Intermediate result: 17.218667959985673  (Index 99)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701890328.0355661701890328.0355778
best model loaded !!!
krc:0.807 | lsd:0.428 | ed:0.908 | hr@1:0.717 | hr@2:0.914 | hr@3:0.943 | acc@1:0.717 | acc@2:0.658 | acc@3:0.603 |

-------------------------------------------------------------
Best epoch for G2R:  39
Best epoch for ETPA:  49
graph2route_pd Evaluation in test: krc:0.807 | lsd:0.428 | ed:0.908 | hr@1:0.717 | hr@2:0.914 | hr@3:0.943 | acc@1:0.717 | acc@2:0.658 | acc@3:0.603 |
RankPETA Evaluation in test: rmse: 15.47	mae: 11.94	mape: 106.9%	acc@10: 49.37%	acc@20: 83.12%	acc@30: 95.78%	
