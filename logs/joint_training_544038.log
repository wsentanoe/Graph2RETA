Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'tft',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.693 | ed:1.035 | hr@1:0.616 | hr@2:0.862 | hr@3:0.912 | acc@1:0.616 | acc@2:0.558 | acc@3:0.525 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-16 10:37:02] INFO (nni/MainThread) Intermediate result: 0.7593779981536868  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 26.94	mae: 21.28	mape: 67.09%	acc@10: 28.15%	acc@20: 55.19%	acc@30: 74.44%	
[2023-12-16 10:37:02] INFO (nni/MainThread) Intermediate result: 26.937540784481886  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.754 | lsd:0.718 | ed:1.058 | hr@1:0.626 | hr@2:0.861 | hr@3:0.903 | acc@1:0.626 | acc@2:0.57 | acc@3:0.526 | Best krc: 0.759 | Best epoch: 0
[2023-12-16 10:38:37] INFO (nni/MainThread) Intermediate result: 0.7543693945530412  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 26.78	mae: 20.31	mape: 103.21%	acc@10: 32.59%	acc@20: 60.0%	acc@30: 77.78%	
[2023-12-16 10:38:37] INFO (nni/MainThread) Intermediate result: 26.779193315590806  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.664 | ed:1.0 | hr@1:0.638 | hr@2:0.865 | hr@3:0.912 | acc@1:0.638 | acc@2:0.576 | acc@3:0.54 | Best krc: 0.759 | Best epoch: 0
best model saved
[2023-12-16 10:40:16] INFO (nni/MainThread) Intermediate result: 0.7684231249163472  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 24.8	mae: 19.05	mape: 109.64%	acc@10: 34.32%	acc@20: 62.72%	acc@30: 80.99%	
[2023-12-16 10:40:16] INFO (nni/MainThread) Intermediate result: 24.799132742383094  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.671 | ed:0.983 | hr@1:0.641 | hr@2:0.864 | hr@3:0.91 | acc@1:0.641 | acc@2:0.588 | acc@3:0.55 | Best krc: 0.768 | Best epoch: 2
best model saved
[2023-12-16 10:41:52] INFO (nni/MainThread) Intermediate result: 0.7733383428180104  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 23.64	mae: 18.4	mape: 113.6%	acc@10: 34.26%	acc@20: 63.98%	acc@30: 82.5%	
[2023-12-16 10:41:53] INFO (nni/MainThread) Intermediate result: 23.636144256026625  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.66 | ed:1.005 | hr@1:0.638 | hr@2:0.866 | hr@3:0.908 | acc@1:0.638 | acc@2:0.582 | acc@3:0.537 | Best krc: 0.773 | Best epoch: 3
[2023-12-16 10:43:29] INFO (nni/MainThread) Intermediate result: 0.765858796825128  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 23.17	mae: 18.1	mape: 117.09%	acc@10: 34.22%	acc@20: 64.74%	acc@30: 83.11%	
[2023-12-16 10:43:29] INFO (nni/MainThread) Intermediate result: 23.169054247509926  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.793 | lsd:0.656 | ed:0.938 | hr@1:0.672 | hr@2:0.868 | hr@3:0.915 | acc@1:0.672 | acc@2:0.613 | acc@3:0.577 | Best krc: 0.773 | Best epoch: 3
best model saved
[2023-12-16 10:45:06] INFO (nni/MainThread) Intermediate result: 0.7927463021035386  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 22.14	mae: 17.4	mape: 114.82%	acc@10: 35.43%	acc@20: 66.3%	acc@30: 84.75%	
[2023-12-16 10:45:06] INFO (nni/MainThread) Intermediate result: 22.13925121607859  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.783 | lsd:0.699 | ed:0.977 | hr@1:0.711 | hr@2:0.851 | hr@3:0.909 | acc@1:0.711 | acc@2:0.616 | acc@3:0.573 | Best krc: 0.793 | Best epoch: 5
[2023-12-16 10:46:42] INFO (nni/MainThread) Intermediate result: 0.7831235233858759  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 21.21	mae: 16.68	mape: 111.28%	acc@10: 37.14%	acc@20: 68.31%	acc@30: 86.19%	
[2023-12-16 10:46:42] INFO (nni/MainThread) Intermediate result: 21.205023357204016  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.806 | lsd:0.607 | ed:0.9 | hr@1:0.69 | hr@2:0.874 | hr@3:0.92 | acc@1:0.69 | acc@2:0.627 | acc@3:0.595 | Best krc: 0.793 | Best epoch: 5
best model saved
[2023-12-16 10:48:20] INFO (nni/MainThread) Intermediate result: 0.8056528352374439  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 20.34	mae: 16.02	mape: 107.65%	acc@10: 38.8%	acc@20: 70.09%	acc@30: 87.55%	
[2023-12-16 10:48:20] INFO (nni/MainThread) Intermediate result: 20.34090229732904  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.808 | lsd:0.62 | ed:0.903 | hr@1:0.711 | hr@2:0.869 | hr@3:0.921 | acc@1:0.711 | acc@2:0.635 | acc@3:0.603 | Best krc: 0.806 | Best epoch: 7
best model saved
[2023-12-16 10:49:57] INFO (nni/MainThread) Intermediate result: 0.8082696956155636  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 19.75	mae: 15.6	mape: 106.15%	acc@10: 39.71%	acc@20: 71.07%	acc@30: 88.52%	
[2023-12-16 10:49:57] INFO (nni/MainThread) Intermediate result: 19.7531735876041  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.804 | lsd:0.607 | ed:0.906 | hr@1:0.684 | hr@2:0.875 | hr@3:0.92 | acc@1:0.684 | acc@2:0.626 | acc@3:0.591 | Best krc: 0.808 | Best epoch: 8
[2023-12-16 10:51:33] INFO (nni/MainThread) Intermediate result: 0.8036807067327398  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 19.16	mae: 15.12	mape: 102.96%	acc@10: 41.37%	acc@20: 72.63%	acc@30: 89.3%	
[2023-12-16 10:51:33] INFO (nni/MainThread) Intermediate result: 19.157311513042316  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.785 | lsd:0.669 | ed:0.99 | hr@1:0.685 | hr@2:0.863 | hr@3:0.91 | acc@1:0.685 | acc@2:0.608 | acc@3:0.564 | Best krc: 0.808 | Best epoch: 8
[2023-12-16 10:53:10] INFO (nni/MainThread) Intermediate result: 0.7851654051304247  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 18.63	mae: 14.69	mape: 99.88%	acc@10: 42.73%	acc@20: 74.14%	acc@30: 89.93%	
[2023-12-16 10:53:10] INFO (nni/MainThread) Intermediate result: 18.628390857656246  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.813 | lsd:0.602 | ed:0.89 | hr@1:0.709 | hr@2:0.875 | hr@3:0.922 | acc@1:0.709 | acc@2:0.64 | acc@3:0.601 | Best krc: 0.808 | Best epoch: 8
best model saved
[2023-12-16 10:54:49] INFO (nni/MainThread) Intermediate result: 0.8133707320064995  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 18.26	mae: 14.4	mape: 98.03%	acc@10: 43.86%	acc@20: 75.12%	acc@30: 90.31%	
[2023-12-16 10:54:49] INFO (nni/MainThread) Intermediate result: 18.257345842645762  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.813 | lsd:0.592 | ed:0.873 | hr@1:0.712 | hr@2:0.877 | hr@3:0.924 | acc@1:0.712 | acc@2:0.647 | acc@3:0.613 | Best krc: 0.813 | Best epoch: 11
best model saved
[2023-12-16 10:56:27] INFO (nni/MainThread) Intermediate result: 0.8134745204268597  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.88	mae: 14.09	mape: 95.44%	acc@10: 45.01%	acc@20: 76.04%	acc@30: 90.77%	
[2023-12-16 10:56:27] INFO (nni/MainThread) Intermediate result: 17.87822828706677  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.815 | lsd:0.61 | ed:0.868 | hr@1:0.726 | hr@2:0.873 | hr@3:0.921 | acc@1:0.726 | acc@2:0.652 | acc@3:0.613 | Best krc: 0.813 | Best epoch: 12
best model saved
[2023-12-16 10:58:05] INFO (nni/MainThread) Intermediate result: 0.8151602893535557  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.57	mae: 13.87	mape: 94.09%	acc@10: 45.45%	acc@20: 76.88%	acc@30: 91.3%	
[2023-12-16 10:58:05] INFO (nni/MainThread) Intermediate result: 17.566641829221844  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.593 | ed:0.876 | hr@1:0.705 | hr@2:0.872 | hr@3:0.923 | acc@1:0.705 | acc@2:0.639 | acc@3:0.605 | Best krc: 0.815 | Best epoch: 13
[2023-12-16 10:59:44] INFO (nni/MainThread) Intermediate result: 0.8105269991146686  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.33	mae: 13.71	mape: 93.33%	acc@10: 45.78%	acc@20: 77.43%	acc@30: 91.68%	
[2023-12-16 10:59:44] INFO (nni/MainThread) Intermediate result: 17.33412219911299  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.819 | lsd:0.576 | ed:0.846 | hr@1:0.717 | hr@2:0.881 | hr@3:0.927 | acc@1:0.717 | acc@2:0.65 | acc@3:0.619 | Best krc: 0.815 | Best epoch: 13
best model saved
[2023-12-16 11:01:23] INFO (nni/MainThread) Intermediate result: 0.8187620890987745  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 17.08	mae: 13.53	mape: 92.09%	acc@10: 46.16%	acc@20: 78.12%	acc@30: 92.01%	
[2023-12-16 11:01:23] INFO (nni/MainThread) Intermediate result: 17.084164248020407  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.814 | lsd:0.586 | ed:0.885 | hr@1:0.703 | hr@2:0.881 | hr@3:0.927 | acc@1:0.703 | acc@2:0.635 | acc@3:0.603 | Best krc: 0.819 | Best epoch: 15
[2023-12-16 11:03:00] INFO (nni/MainThread) Intermediate result: 0.8141615245594256  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 16.83	mae: 13.33	mape: 90.66%	acc@10: 46.78%	acc@20: 78.85%	acc@30: 92.33%	
[2023-12-16 11:03:00] INFO (nni/MainThread) Intermediate result: 16.833321188938772  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.803 | lsd:0.606 | ed:0.918 | hr@1:0.714 | hr@2:0.874 | hr@3:0.923 | acc@1:0.714 | acc@2:0.636 | acc@3:0.595 | Best krc: 0.819 | Best epoch: 15
[2023-12-16 11:04:37] INFO (nni/MainThread) Intermediate result: 0.8033710243504735  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 16.64	mae: 13.17	mape: 89.44%	acc@10: 47.2%	acc@20: 79.44%	acc@30: 92.55%	
[2023-12-16 11:04:37] INFO (nni/MainThread) Intermediate result: 16.638916949694597  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.814 | lsd:0.615 | ed:0.885 | hr@1:0.738 | hr@2:0.871 | hr@3:0.924 | acc@1:0.738 | acc@2:0.65 | acc@3:0.615 | Best krc: 0.819 | Best epoch: 15
[2023-12-16 11:06:14] INFO (nni/MainThread) Intermediate result: 0.8140351381278358  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.5	mae: 13.07	mape: 88.85%	acc@10: 47.5%	acc@20: 79.84%	acc@30: 92.75%	
[2023-12-16 11:06:14] INFO (nni/MainThread) Intermediate result: 16.498075838655307  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.607 | ed:0.884 | hr@1:0.717 | hr@2:0.871 | hr@3:0.925 | acc@1:0.717 | acc@2:0.641 | acc@3:0.608 | Best krc: 0.819 | Best epoch: 15
[2023-12-16 11:07:50] INFO (nni/MainThread) Intermediate result: 0.8105394079596091  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.35	mae: 12.95	mape: 88.09%	acc@10: 47.91%	acc@20: 80.33%	acc@30: 92.96%	
[2023-12-16 11:07:50] INFO (nni/MainThread) Intermediate result: 16.35015317758077  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.792 | lsd:0.64 | ed:0.929 | hr@1:0.708 | hr@2:0.867 | hr@3:0.917 | acc@1:0.708 | acc@2:0.63 | acc@3:0.592 | Best krc: 0.819 | Best epoch: 15
[2023-12-16 11:09:27] INFO (nni/MainThread) Intermediate result: 0.7921138535305567  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.24	mae: 12.89	mape: 87.74%	acc@10: 47.94%	acc@20: 80.71%	acc@30: 93.16%	
[2023-12-16 11:09:27] INFO (nni/MainThread) Intermediate result: 16.23585161539704  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.807 | lsd:0.619 | ed:0.905 | hr@1:0.718 | hr@2:0.876 | hr@3:0.92 | acc@1:0.718 | acc@2:0.645 | acc@3:0.599 | Best krc: 0.819 | Best epoch: 15
[2023-12-16 11:11:05] INFO (nni/MainThread) Intermediate result: 0.8068137792667747  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.15	mae: 12.83	mape: 87.59%	acc@10: 48.01%	acc@20: 80.86%	acc@30: 93.32%	
[2023-12-16 11:11:05] INFO (nni/MainThread) Intermediate result: 16.150733235372403  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.81 | lsd:0.607 | ed:0.892 | hr@1:0.728 | hr@2:0.875 | hr@3:0.921 | acc@1:0.728 | acc@2:0.651 | acc@3:0.605 | Best krc: 0.819 | Best epoch: 15
[2023-12-16 11:12:42] INFO (nni/MainThread) Intermediate result: 0.8104522515978573  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.04	mae: 12.75	mape: 87.06%	acc@10: 48.13%	acc@20: 81.18%	acc@30: 93.46%	
[2023-12-16 11:12:42] INFO (nni/MainThread) Intermediate result: 16.039257341819198  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.809 | lsd:0.63 | ed:0.887 | hr@1:0.726 | hr@2:0.869 | hr@3:0.918 | acc@1:0.726 | acc@2:0.65 | acc@3:0.61 | Best krc: 0.819 | Best epoch: 15
[2023-12-16 11:14:18] INFO (nni/MainThread) Intermediate result: 0.8085412124677539  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 15.94	mae: 12.68	mape: 86.44%	acc@10: 48.36%	acc@20: 81.44%	acc@30: 93.63%	
[2023-12-16 11:14:18] INFO (nni/MainThread) Intermediate result: 15.937293568779362  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.811 | lsd:0.599 | ed:0.878 | hr@1:0.718 | hr@2:0.873 | hr@3:0.922 | acc@1:0.718 | acc@2:0.65 | acc@3:0.612 | Best krc: 0.819 | Best epoch: 15
[2023-12-16 11:15:56] INFO (nni/MainThread) Intermediate result: 0.8109471613100823  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 15.83	mae: 12.6	mape: 85.96%	acc@10: 48.59%	acc@20: 81.79%	acc@30: 93.78%	
[2023-12-16 11:15:56] INFO (nni/MainThread) Intermediate result: 15.82727620799646  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.791 | lsd:0.637 | ed:0.951 | hr@1:0.704 | hr@2:0.868 | hr@3:0.919 | acc@1:0.704 | acc@2:0.627 | acc@3:0.588 | Best krc: 0.819 | Best epoch: 15
[2023-12-16 11:17:34] INFO (nni/MainThread) Intermediate result: 0.7912698291360295  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 15.74	mae: 12.55	mape: 85.76%	acc@10: 48.66%	acc@20: 82.08%	acc@30: 93.9%	
[2023-12-16 11:17:34] INFO (nni/MainThread) Intermediate result: 15.74204993095063  (Index 51)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702719326.03704481702719326.0370576
best model loaded !!!
krc:0.812 | lsd:0.424 | ed:0.879 | hr@1:0.713 | hr@2:0.91 | hr@3:0.95 | acc@1:0.713 | acc@2:0.651 | acc@3:0.604 |

-------------------------------------------------------------
Best epoch for G2R:  15
Best epoch for ETPA:  25
graph2route_pd Evaluation in test: krc:0.812 | lsd:0.424 | ed:0.879 | hr@1:0.713 | hr@2:0.91 | hr@3:0.95 | acc@1:0.713 | acc@2:0.651 | acc@3:0.604 |
RankPETA Evaluation in test: rmse: 13.86	mae: 10.84	mape: 96.68%	acc@10: 52.32%	acc@20: 87.76%	acc@30: 96.2%	
