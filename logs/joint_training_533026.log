Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.683 | ed:1.024 | hr@1:0.625 | hr@2:0.86 | hr@3:0.904 | acc@1:0.625 | acc@2:0.567 | acc@3:0.528 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:28:20] INFO (nni/MainThread) Intermediate result: 0.7606692486447626  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 26.29	mae: 20.77	mape: 67.31%	acc@10: 29.63%	acc@20: 57.41%	acc@30: 76.3%	
[2023-12-01 18:28:20] INFO (nni/MainThread) Intermediate result: 26.289034639658343  (Index 1)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701451661.77625131701451661.7762673
best model loaded !!!
krc:0.752 | lsd:0.532 | ed:1.065 | hr@1:0.629 | hr@2:0.899 | hr@3:0.927 | acc@1:0.629 | acc@2:0.577 | acc@3:0.523 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.752 | lsd:0.532 | ed:1.065 | hr@1:0.629 | hr@2:0.899 | hr@3:0.927 | acc@1:0.629 | acc@2:0.577 | acc@3:0.523 |
RankPETA Evaluation in test: rmse: 21.65	mae: 17.64	mape: 69.89%	acc@10: 27.85%	acc@20: 63.71%	acc@30: 86.5%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.754 | lsd:0.714 | ed:1.057 | hr@1:0.614 | hr@2:0.857 | hr@3:0.906 | acc@1:0.614 | acc@2:0.555 | acc@3:0.516 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:29:12] INFO (nni/MainThread) Intermediate result: 0.7536149998764778  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 26.34	mae: 20.77	mape: 66.86%	acc@10: 29.26%	acc@20: 57.04%	acc@30: 76.67%	
[2023-12-01 18:29:12] INFO (nni/MainThread) Intermediate result: 26.339498192620574  (Index 3)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701451717.1194451701451717.1194596
best model loaded !!!
krc:0.76 | lsd:0.516 | ed:1.026 | hr@1:0.645 | hr@2:0.9 | hr@3:0.929 | acc@1:0.645 | acc@2:0.596 | acc@3:0.539 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.76 | lsd:0.516 | ed:1.026 | hr@1:0.645 | hr@2:0.9 | hr@3:0.929 | acc@1:0.645 | acc@2:0.596 | acc@3:0.539 |
RankPETA Evaluation in test: rmse: 21.68	mae: 17.65	mape: 70.05%	acc@10: 28.27%	acc@20: 63.71%	acc@30: 86.08%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.751 | lsd:0.716 | ed:1.063 | hr@1:0.612 | hr@2:0.857 | hr@3:0.902 | acc@1:0.612 | acc@2:0.551 | acc@3:0.512 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:30:13] INFO (nni/MainThread) Intermediate result: 0.7508123951062299  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.91	mae: 19.64	mape: 66.86%	acc@10: 30.74%	acc@20: 62.22%	acc@30: 79.63%	
[2023-12-01 18:30:13] INFO (nni/MainThread) Intermediate result: 24.906177707313525  (Index 5)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701451772.06299351701451772.063009
best model loaded !!!
krc:0.746 | lsd:0.539 | ed:1.092 | hr@1:0.627 | hr@2:0.898 | hr@3:0.928 | acc@1:0.627 | acc@2:0.573 | acc@3:0.517 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.746 | lsd:0.539 | ed:1.092 | hr@1:0.627 | hr@2:0.898 | hr@3:0.928 | acc@1:0.627 | acc@2:0.573 | acc@3:0.517 |
RankPETA Evaluation in test: rmse: 20.06	mae: 15.96	mape: 66.1%	acc@10: 38.4%	acc@20: 69.2%	acc@30: 88.61%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.745 | lsd:0.767 | ed:1.087 | hr@1:0.62 | hr@2:0.855 | hr@3:0.901 | acc@1:0.62 | acc@2:0.555 | acc@3:0.513 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:31:13] INFO (nni/MainThread) Intermediate result: 0.7447422761371165  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.9	mae: 19.61	mape: 65.95%	acc@10: 32.59%	acc@20: 62.59%	acc@30: 79.63%	
[2023-12-01 18:31:13] INFO (nni/MainThread) Intermediate result: 24.90060073556836  (Index 7)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701451832.79534241701451832.7953591
best model loaded !!!
krc:0.743 | lsd:0.547 | ed:1.089 | hr@1:0.624 | hr@2:0.897 | hr@3:0.927 | acc@1:0.624 | acc@2:0.573 | acc@3:0.519 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.743 | lsd:0.547 | ed:1.089 | hr@1:0.624 | hr@2:0.897 | hr@3:0.927 | acc@1:0.624 | acc@2:0.573 | acc@3:0.519 |
RankPETA Evaluation in test: rmse: 20.15	mae: 16.06	mape: 66.42%	acc@10: 37.97%	acc@20: 69.2%	acc@30: 88.61%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.702 | ed:1.021 | hr@1:0.629 | hr@2:0.859 | hr@3:0.906 | acc@1:0.629 | acc@2:0.57 | acc@3:0.533 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:32:05] INFO (nni/MainThread) Intermediate result: 0.7609118268409917  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 27.07	mae: 21.63	mape: 69.19%	acc@10: 27.41%	acc@20: 52.96%	acc@30: 75.19%	
[2023-12-01 18:32:05] INFO (nni/MainThread) Intermediate result: 27.072560332359014  (Index 9)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701451893.63440131701451893.6344178
best model loaded !!!
krc:0.758 | lsd:0.52 | ed:1.043 | hr@1:0.634 | hr@2:0.9 | hr@3:0.93 | acc@1:0.634 | acc@2:0.586 | acc@3:0.534 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.758 | lsd:0.52 | ed:1.043 | hr@1:0.634 | hr@2:0.9 | hr@3:0.93 | acc@1:0.634 | acc@2:0.586 | acc@3:0.534 |
RankPETA Evaluation in test: rmse: 23.24	mae: 19.03	mape: 74.32%	acc@10: 27.85%	acc@20: 58.65%	acc@30: 82.28%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.718 | ed:1.031 | hr@1:0.618 | hr@2:0.857 | hr@3:0.907 | acc@1:0.618 | acc@2:0.562 | acc@3:0.527 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:32:58] INFO (nni/MainThread) Intermediate result: 0.7591592886214661  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 27.14	mae: 21.72	mape: 69.74%	acc@10: 28.15%	acc@20: 53.33%	acc@30: 74.81%	
[2023-12-01 18:32:58] INFO (nni/MainThread) Intermediate result: 27.14016173323678  (Index 11)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701451944.95702821701451944.957044
best model loaded !!!
krc:0.754 | lsd:0.534 | ed:1.061 | hr@1:0.631 | hr@2:0.898 | hr@3:0.93 | acc@1:0.631 | acc@2:0.582 | acc@3:0.53 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.754 | lsd:0.534 | ed:1.061 | hr@1:0.631 | hr@2:0.898 | hr@3:0.93 | acc@1:0.631 | acc@2:0.582 | acc@3:0.53 |
RankPETA Evaluation in test: rmse: 23.35	mae: 19.15	mape: 74.73%	acc@10: 28.27%	acc@20: 57.81%	acc@30: 82.28%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.707 | ed:1.025 | hr@1:0.624 | hr@2:0.864 | hr@3:0.91 | acc@1:0.624 | acc@2:0.568 | acc@3:0.531 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:33:42] INFO (nni/MainThread) Intermediate result: 0.7606453676851579  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 23.33	mae: 17.34	mape: 56.35%	acc@10: 39.26%	acc@20: 66.67%	acc@30: 82.96%	
[2023-12-01 18:33:42] INFO (nni/MainThread) Intermediate result: 23.32702217126966  (Index 13)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701451993.50618671701451993.5061996
best model loaded !!!
krc:0.754 | lsd:0.527 | ed:1.064 | hr@1:0.635 | hr@2:0.901 | hr@3:0.929 | acc@1:0.635 | acc@2:0.582 | acc@3:0.527 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.754 | lsd:0.527 | ed:1.064 | hr@1:0.635 | hr@2:0.901 | hr@3:0.929 | acc@1:0.635 | acc@2:0.582 | acc@3:0.527 |
RankPETA Evaluation in test: rmse: 19.43	mae: 14.92	mape: 70.62%	acc@10: 41.35%	acc@20: 73.42%	acc@30: 89.87%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.754 | lsd:0.729 | ed:1.059 | hr@1:0.618 | hr@2:0.86 | hr@3:0.905 | acc@1:0.618 | acc@2:0.563 | acc@3:0.525 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:34:27] INFO (nni/MainThread) Intermediate result: 0.7544146019003911  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 23.39	mae: 17.35	mape: 56.34%	acc@10: 39.63%	acc@20: 66.3%	acc@30: 82.59%	
[2023-12-01 18:34:27] INFO (nni/MainThread) Intermediate result: 23.38695200161366  (Index 15)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701452038.5210891701452038.5211112
best model loaded !!!
krc:0.743 | lsd:0.562 | ed:1.108 | hr@1:0.63 | hr@2:0.895 | hr@3:0.924 | acc@1:0.63 | acc@2:0.573 | acc@3:0.515 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.743 | lsd:0.562 | ed:1.108 | hr@1:0.63 | hr@2:0.895 | hr@3:0.924 | acc@1:0.63 | acc@2:0.573 | acc@3:0.515 |
RankPETA Evaluation in test: rmse: 19.5	mae: 14.92	mape: 70.48%	acc@10: 41.77%	acc@20: 73.0%	acc@30: 89.87%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.753 | lsd:0.717 | ed:1.058 | hr@1:0.62 | hr@2:0.855 | hr@3:0.904 | acc@1:0.62 | acc@2:0.562 | acc@3:0.523 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:35:08] INFO (nni/MainThread) Intermediate result: 0.7529332673189254  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 26.1	mae: 20.61	mape: 67.11%	acc@10: 30.37%	acc@20: 57.41%	acc@30: 77.04%	
[2023-12-01 18:35:08] INFO (nni/MainThread) Intermediate result: 26.10135087649919  (Index 17)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701452081.53134321701452081.5313582
best model loaded !!!
krc:0.749 | lsd:0.547 | ed:1.069 | hr@1:0.63 | hr@2:0.896 | hr@3:0.926 | acc@1:0.63 | acc@2:0.582 | acc@3:0.525 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.749 | lsd:0.547 | ed:1.069 | hr@1:0.63 | hr@2:0.896 | hr@3:0.926 | acc@1:0.63 | acc@2:0.582 | acc@3:0.525 |
RankPETA Evaluation in test: rmse: 21.41	mae: 17.39	mape: 69.01%	acc@10: 28.69%	acc@20: 64.56%	acc@30: 86.5%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.712 | ed:1.035 | hr@1:0.624 | hr@2:0.853 | hr@3:0.9 | acc@1:0.624 | acc@2:0.563 | acc@3:0.523 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:35:52] INFO (nni/MainThread) Intermediate result: 0.7610949254149955  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 26.21	mae: 20.67	mape: 66.75%	acc@10: 30.0%	acc@20: 57.41%	acc@30: 76.67%	
[2023-12-01 18:35:52] INFO (nni/MainThread) Intermediate result: 26.21293653889597  (Index 19)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701452123.75755021701452123.7575724
best model loaded !!!
krc:0.748 | lsd:0.545 | ed:1.074 | hr@1:0.629 | hr@2:0.899 | hr@3:0.925 | acc@1:0.629 | acc@2:0.58 | acc@3:0.525 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.748 | lsd:0.545 | ed:1.074 | hr@1:0.629 | hr@2:0.899 | hr@3:0.925 | acc@1:0.629 | acc@2:0.58 | acc@3:0.525 |
RankPETA Evaluation in test: rmse: 21.51	mae: 17.49	mape: 69.67%	acc@10: 28.69%	acc@20: 64.14%	acc@30: 86.5%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.728 | lsd:0.831 | ed:1.118 | hr@1:0.61 | hr@2:0.846 | hr@3:0.891 | acc@1:0.61 | acc@2:0.543 | acc@3:0.494 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:36:33] INFO (nni/MainThread) Intermediate result: 0.7279056398426751  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.66	mae: 19.39	mape: 66.18%	acc@10: 32.59%	acc@20: 62.59%	acc@30: 79.63%	
[2023-12-01 18:36:33] INFO (nni/MainThread) Intermediate result: 24.66249227857203  (Index 21)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701452167.94915271701452167.9491692
best model loaded !!!
krc:0.723 | lsd:0.603 | ed:1.138 | hr@1:0.626 | hr@2:0.885 | hr@3:0.917 | acc@1:0.626 | acc@2:0.563 | acc@3:0.502 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.723 | lsd:0.603 | ed:1.138 | hr@1:0.626 | hr@2:0.885 | hr@3:0.917 | acc@1:0.626 | acc@2:0.563 | acc@3:0.502 |
RankPETA Evaluation in test: rmse: 19.8	mae: 15.7	mape: 65.65%	acc@10: 38.82%	acc@20: 70.46%	acc@30: 88.61%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.729 | lsd:0.818 | ed:1.122 | hr@1:0.608 | hr@2:0.847 | hr@3:0.891 | acc@1:0.608 | acc@2:0.541 | acc@3:0.493 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:37:13] INFO (nni/MainThread) Intermediate result: 0.7290667081222396  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.67	mae: 19.36	mape: 65.46%	acc@10: 33.33%	acc@20: 62.96%	acc@30: 79.63%	
[2023-12-01 18:37:13] INFO (nni/MainThread) Intermediate result: 24.665489099936018  (Index 23)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701452208.08761841701452208.0876453
best model loaded !!!
krc:0.723 | lsd:0.607 | ed:1.142 | hr@1:0.623 | hr@2:0.886 | hr@3:0.916 | acc@1:0.623 | acc@2:0.562 | acc@3:0.499 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.723 | lsd:0.607 | ed:1.142 | hr@1:0.623 | hr@2:0.886 | hr@3:0.916 | acc@1:0.623 | acc@2:0.562 | acc@3:0.499 |
RankPETA Evaluation in test: rmse: 19.87	mae: 15.78	mape: 65.88%	acc@10: 38.82%	acc@20: 70.04%	acc@30: 88.61%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.693 | ed:1.028 | hr@1:0.631 | hr@2:0.859 | hr@3:0.905 | acc@1:0.631 | acc@2:0.57 | acc@3:0.53 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:37:55] INFO (nni/MainThread) Intermediate result: 0.7591711085720704  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 27.05	mae: 21.6	mape: 69.22%	acc@10: 27.78%	acc@20: 53.33%	acc@30: 75.19%	
[2023-12-01 18:37:55] INFO (nni/MainThread) Intermediate result: 27.0493154499073  (Index 25)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701452248.45028761701452248.4503026
best model loaded !!!
krc:0.757 | lsd:0.522 | ed:1.048 | hr@1:0.637 | hr@2:0.9 | hr@3:0.93 | acc@1:0.637 | acc@2:0.588 | acc@3:0.534 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.757 | lsd:0.522 | ed:1.048 | hr@1:0.637 | hr@2:0.9 | hr@3:0.93 | acc@1:0.637 | acc@2:0.588 | acc@3:0.534 |
RankPETA Evaluation in test: rmse: 23.2	mae: 19.03	mape: 74.6%	acc@10: 27.85%	acc@20: 58.65%	acc@30: 82.28%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.689 | ed:1.024 | hr@1:0.632 | hr@2:0.862 | hr@3:0.908 | acc@1:0.632 | acc@2:0.571 | acc@3:0.532 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:38:54] INFO (nni/MainThread) Intermediate result: 0.7618732178767159  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 27.09	mae: 21.64	mape: 69.22%	acc@10: 28.15%	acc@20: 52.96%	acc@30: 74.81%	
[2023-12-01 18:38:54] INFO (nni/MainThread) Intermediate result: 27.089672234947308  (Index 27)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701452291.28973751701452291.289755
best model loaded !!!
krc:0.757 | lsd:0.516 | ed:1.036 | hr@1:0.639 | hr@2:0.899 | hr@3:0.931 | acc@1:0.639 | acc@2:0.591 | acc@3:0.539 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.757 | lsd:0.516 | ed:1.036 | hr@1:0.639 | hr@2:0.899 | hr@3:0.931 | acc@1:0.639 | acc@2:0.591 | acc@3:0.539 |
RankPETA Evaluation in test: rmse: 23.28	mae: 19.08	mape: 74.75%	acc@10: 27.85%	acc@20: 58.65%	acc@30: 83.12%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.756 | lsd:0.696 | ed:1.025 | hr@1:0.625 | hr@2:0.86 | hr@3:0.906 | acc@1:0.625 | acc@2:0.568 | acc@3:0.526 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:39:38] INFO (nni/MainThread) Intermediate result: 0.7563708344644069  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 23.31	mae: 17.3	mape: 56.2%	acc@10: 39.63%	acc@20: 66.67%	acc@30: 82.59%	
[2023-12-01 18:39:38] INFO (nni/MainThread) Intermediate result: 23.31271206756761  (Index 29)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701452349.79538081701452349.795397
best model loaded !!!
krc:0.754 | lsd:0.523 | ed:1.064 | hr@1:0.63 | hr@2:0.9 | hr@3:0.93 | acc@1:0.63 | acc@2:0.576 | acc@3:0.524 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.754 | lsd:0.523 | ed:1.064 | hr@1:0.63 | hr@2:0.9 | hr@3:0.93 | acc@1:0.63 | acc@2:0.576 | acc@3:0.524 |
RankPETA Evaluation in test: rmse: 19.41	mae: 14.9	mape: 70.9%	acc@10: 41.35%	acc@20: 73.0%	acc@30: 89.87%	
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.714 | ed:1.021 | hr@1:0.626 | hr@2:0.862 | hr@3:0.907 | acc@1:0.626 | acc@2:0.572 | acc@3:0.536 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 18:40:29] INFO (nni/MainThread) Intermediate result: 0.7630559069911933  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 23.31	mae: 17.29	mape: 56.54%	acc@10: 40.37%	acc@20: 66.67%	acc@30: 82.96%	
[2023-12-01 18:40:30] INFO (nni/MainThread) Intermediate result: 23.307492288475476  (Index 31)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701452392.81654981701452392.8165815
best model loaded !!!
krc:0.757 | lsd:0.522 | ed:1.061 | hr@1:0.639 | hr@2:0.899 | hr@3:0.928 | acc@1:0.639 | acc@2:0.584 | acc@3:0.53 |

-------------------------------------------------------------
Best epoch for G2R:  0
Best epoch for ETPA:  0
graph2route_pd Evaluation in test: krc:0.757 | lsd:0.522 | ed:1.061 | hr@1:0.639 | hr@2:0.899 | hr@3:0.928 | acc@1:0.639 | acc@2:0.584 | acc@3:0.53 |
RankPETA Evaluation in test: rmse: 19.34	mae: 14.78	mape: 70.0%	acc@10: 42.19%	acc@20: 73.42%	acc@30: 89.87%	
