Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 64,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 100,
 'num_head': 4,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 8888,
 'sort_mode': 'pnn_order',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.713 | ed:1.024 | hr@1:0.631 | hr@2:0.863 | hr@3:0.907 | acc@1:0.631 | acc@2:0.573 | acc@3:0.531 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-05 17:15:03] INFO (nni/MainThread) Intermediate result: 0.7586070361321782  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.28	mae: 19.27	mape: 70.52%	acc@10: 30.0%	acc@20: 64.07%	acc@30: 82.22%	
[2023-12-05 17:15:03] INFO (nni/MainThread) Intermediate result: 24.283602685248333  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.695 | ed:1.03 | hr@1:0.629 | hr@2:0.861 | hr@3:0.906 | acc@1:0.629 | acc@2:0.57 | acc@3:0.529 | Best krc: 0.759 | Best epoch: 0
best model saved
[2023-12-05 17:15:28] INFO (nni/MainThread) Intermediate result: 0.7612826943740805  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 26.13	mae: 19.4	mape: 101.37%	acc@10: 34.07%	acc@20: 66.11%	acc@30: 82.59%	
[2023-12-05 17:15:28] INFO (nni/MainThread) Intermediate result: 26.134500288120595  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.757 | lsd:0.717 | ed:1.03 | hr@1:0.626 | hr@2:0.855 | hr@3:0.903 | acc@1:0.626 | acc@2:0.563 | acc@3:0.523 | Best krc: 0.761 | Best epoch: 1
[2023-12-05 17:15:52] INFO (nni/MainThread) Intermediate result: 0.7568671591408801  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 24.94	mae: 18.84	mape: 105.44%	acc@10: 35.43%	acc@20: 66.42%	acc@30: 81.85%	
[2023-12-05 17:15:52] INFO (nni/MainThread) Intermediate result: 24.939183271527526  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.7 | ed:1.017 | hr@1:0.636 | hr@2:0.866 | hr@3:0.909 | acc@1:0.636 | acc@2:0.581 | acc@3:0.537 | Best krc: 0.761 | Best epoch: 1
best model saved
[2023-12-05 17:16:16] INFO (nni/MainThread) Intermediate result: 0.7669994282062492  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 25.18	mae: 19.04	mape: 115.89%	acc@10: 34.07%	acc@20: 65.0%	acc@30: 82.41%	
[2023-12-05 17:16:16] INFO (nni/MainThread) Intermediate result: 25.178483339675132  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.679 | ed:1.006 | hr@1:0.631 | hr@2:0.863 | hr@3:0.909 | acc@1:0.631 | acc@2:0.575 | acc@3:0.538 | Best krc: 0.767 | Best epoch: 3
[2023-12-05 17:16:39] INFO (nni/MainThread) Intermediate result: 0.7644459276816076  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 24.95	mae: 19.07	mape: 122.06%	acc@10: 33.33%	acc@20: 63.78%	acc@30: 82.37%	
[2023-12-05 17:16:39] INFO (nni/MainThread) Intermediate result: 24.948826877661972  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.678 | ed:0.973 | hr@1:0.638 | hr@2:0.865 | hr@3:0.911 | acc@1:0.638 | acc@2:0.582 | acc@3:0.551 | Best krc: 0.767 | Best epoch: 3
best model saved
[2023-12-05 17:17:03] INFO (nni/MainThread) Intermediate result: 0.7735310931113293  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 24.48	mae: 18.89	mape: 125.31%	acc@10: 32.96%	acc@20: 63.46%	acc@30: 82.47%	
[2023-12-05 17:17:03] INFO (nni/MainThread) Intermediate result: 24.478414347678907  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.758 | lsd:0.711 | ed:1.015 | hr@1:0.628 | hr@2:0.858 | hr@3:0.906 | acc@1:0.628 | acc@2:0.572 | acc@3:0.533 | Best krc: 0.774 | Best epoch: 5
[2023-12-05 17:17:27] INFO (nni/MainThread) Intermediate result: 0.75813734662882  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 23.75	mae: 18.5	mape: 125.25%	acc@10: 32.91%	acc@20: 63.65%	acc@30: 83.39%	
[2023-12-05 17:17:27] INFO (nni/MainThread) Intermediate result: 23.751166940665772  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.703 | ed:1.012 | hr@1:0.628 | hr@2:0.857 | hr@3:0.907 | acc@1:0.628 | acc@2:0.568 | acc@3:0.533 | Best krc: 0.774 | Best epoch: 5
[2023-12-05 17:17:50] INFO (nni/MainThread) Intermediate result: 0.7633650205403594  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 23.31	mae: 18.27	mape: 125.77%	acc@10: 32.87%	acc@20: 63.94%	acc@30: 83.7%	
[2023-12-05 17:17:50] INFO (nni/MainThread) Intermediate result: 23.309846312130894  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.693 | ed:1.006 | hr@1:0.633 | hr@2:0.858 | hr@3:0.908 | acc@1:0.633 | acc@2:0.574 | acc@3:0.54 | Best krc: 0.774 | Best epoch: 5
[2023-12-05 17:18:14] INFO (nni/MainThread) Intermediate result: 0.7655189753484464  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 22.85	mae: 18.03	mape: 125.53%	acc@10: 32.92%	acc@20: 63.99%	acc@30: 84.24%	
[2023-12-05 17:18:14] INFO (nni/MainThread) Intermediate result: 22.845389546642192  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.667 | ed:0.979 | hr@1:0.633 | hr@2:0.864 | hr@3:0.911 | acc@1:0.633 | acc@2:0.577 | acc@3:0.544 | Best krc: 0.774 | Best epoch: 5
[2023-12-05 17:18:37] INFO (nni/MainThread) Intermediate result: 0.7710812085451351  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 22.51	mae: 17.87	mape: 125.84%	acc@10: 32.96%	acc@20: 63.81%	acc@30: 84.63%	
[2023-12-05 17:18:37] INFO (nni/MainThread) Intermediate result: 22.507683346962054  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.694 | ed:1.022 | hr@1:0.627 | hr@2:0.861 | hr@3:0.908 | acc@1:0.627 | acc@2:0.57 | acc@3:0.531 | Best krc: 0.774 | Best epoch: 5
[2023-12-05 17:19:01] INFO (nni/MainThread) Intermediate result: 0.7586996915374703  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 21.96	mae: 17.5	mape: 124.31%	acc@10: 33.6%	acc@20: 64.68%	acc@30: 85.66%	
[2023-12-05 17:19:01] INFO (nni/MainThread) Intermediate result: 21.961668352769113  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.68 | ed:0.983 | hr@1:0.645 | hr@2:0.865 | hr@3:0.911 | acc@1:0.645 | acc@2:0.586 | acc@3:0.551 | Best krc: 0.774 | Best epoch: 5
[2023-12-05 17:19:24] INFO (nni/MainThread) Intermediate result: 0.7721855727714932  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 21.79	mae: 17.44	mape: 124.94%	acc@10: 33.3%	acc@20: 64.38%	acc@30: 85.9%	
[2023-12-05 17:19:25] INFO (nni/MainThread) Intermediate result: 21.791925803131214  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.656 | ed:0.978 | hr@1:0.641 | hr@2:0.868 | hr@3:0.915 | acc@1:0.641 | acc@2:0.582 | acc@3:0.548 | Best krc: 0.774 | Best epoch: 5
[2023-12-05 17:19:49] INFO (nni/MainThread) Intermediate result: 0.7728184122150015  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 21.45	mae: 17.21	mape: 124.09%	acc@10: 33.68%	acc@20: 64.7%	acc@30: 86.55%	
[2023-12-05 17:19:49] INFO (nni/MainThread) Intermediate result: 21.451303458451125  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.66 | ed:0.979 | hr@1:0.634 | hr@2:0.866 | hr@3:0.913 | acc@1:0.634 | acc@2:0.58 | acc@3:0.543 | Best krc: 0.774 | Best epoch: 5
[2023-12-05 17:20:12] INFO (nni/MainThread) Intermediate result: 0.7660301987280561  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 21.07	mae: 16.94	mape: 122.66%	acc@10: 34.21%	acc@20: 65.58%	acc@30: 87.17%	
[2023-12-05 17:20:12] INFO (nni/MainThread) Intermediate result: 21.07183023821695  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.739 | lsd:0.779 | ed:1.085 | hr@1:0.614 | hr@2:0.854 | hr@3:0.896 | acc@1:0.614 | acc@2:0.557 | acc@3:0.512 | Best krc: 0.774 | Best epoch: 5
[2023-12-05 17:20:36] INFO (nni/MainThread) Intermediate result: 0.7390031559073973  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 20.75	mae: 16.71	mape: 121.54%	acc@10: 34.72%	acc@20: 66.27%	acc@30: 87.73%	
[2023-12-05 17:20:36] INFO (nni/MainThread) Intermediate result: 20.75003454106823  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.651 | ed:0.981 | hr@1:0.641 | hr@2:0.867 | hr@3:0.913 | acc@1:0.641 | acc@2:0.585 | acc@3:0.544 | Best krc: 0.774 | Best epoch: 5
[2023-12-05 17:21:00] INFO (nni/MainThread) Intermediate result: 0.7691170776785119  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 20.56	mae: 16.58	mape: 121.09%	acc@10: 34.93%	acc@20: 66.53%	acc@30: 88.08%	
[2023-12-05 17:21:00] INFO (nni/MainThread) Intermediate result: 20.555482990256305  (Index 31)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701792878.4980981701792878.4981074
best model loaded !!!
krc:0.761 | lsd:0.511 | ed:1.032 | hr@1:0.635 | hr@2:0.898 | hr@3:0.932 | acc@1:0.635 | acc@2:0.588 | acc@3:0.534 |

-------------------------------------------------------------
Best epoch for G2R:  5
Best epoch for ETPA:  15
graph2route_pd Evaluation in test: krc:0.761 | lsd:0.511 | ed:1.032 | hr@1:0.635 | hr@2:0.898 | hr@3:0.932 | acc@1:0.635 | acc@2:0.588 | acc@3:0.534 |
RankPETA Evaluation in test: rmse: 17.58	mae: 14.3	mape: 127.2%	acc@10: 39.66%	acc@20: 72.57%	acc@30: 91.98%	
