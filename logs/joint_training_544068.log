Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 8888,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.752 | lsd:0.732 | ed:1.029 | hr@1:0.624 | hr@2:0.855 | hr@3:0.9 | acc@1:0.624 | acc@2:0.565 | acc@3:0.524 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-18 10:06:29] INFO (nni/MainThread) Intermediate result: 0.7520895428722276  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.6	mae: 18.95	mape: 65.68%	acc@10: 32.22%	acc@20: 62.59%	acc@30: 79.63%	
[2023-12-18 10:06:29] INFO (nni/MainThread) Intermediate result: 24.604458834350535  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.726 | ed:1.015 | hr@1:0.634 | hr@2:0.858 | hr@3:0.902 | acc@1:0.634 | acc@2:0.579 | acc@3:0.535 | Best krc: 0.752 | Best epoch: 0
best model saved
[2023-12-18 10:06:54] INFO (nni/MainThread) Intermediate result: 0.7596866515887069  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 24.42	mae: 17.96	mape: 87.54%	acc@10: 38.33%	acc@20: 67.41%	acc@30: 81.48%	
[2023-12-18 10:06:54] INFO (nni/MainThread) Intermediate result: 24.42262196054091  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.758 | lsd:0.707 | ed:1.018 | hr@1:0.63 | hr@2:0.857 | hr@3:0.906 | acc@1:0.63 | acc@2:0.572 | acc@3:0.534 | Best krc: 0.76 | Best epoch: 1
[2023-12-18 10:07:17] INFO (nni/MainThread) Intermediate result: 0.7581528358441344  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 23.01	mae: 17.07	mape: 94.25%	acc@10: 40.49%	acc@20: 69.51%	acc@30: 83.58%	
[2023-12-18 10:07:17] INFO (nni/MainThread) Intermediate result: 23.008420366008306  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.681 | ed:1.006 | hr@1:0.631 | hr@2:0.862 | hr@3:0.908 | acc@1:0.631 | acc@2:0.571 | acc@3:0.533 | Best krc: 0.76 | Best epoch: 1
best model saved
[2023-12-18 10:07:42] INFO (nni/MainThread) Intermediate result: 0.7668611917322018  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 21.86	mae: 16.45	mape: 97.65%	acc@10: 40.83%	acc@20: 70.65%	acc@30: 84.63%	
[2023-12-18 10:07:42] INFO (nni/MainThread) Intermediate result: 21.860346497289825  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.685 | ed:1.012 | hr@1:0.63 | hr@2:0.863 | hr@3:0.906 | acc@1:0.63 | acc@2:0.572 | acc@3:0.53 | Best krc: 0.767 | Best epoch: 3
[2023-12-18 10:08:05] INFO (nni/MainThread) Intermediate result: 0.7641224868509522  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 21.02	mae: 16.03	mape: 99.09%	acc@10: 40.3%	acc@20: 71.63%	acc@30: 85.85%	
[2023-12-18 10:08:05] INFO (nni/MainThread) Intermediate result: 21.01524604903309  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.708 | ed:1.009 | hr@1:0.638 | hr@2:0.862 | hr@3:0.908 | acc@1:0.638 | acc@2:0.581 | acc@3:0.538 | Best krc: 0.767 | Best epoch: 3
best model saved
[2023-12-18 10:08:30] INFO (nni/MainThread) Intermediate result: 0.7693490855449753  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 20.22	mae: 15.53	mape: 98.59%	acc@10: 41.54%	acc@20: 72.65%	acc@30: 86.85%	
[2023-12-18 10:08:30] INFO (nni/MainThread) Intermediate result: 20.21648899910741  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.723 | ed:1.031 | hr@1:0.632 | hr@2:0.86 | hr@3:0.906 | acc@1:0.632 | acc@2:0.575 | acc@3:0.533 | Best krc: 0.769 | Best epoch: 5
[2023-12-18 10:08:53] INFO (nni/MainThread) Intermediate result: 0.7585224689640957  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 19.65	mae: 15.13	mape: 97.83%	acc@10: 42.49%	acc@20: 73.6%	acc@30: 87.41%	
[2023-12-18 10:08:53] INFO (nni/MainThread) Intermediate result: 19.646369188725124  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.692 | ed:1.018 | hr@1:0.633 | hr@2:0.861 | hr@3:0.906 | acc@1:0.633 | acc@2:0.575 | acc@3:0.53 | Best krc: 0.769 | Best epoch: 5
[2023-12-18 10:09:17] INFO (nni/MainThread) Intermediate result: 0.7592493894548988  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.06	mae: 14.71	mape: 96.29%	acc@10: 43.52%	acc@20: 74.77%	acc@30: 88.33%	
[2023-12-18 10:09:17] INFO (nni/MainThread) Intermediate result: 19.05773334226217  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.684 | ed:1.004 | hr@1:0.628 | hr@2:0.862 | hr@3:0.908 | acc@1:0.628 | acc@2:0.572 | acc@3:0.535 | Best krc: 0.769 | Best epoch: 5
[2023-12-18 10:09:41] INFO (nni/MainThread) Intermediate result: 0.7661708716715274  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.55	mae: 14.34	mape: 94.48%	acc@10: 44.49%	acc@20: 75.8%	acc@30: 89.22%	
[2023-12-18 10:09:41] INFO (nni/MainThread) Intermediate result: 18.545088553866933  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.687 | ed:0.998 | hr@1:0.632 | hr@2:0.861 | hr@3:0.907 | acc@1:0.632 | acc@2:0.578 | acc@3:0.538 | Best krc: 0.769 | Best epoch: 5
[2023-12-18 10:10:04] INFO (nni/MainThread) Intermediate result: 0.7654512039645404  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.13	mae: 14.06	mape: 93.27%	acc@10: 44.96%	acc@20: 76.56%	acc@30: 90.0%	
[2023-12-18 10:10:04] INFO (nni/MainThread) Intermediate result: 18.130113967309157  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.668 | ed:0.99 | hr@1:0.634 | hr@2:0.863 | hr@3:0.908 | acc@1:0.634 | acc@2:0.576 | acc@3:0.54 | Best krc: 0.769 | Best epoch: 5
best model saved
[2023-12-18 10:10:29] INFO (nni/MainThread) Intermediate result: 0.7726911825643787  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 17.79	mae: 13.82	mape: 92.15%	acc@10: 45.52%	acc@20: 77.24%	acc@30: 90.51%	
[2023-12-18 10:10:29] INFO (nni/MainThread) Intermediate result: 17.794928803567352  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.688 | ed:1.004 | hr@1:0.632 | hr@2:0.864 | hr@3:0.908 | acc@1:0.632 | acc@2:0.575 | acc@3:0.535 | Best krc: 0.773 | Best epoch: 10
[2023-12-18 10:10:53] INFO (nni/MainThread) Intermediate result: 0.765615207801478  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.49	mae: 13.6	mape: 91.05%	acc@10: 45.99%	acc@20: 77.78%	acc@30: 90.99%	
[2023-12-18 10:10:53] INFO (nni/MainThread) Intermediate result: 17.494486734270193  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.665 | ed:0.979 | hr@1:0.64 | hr@2:0.867 | hr@3:0.913 | acc@1:0.64 | acc@2:0.579 | acc@3:0.544 | Best krc: 0.773 | Best epoch: 10
best model saved
[2023-12-18 10:11:18] INFO (nni/MainThread) Intermediate result: 0.7733229319062287  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.24	mae: 13.4	mape: 89.88%	acc@10: 46.67%	acc@20: 78.32%	acc@30: 91.34%	
[2023-12-18 10:11:18] INFO (nni/MainThread) Intermediate result: 17.235729960363994  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.675 | ed:0.985 | hr@1:0.635 | hr@2:0.866 | hr@3:0.912 | acc@1:0.635 | acc@2:0.579 | acc@3:0.543 | Best krc: 0.773 | Best epoch: 12
[2023-12-18 10:11:43] INFO (nni/MainThread) Intermediate result: 0.7667063982673952  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.07	mae: 13.28	mape: 89.44%	acc@10: 47.06%	acc@20: 78.65%	acc@30: 91.61%	
[2023-12-18 10:11:43] INFO (nni/MainThread) Intermediate result: 17.065555604522856  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.679 | ed:0.973 | hr@1:0.641 | hr@2:0.865 | hr@3:0.907 | acc@1:0.641 | acc@2:0.589 | acc@3:0.549 | Best krc: 0.773 | Best epoch: 12
[2023-12-18 10:12:07] INFO (nni/MainThread) Intermediate result: 0.769223162786783  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 16.93	mae: 13.19	mape: 89.19%	acc@10: 47.21%	acc@20: 78.94%	acc@30: 91.83%	
[2023-12-18 10:12:07] INFO (nni/MainThread) Intermediate result: 16.93097639051274  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.664 | ed:0.976 | hr@1:0.639 | hr@2:0.869 | hr@3:0.914 | acc@1:0.639 | acc@2:0.585 | acc@3:0.55 | Best krc: 0.773 | Best epoch: 12
[2023-12-18 10:12:31] INFO (nni/MainThread) Intermediate result: 0.773129975176324  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 16.76	mae: 13.05	mape: 88.02%	acc@10: 47.64%	acc@20: 79.14%	acc@30: 92.01%	
[2023-12-18 10:12:31] INFO (nni/MainThread) Intermediate result: 16.75973904364071  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.659 | ed:0.964 | hr@1:0.639 | hr@2:0.871 | hr@3:0.915 | acc@1:0.639 | acc@2:0.589 | acc@3:0.556 | Best krc: 0.773 | Best epoch: 12
best model saved
[2023-12-18 10:12:56] INFO (nni/MainThread) Intermediate result: 0.7773458373720725  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 16.64	mae: 12.95	mape: 87.31%	acc@10: 47.95%	acc@20: 79.39%	acc@30: 92.14%	
[2023-12-18 10:12:56] INFO (nni/MainThread) Intermediate result: 16.63720334936369  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.657 | ed:0.974 | hr@1:0.641 | hr@2:0.868 | hr@3:0.913 | acc@1:0.641 | acc@2:0.588 | acc@3:0.549 | Best krc: 0.777 | Best epoch: 16
[2023-12-18 10:13:21] INFO (nni/MainThread) Intermediate result: 0.7769448715141763  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 16.51	mae: 12.86	mape: 86.71%	acc@10: 48.15%	acc@20: 79.57%	acc@30: 92.33%	
[2023-12-18 10:13:21] INFO (nni/MainThread) Intermediate result: 16.510014353152066  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.733 | ed:1.013 | hr@1:0.636 | hr@2:0.864 | hr@3:0.909 | acc@1:0.636 | acc@2:0.58 | acc@3:0.539 | Best krc: 0.777 | Best epoch: 16
[2023-12-18 10:13:46] INFO (nni/MainThread) Intermediate result: 0.7647342652327347  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.4	mae: 12.79	mape: 86.36%	acc@10: 48.4%	acc@20: 79.82%	acc@30: 92.5%	
[2023-12-18 10:13:46] INFO (nni/MainThread) Intermediate result: 16.40262897968178  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.756 | lsd:0.728 | ed:1.022 | hr@1:0.627 | hr@2:0.855 | hr@3:0.905 | acc@1:0.627 | acc@2:0.573 | acc@3:0.527 | Best krc: 0.777 | Best epoch: 16
[2023-12-18 10:14:10] INFO (nni/MainThread) Intermediate result: 0.7561118105849195  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.32	mae: 12.73	mape: 85.9%	acc@10: 48.61%	acc@20: 79.96%	acc@30: 92.61%	
[2023-12-18 10:14:10] INFO (nni/MainThread) Intermediate result: 16.320448664937537  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.697 | ed:1.007 | hr@1:0.623 | hr@2:0.859 | hr@3:0.908 | acc@1:0.623 | acc@2:0.571 | acc@3:0.537 | Best krc: 0.777 | Best epoch: 16
[2023-12-18 10:14:34] INFO (nni/MainThread) Intermediate result: 0.7619462698955485  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.24	mae: 12.65	mape: 84.9%	acc@10: 48.98%	acc@20: 80.07%	acc@30: 92.73%	
[2023-12-18 10:14:34] INFO (nni/MainThread) Intermediate result: 16.235137212389585  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.686 | ed:1.002 | hr@1:0.629 | hr@2:0.866 | hr@3:0.911 | acc@1:0.629 | acc@2:0.578 | acc@3:0.543 | Best krc: 0.777 | Best epoch: 16
[2023-12-18 10:14:59] INFO (nni/MainThread) Intermediate result: 0.7691268132020209  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.17	mae: 12.59	mape: 84.59%	acc@10: 49.21%	acc@20: 80.19%	acc@30: 92.85%	
[2023-12-18 10:14:59] INFO (nni/MainThread) Intermediate result: 16.168605865221934  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.694 | ed:1.006 | hr@1:0.639 | hr@2:0.865 | hr@3:0.908 | acc@1:0.639 | acc@2:0.582 | acc@3:0.54 | Best krc: 0.777 | Best epoch: 16
[2023-12-18 10:15:23] INFO (nni/MainThread) Intermediate result: 0.7654949989361882  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.1	mae: 12.54	mape: 84.06%	acc@10: 49.45%	acc@20: 80.29%	acc@30: 92.91%	
[2023-12-18 10:15:23] INFO (nni/MainThread) Intermediate result: 16.101576368310504  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.758 | lsd:0.691 | ed:1.037 | hr@1:0.62 | hr@2:0.861 | hr@3:0.906 | acc@1:0.62 | acc@2:0.565 | acc@3:0.526 | Best krc: 0.777 | Best epoch: 16
[2023-12-18 10:15:48] INFO (nni/MainThread) Intermediate result: 0.7579979660172051  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 16.0	mae: 12.46	mape: 83.33%	acc@10: 49.75%	acc@20: 80.56%	acc@30: 93.06%	
[2023-12-18 10:15:48] INFO (nni/MainThread) Intermediate result: 15.99698051198527  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.675 | ed:0.993 | hr@1:0.633 | hr@2:0.864 | hr@3:0.909 | acc@1:0.633 | acc@2:0.576 | acc@3:0.537 | Best krc: 0.777 | Best epoch: 16
[2023-12-18 10:16:13] INFO (nni/MainThread) Intermediate result: 0.7655328383094016  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 15.92	mae: 12.41	mape: 83.05%	acc@10: 49.87%	acc@20: 80.71%	acc@30: 93.19%	
[2023-12-18 10:16:13] INFO (nni/MainThread) Intermediate result: 15.917773539027195  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.66 | ed:0.954 | hr@1:0.646 | hr@2:0.867 | hr@3:0.914 | acc@1:0.646 | acc@2:0.589 | acc@3:0.553 | Best krc: 0.777 | Best epoch: 16
best model saved
[2023-12-18 10:16:39] INFO (nni/MainThread) Intermediate result: 0.7801752546308732  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 15.83	mae: 12.34	mape: 82.33%	acc@10: 50.19%	acc@20: 80.93%	acc@30: 93.28%	
[2023-12-18 10:16:39] INFO (nni/MainThread) Intermediate result: 15.834236420809015  (Index 51)
*** Epoch: 26 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.682 | ed:0.994 | hr@1:0.635 | hr@2:0.864 | hr@3:0.912 | acc@1:0.635 | acc@2:0.574 | acc@3:0.535 | Best krc: 0.78 | Best epoch: 25
[2023-12-18 10:17:06] INFO (nni/MainThread) Intermediate result: 0.77067210817976  (Index 52)
-----------------ETPA RESULT-------------------
Epoch 26: Validation	rmse: 15.78	mae: 12.3	mape: 82.07%	acc@10: 50.22%	acc@20: 81.06%	acc@30: 93.36%	
[2023-12-18 10:17:06] INFO (nni/MainThread) Intermediate result: 15.780180503966069  (Index 53)
*** Epoch: 27 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.694 | ed:1.021 | hr@1:0.63 | hr@2:0.862 | hr@3:0.907 | acc@1:0.63 | acc@2:0.572 | acc@3:0.533 | Best krc: 0.78 | Best epoch: 25
[2023-12-18 10:17:32] INFO (nni/MainThread) Intermediate result: 0.7593717364596246  (Index 54)
-----------------ETPA RESULT-------------------
Epoch 27: Validation	rmse: 15.76	mae: 12.3	mape: 82.32%	acc@10: 50.17%	acc@20: 81.04%	acc@30: 93.43%	
[2023-12-18 10:17:32] INFO (nni/MainThread) Intermediate result: 15.764197334500864  (Index 55)
*** Epoch: 28 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.651 | ed:0.963 | hr@1:0.645 | hr@2:0.865 | hr@3:0.91 | acc@1:0.645 | acc@2:0.589 | acc@3:0.546 | Best krc: 0.78 | Best epoch: 25
[2023-12-18 10:17:59] INFO (nni/MainThread) Intermediate result: 0.7758564533815955  (Index 56)
-----------------ETPA RESULT-------------------
Epoch 28: Validation	rmse: 15.71	mae: 12.26	mape: 81.93%	acc@10: 50.36%	acc@20: 81.12%	acc@30: 93.5%	
[2023-12-18 10:17:59] INFO (nni/MainThread) Intermediate result: 15.710698997300105  (Index 57)
*** Epoch: 29 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.669 | ed:0.963 | hr@1:0.648 | hr@2:0.866 | hr@3:0.912 | acc@1:0.648 | acc@2:0.591 | acc@3:0.555 | Best krc: 0.78 | Best epoch: 25
[2023-12-18 10:18:25] INFO (nni/MainThread) Intermediate result: 0.7784212538825569  (Index 58)
-----------------ETPA RESULT-------------------
Epoch 29: Validation	rmse: 15.64	mae: 12.21	mape: 81.46%	acc@10: 50.54%	acc@20: 81.26%	acc@30: 93.6%	
[2023-12-18 10:18:25] INFO (nni/MainThread) Intermediate result: 15.638220304706623  (Index 59)
*** Epoch: 30 ***
-----------------G2R RESULT-------------------

val result: krc:0.757 | lsd:0.738 | ed:1.05 | hr@1:0.64 | hr@2:0.857 | hr@3:0.901 | acc@1:0.64 | acc@2:0.576 | acc@3:0.525 | Best krc: 0.78 | Best epoch: 25
[2023-12-18 10:18:50] INFO (nni/MainThread) Intermediate result: 0.7566207735162698  (Index 60)
-----------------ETPA RESULT-------------------
Epoch 30: Validation	rmse: 15.6	mae: 12.18	mape: 81.31%	acc@10: 50.57%	acc@20: 81.33%	acc@30: 93.68%	
[2023-12-18 10:18:50] INFO (nni/MainThread) Intermediate result: 15.5961417006459  (Index 61)
*** Epoch: 31 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.649 | ed:0.952 | hr@1:0.642 | hr@2:0.867 | hr@3:0.912 | acc@1:0.642 | acc@2:0.591 | acc@3:0.557 | Best krc: 0.78 | Best epoch: 25
best model saved
[2023-12-18 10:19:16] INFO (nni/MainThread) Intermediate result: 0.7802672072457818  (Index 62)
-----------------ETPA RESULT-------------------
Epoch 31: Validation	rmse: 15.53	mae: 12.12	mape: 80.66%	acc@10: 50.78%	acc@20: 81.49%	acc@30: 93.75%	
[2023-12-18 10:19:16] INFO (nni/MainThread) Intermediate result: 15.534515453802989  (Index 63)
*** Epoch: 32 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.681 | ed:0.964 | hr@1:0.641 | hr@2:0.869 | hr@3:0.915 | acc@1:0.641 | acc@2:0.588 | acc@3:0.553 | Best krc: 0.78 | Best epoch: 31
[2023-12-18 10:19:42] INFO (nni/MainThread) Intermediate result: 0.7798907879275173  (Index 64)
-----------------ETPA RESULT-------------------
Epoch 32: Validation	rmse: 15.5	mae: 12.11	mape: 80.73%	acc@10: 50.71%	acc@20: 81.52%	acc@30: 93.83%	
[2023-12-18 10:19:42] INFO (nni/MainThread) Intermediate result: 15.50412511640031  (Index 65)
*** Epoch: 33 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.726 | ed:1.014 | hr@1:0.637 | hr@2:0.865 | hr@3:0.907 | acc@1:0.637 | acc@2:0.575 | acc@3:0.531 | Best krc: 0.78 | Best epoch: 31
[2023-12-18 10:20:07] INFO (nni/MainThread) Intermediate result: 0.7649983455143052  (Index 66)
-----------------ETPA RESULT-------------------
Epoch 33: Validation	rmse: 15.45	mae: 12.07	mape: 80.43%	acc@10: 50.83%	acc@20: 81.6%	acc@30: 93.91%	
[2023-12-18 10:20:07] INFO (nni/MainThread) Intermediate result: 15.453570919918514  (Index 67)
*** Epoch: 34 ***
-----------------G2R RESULT-------------------

val result: krc:0.781 | lsd:0.643 | ed:0.951 | hr@1:0.641 | hr@2:0.871 | hr@3:0.914 | acc@1:0.641 | acc@2:0.588 | acc@3:0.556 | Best krc: 0.78 | Best epoch: 31
best model saved
[2023-12-18 10:20:35] INFO (nni/MainThread) Intermediate result: 0.780877301778045  (Index 68)
-----------------ETPA RESULT-------------------
Epoch 34: Validation	rmse: 15.42	mae: 12.05	mape: 80.34%	acc@10: 50.85%	acc@20: 81.69%	acc@30: 93.96%	
[2023-12-18 10:20:35] INFO (nni/MainThread) Intermediate result: 15.417831400564069  (Index 69)
*** Epoch: 35 ***
-----------------G2R RESULT-------------------

val result: krc:0.786 | lsd:0.643 | ed:0.928 | hr@1:0.653 | hr@2:0.869 | hr@3:0.915 | acc@1:0.653 | acc@2:0.6 | acc@3:0.567 | Best krc: 0.781 | Best epoch: 34
best model saved
[2023-12-18 10:21:03] INFO (nni/MainThread) Intermediate result: 0.7861245062731727  (Index 70)
-----------------ETPA RESULT-------------------
Epoch 35: Validation	rmse: 15.36	mae: 12.01	mape: 80.04%	acc@10: 50.97%	acc@20: 81.83%	acc@30: 94.03%	
[2023-12-18 10:21:03] INFO (nni/MainThread) Intermediate result: 15.364131696456338  (Index 71)
*** Epoch: 36 ***
-----------------G2R RESULT-------------------

val result: krc:0.786 | lsd:0.663 | ed:0.932 | hr@1:0.652 | hr@2:0.871 | hr@3:0.917 | acc@1:0.652 | acc@2:0.596 | acc@3:0.565 | Best krc: 0.786 | Best epoch: 35
[2023-12-18 10:21:29] INFO (nni/MainThread) Intermediate result: 0.7855008940273479  (Index 72)
-----------------ETPA RESULT-------------------
Epoch 36: Validation	rmse: 15.32	mae: 11.97	mape: 79.66%	acc@10: 51.1%	acc@20: 81.94%	acc@30: 94.1%	
[2023-12-18 10:21:29] INFO (nni/MainThread) Intermediate result: 15.316764713072304  (Index 73)
*** Epoch: 37 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.655 | ed:0.971 | hr@1:0.646 | hr@2:0.869 | hr@3:0.912 | acc@1:0.646 | acc@2:0.589 | acc@3:0.554 | Best krc: 0.786 | Best epoch: 35
[2023-12-18 10:21:54] INFO (nni/MainThread) Intermediate result: 0.774876527381993  (Index 74)
-----------------ETPA RESULT-------------------
Epoch 37: Validation	rmse: 15.28	mae: 11.93	mape: 79.34%	acc@10: 51.26%	acc@20: 82.01%	acc@30: 94.14%	
[2023-12-18 10:21:54] INFO (nni/MainThread) Intermediate result: 15.276600023771575  (Index 75)
*** Epoch: 38 ***
-----------------G2R RESULT-------------------

val result: krc:0.787 | lsd:0.639 | ed:0.935 | hr@1:0.649 | hr@2:0.872 | hr@3:0.917 | acc@1:0.649 | acc@2:0.595 | acc@3:0.565 | Best krc: 0.786 | Best epoch: 35
best model saved
[2023-12-18 10:22:20] INFO (nni/MainThread) Intermediate result: 0.786896544159334  (Index 76)
-----------------ETPA RESULT-------------------
Epoch 38: Validation	rmse: 15.22	mae: 11.89	mape: 78.89%	acc@10: 51.36%	acc@20: 82.14%	acc@30: 94.23%	
[2023-12-18 10:22:20] INFO (nni/MainThread) Intermediate result: 15.217888370606905  (Index 77)
*** Epoch: 39 ***
-----------------G2R RESULT-------------------

val result: krc:0.786 | lsd:0.643 | ed:0.934 | hr@1:0.654 | hr@2:0.87 | hr@3:0.916 | acc@1:0.654 | acc@2:0.599 | acc@3:0.564 | Best krc: 0.787 | Best epoch: 38
[2023-12-18 10:22:45] INFO (nni/MainThread) Intermediate result: 0.785703219677859  (Index 78)
-----------------ETPA RESULT-------------------
Epoch 39: Validation	rmse: 15.19	mae: 11.87	mape: 78.79%	acc@10: 51.44%	acc@20: 82.15%	acc@30: 94.26%	
[2023-12-18 10:22:45] INFO (nni/MainThread) Intermediate result: 15.193999723723275  (Index 79)
*** Epoch: 40 ***
-----------------G2R RESULT-------------------

val result: krc:0.786 | lsd:0.644 | ed:0.938 | hr@1:0.654 | hr@2:0.87 | hr@3:0.916 | acc@1:0.654 | acc@2:0.596 | acc@3:0.561 | Best krc: 0.787 | Best epoch: 38
[2023-12-18 10:23:11] INFO (nni/MainThread) Intermediate result: 0.7858290314521184  (Index 80)
-----------------ETPA RESULT-------------------
Epoch 40: Validation	rmse: 15.17	mae: 11.85	mape: 78.59%	acc@10: 51.53%	acc@20: 82.18%	acc@30: 94.28%	
[2023-12-18 10:23:11] INFO (nni/MainThread) Intermediate result: 15.17174144427806  (Index 81)
*** Epoch: 41 ***
-----------------G2R RESULT-------------------

val result: krc:0.785 | lsd:0.632 | ed:0.941 | hr@1:0.652 | hr@2:0.869 | hr@3:0.916 | acc@1:0.652 | acc@2:0.594 | acc@3:0.558 | Best krc: 0.787 | Best epoch: 38
[2023-12-18 10:23:37] INFO (nni/MainThread) Intermediate result: 0.7849807683126442  (Index 82)
-----------------ETPA RESULT-------------------
Epoch 41: Validation	rmse: 15.14	mae: 11.82	mape: 78.36%	acc@10: 51.64%	acc@20: 82.22%	acc@30: 94.32%	
[2023-12-18 10:23:37] INFO (nni/MainThread) Intermediate result: 15.137943984400613  (Index 83)
*** Epoch: 42 ***
-----------------G2R RESULT-------------------

val result: krc:0.757 | lsd:0.711 | ed:1.037 | hr@1:0.64 | hr@2:0.864 | hr@3:0.907 | acc@1:0.64 | acc@2:0.576 | acc@3:0.527 | Best krc: 0.787 | Best epoch: 38
[2023-12-18 10:24:03] INFO (nni/MainThread) Intermediate result: 0.7568273650914664  (Index 84)
-----------------ETPA RESULT-------------------
Epoch 42: Validation	rmse: 15.1	mae: 11.79	mape: 78.16%	acc@10: 51.7%	acc@20: 82.29%	acc@30: 94.38%	
[2023-12-18 10:24:03] INFO (nni/MainThread) Intermediate result: 15.104239768118724  (Index 85)
*** Epoch: 43 ***
-----------------G2R RESULT-------------------

val result: krc:0.787 | lsd:0.637 | ed:0.928 | hr@1:0.657 | hr@2:0.87 | hr@3:0.917 | acc@1:0.657 | acc@2:0.599 | acc@3:0.567 | Best krc: 0.787 | Best epoch: 38
[2023-12-18 10:24:29] INFO (nni/MainThread) Intermediate result: 0.7866333837824875  (Index 86)
-----------------ETPA RESULT-------------------
Epoch 43: Validation	rmse: 15.06	mae: 11.76	mape: 77.82%	acc@10: 51.78%	acc@20: 82.42%	acc@30: 94.43%	
[2023-12-18 10:24:29] INFO (nni/MainThread) Intermediate result: 15.061447051974168  (Index 87)
*** Epoch: 44 ***
-----------------G2R RESULT-------------------

val result: krc:0.783 | lsd:0.667 | ed:0.949 | hr@1:0.651 | hr@2:0.87 | hr@3:0.915 | acc@1:0.651 | acc@2:0.596 | acc@3:0.558 | Best krc: 0.787 | Best epoch: 38
[2023-12-18 10:24:54] INFO (nni/MainThread) Intermediate result: 0.7834391762507197  (Index 88)
-----------------ETPA RESULT-------------------
Epoch 44: Validation	rmse: 15.05	mae: 11.75	mape: 77.89%	acc@10: 51.77%	acc@20: 82.44%	acc@30: 94.45%	
[2023-12-18 10:24:54] INFO (nni/MainThread) Intermediate result: 15.0460986119785  (Index 89)
*** Epoch: 45 ***
-----------------G2R RESULT-------------------

val result: krc:0.786 | lsd:0.64 | ed:0.942 | hr@1:0.65 | hr@2:0.869 | hr@3:0.917 | acc@1:0.65 | acc@2:0.593 | acc@3:0.561 | Best krc: 0.787 | Best epoch: 38
[2023-12-18 10:25:19] INFO (nni/MainThread) Intermediate result: 0.7855070408546577  (Index 90)
-----------------ETPA RESULT-------------------
Epoch 45: Validation	rmse: 15.03	mae: 11.75	mape: 77.98%	acc@10: 51.7%	acc@20: 82.48%	acc@30: 94.49%	
[2023-12-18 10:25:19] INFO (nni/MainThread) Intermediate result: 15.031311217232282  (Index 91)
*** Epoch: 46 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.685 | ed:1.015 | hr@1:0.638 | hr@2:0.866 | hr@3:0.909 | acc@1:0.638 | acc@2:0.578 | acc@3:0.537 | Best krc: 0.787 | Best epoch: 38
[2023-12-18 10:25:45] INFO (nni/MainThread) Intermediate result: 0.7652156433179608  (Index 92)
-----------------ETPA RESULT-------------------
Epoch 46: Validation	rmse: 15.0	mae: 11.73	mape: 77.84%	acc@10: 51.71%	acc@20: 82.55%	acc@30: 94.55%	
[2023-12-18 10:25:45] INFO (nni/MainThread) Intermediate result: 15.001051589485447  (Index 93)
*** Epoch: 47 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.66 | ed:1.007 | hr@1:0.64 | hr@2:0.864 | hr@3:0.91 | acc@1:0.64 | acc@2:0.579 | acc@3:0.537 | Best krc: 0.787 | Best epoch: 38
[2023-12-18 10:26:10] INFO (nni/MainThread) Intermediate result: 0.7675227248904554  (Index 94)
-----------------ETPA RESULT-------------------
Epoch 47: Validation	rmse: 14.97	mae: 11.71	mape: 77.64%	acc@10: 51.81%	acc@20: 82.61%	acc@30: 94.57%	
[2023-12-18 10:26:10] INFO (nni/MainThread) Intermediate result: 14.972415145495185  (Index 95)
*** Epoch: 48 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.646 | ed:0.963 | hr@1:0.651 | hr@2:0.871 | hr@3:0.914 | acc@1:0.651 | acc@2:0.595 | acc@3:0.556 | Best krc: 0.787 | Best epoch: 38
[2023-12-18 10:26:35] INFO (nni/MainThread) Intermediate result: 0.7804865593846791  (Index 96)
-----------------ETPA RESULT-------------------
Epoch 48: Validation	rmse: 14.96	mae: 11.7	mape: 77.65%	acc@10: 51.78%	acc@20: 82.65%	acc@30: 94.58%	
[2023-12-18 10:26:35] INFO (nni/MainThread) Intermediate result: 14.959755412932639  (Index 97)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702890361.17158441702890361.171599
best model loaded !!!
krc:0.781 | lsd:0.472 | ed:0.953 | hr@1:0.666 | hr@2:0.907 | hr@3:0.94 | acc@1:0.666 | acc@2:0.615 | acc@3:0.567 |

-------------------------------------------------------------
Best epoch for G2R:  38
Best epoch for ETPA:  48
graph2route_pd Evaluation in test: krc:0.781 | lsd:0.472 | ed:0.953 | hr@1:0.666 | hr@2:0.907 | hr@3:0.94 | acc@1:0.666 | acc@2:0.615 | acc@3:0.567 |
RankPETA Evaluation in test: rmse: 12.88	mae: 9.87	mape: 85.57%	acc@10: 59.49%	acc@20: 89.45%	acc@30: 97.05%	
