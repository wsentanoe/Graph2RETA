Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 1999,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.698 | lsd:0.944 | ed:1.192 | hr@1:0.599 | hr@2:0.824 | hr@3:0.871 | acc@1:0.599 | acc@2:0.526 | acc@3:0.473 | Best krc: -1 | Best epoch: -1
best model saved
[2024-01-09 23:00:29] INFO (nni/MainThread) Intermediate result: 0.6977601821327225  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.18	mae: 18.92	mape: 69.44%	acc@10: 38.89%	acc@20: 61.48%	acc@30: 78.89%	
[2024-01-09 23:00:29] INFO (nni/MainThread) Intermediate result: 24.177772793738157  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.688 | ed:1.044 | hr@1:0.629 | hr@2:0.858 | hr@3:0.906 | acc@1:0.629 | acc@2:0.568 | acc@3:0.527 | Best krc: 0.698 | Best epoch: 0
best model saved
[2024-01-09 23:00:55] INFO (nni/MainThread) Intermediate result: 0.759044022262212  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 22.05	mae: 17.14	mape: 87.4%	acc@10: 41.11%	acc@20: 65.37%	acc@30: 84.26%	
[2024-01-09 23:00:55] INFO (nni/MainThread) Intermediate result: 22.050782796792763  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.701 | ed:1.004 | hr@1:0.634 | hr@2:0.859 | hr@3:0.908 | acc@1:0.634 | acc@2:0.575 | acc@3:0.535 | Best krc: 0.759 | Best epoch: 1
best model saved
[2024-01-09 23:01:22] INFO (nni/MainThread) Intermediate result: 0.763225961555651  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 21.88	mae: 16.97	mape: 99.49%	acc@10: 41.48%	acc@20: 66.17%	acc@30: 84.57%	
[2024-01-09 23:01:22] INFO (nni/MainThread) Intermediate result: 21.87832423689161  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.711 | ed:1.032 | hr@1:0.624 | hr@2:0.86 | hr@3:0.906 | acc@1:0.624 | acc@2:0.571 | acc@3:0.529 | Best krc: 0.763 | Best epoch: 2
[2024-01-09 23:01:48] INFO (nni/MainThread) Intermediate result: 0.7626154350596852  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 20.91	mae: 16.11	mape: 97.85%	acc@10: 43.8%	acc@20: 68.52%	acc@30: 85.19%	
[2024-01-09 23:01:48] INFO (nni/MainThread) Intermediate result: 20.908562187836516  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.712 | ed:1.011 | hr@1:0.638 | hr@2:0.858 | hr@3:0.907 | acc@1:0.638 | acc@2:0.577 | acc@3:0.532 | Best krc: 0.763 | Best epoch: 2
[2024-01-09 23:02:14] INFO (nni/MainThread) Intermediate result: 0.7595918590146836  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 20.26	mae: 15.63	mape: 98.55%	acc@10: 44.3%	acc@20: 70.15%	acc@30: 86.37%	
[2024-01-09 23:02:14] INFO (nni/MainThread) Intermediate result: 20.26290082831694  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.682 | ed:0.963 | hr@1:0.638 | hr@2:0.86 | hr@3:0.908 | acc@1:0.638 | acc@2:0.588 | acc@3:0.55 | Best krc: 0.763 | Best epoch: 2
best model saved
[2024-01-09 23:02:42] INFO (nni/MainThread) Intermediate result: 0.7710875336585875  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 19.72	mae: 15.24	mape: 98.29%	acc@10: 45.0%	acc@20: 70.8%	acc@30: 87.04%	
[2024-01-09 23:02:42] INFO (nni/MainThread) Intermediate result: 19.71958542492763  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.684 | ed:0.979 | hr@1:0.639 | hr@2:0.866 | hr@3:0.914 | acc@1:0.639 | acc@2:0.583 | acc@3:0.547 | Best krc: 0.771 | Best epoch: 5
best model saved
[2024-01-09 23:03:10] INFO (nni/MainThread) Intermediate result: 0.7717169791940235  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 19.3	mae: 14.96	mape: 98.62%	acc@10: 45.24%	acc@20: 71.59%	acc@30: 87.57%	
[2024-01-09 23:03:10] INFO (nni/MainThread) Intermediate result: 19.295176473921536  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.695 | ed:1.016 | hr@1:0.634 | hr@2:0.859 | hr@3:0.906 | acc@1:0.634 | acc@2:0.575 | acc@3:0.537 | Best krc: 0.772 | Best epoch: 6
[2024-01-09 23:03:36] INFO (nni/MainThread) Intermediate result: 0.7613220516062668  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 18.79	mae: 14.59	mape: 96.9%	acc@10: 46.2%	acc@20: 72.78%	acc@30: 88.15%	
[2024-01-09 23:03:36] INFO (nni/MainThread) Intermediate result: 18.794249979679645  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.703 | ed:1.02 | hr@1:0.627 | hr@2:0.859 | hr@3:0.908 | acc@1:0.627 | acc@2:0.573 | acc@3:0.534 | Best krc: 0.772 | Best epoch: 6
[2024-01-09 23:04:02] INFO (nni/MainThread) Intermediate result: 0.7618985063584975  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.38	mae: 14.3	mape: 95.73%	acc@10: 46.75%	acc@20: 73.62%	acc@30: 88.93%	
[2024-01-09 23:04:02] INFO (nni/MainThread) Intermediate result: 18.377238974213007  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.718 | ed:1.021 | hr@1:0.624 | hr@2:0.858 | hr@3:0.904 | acc@1:0.624 | acc@2:0.573 | acc@3:0.533 | Best krc: 0.772 | Best epoch: 6
[2024-01-09 23:04:28] INFO (nni/MainThread) Intermediate result: 0.7600014884142563  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.2	mae: 14.24	mape: 96.67%	acc@10: 46.15%	acc@20: 73.67%	acc@30: 89.44%	
[2024-01-09 23:04:28] INFO (nni/MainThread) Intermediate result: 18.199168217469985  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.665 | ed:0.971 | hr@1:0.631 | hr@2:0.862 | hr@3:0.911 | acc@1:0.631 | acc@2:0.581 | acc@3:0.546 | Best krc: 0.772 | Best epoch: 6
best model saved
[2024-01-09 23:04:55] INFO (nni/MainThread) Intermediate result: 0.773772828735662  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 17.91	mae: 14.04	mape: 96.12%	acc@10: 46.33%	acc@20: 74.44%	acc@30: 90.0%	
[2024-01-09 23:04:55] INFO (nni/MainThread) Intermediate result: 17.908789749067495  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.681 | ed:0.989 | hr@1:0.638 | hr@2:0.861 | hr@3:0.907 | acc@1:0.638 | acc@2:0.582 | acc@3:0.546 | Best krc: 0.774 | Best epoch: 10
[2024-01-09 23:05:21] INFO (nni/MainThread) Intermediate result: 0.7709833737817995  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.6	mae: 13.82	mape: 94.99%	acc@10: 46.88%	acc@20: 75.19%	acc@30: 90.52%	
[2024-01-09 23:05:21] INFO (nni/MainThread) Intermediate result: 17.597398580044093  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.668 | ed:0.98 | hr@1:0.642 | hr@2:0.866 | hr@3:0.909 | acc@1:0.642 | acc@2:0.587 | acc@3:0.547 | Best krc: 0.774 | Best epoch: 10
[2024-01-09 23:05:47] INFO (nni/MainThread) Intermediate result: 0.7708417039243449  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.38	mae: 13.65	mape: 94.12%	acc@10: 47.41%	acc@20: 75.7%	acc@30: 90.91%	
[2024-01-09 23:05:47] INFO (nni/MainThread) Intermediate result: 17.37501255034245  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.658 | ed:0.983 | hr@1:0.637 | hr@2:0.86 | hr@3:0.909 | acc@1:0.637 | acc@2:0.58 | acc@3:0.547 | Best krc: 0.774 | Best epoch: 10
[2024-01-09 23:06:12] INFO (nni/MainThread) Intermediate result: 0.7696897832446585  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 17.18	mae: 13.52	mape: 93.28%	acc@10: 47.46%	acc@20: 76.16%	acc@30: 91.27%	
[2024-01-09 23:06:12] INFO (nni/MainThread) Intermediate result: 17.181833197618353  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.654 | ed:0.981 | hr@1:0.641 | hr@2:0.864 | hr@3:0.912 | acc@1:0.641 | acc@2:0.585 | acc@3:0.547 | Best krc: 0.774 | Best epoch: 10
best model saved
[2024-01-09 23:06:39] INFO (nni/MainThread) Intermediate result: 0.7748402123391193  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.04	mae: 13.44	mape: 93.04%	acc@10: 47.51%	acc@20: 76.4%	acc@30: 91.6%	
[2024-01-09 23:06:39] INFO (nni/MainThread) Intermediate result: 17.043436040107757  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.629 | ed:0.963 | hr@1:0.654 | hr@2:0.869 | hr@3:0.913 | acc@1:0.654 | acc@2:0.598 | acc@3:0.555 | Best krc: 0.775 | Best epoch: 14
best model saved
[2024-01-09 23:07:06] INFO (nni/MainThread) Intermediate result: 0.7804068994536856  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 16.88	mae: 13.33	mape: 92.24%	acc@10: 47.85%	acc@20: 76.85%	acc@30: 91.88%	
[2024-01-09 23:07:06] INFO (nni/MainThread) Intermediate result: 16.88101852583085  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.655 | ed:0.983 | hr@1:0.639 | hr@2:0.866 | hr@3:0.91 | acc@1:0.639 | acc@2:0.588 | acc@3:0.547 | Best krc: 0.78 | Best epoch: 15
[2024-01-09 23:07:32] INFO (nni/MainThread) Intermediate result: 0.7741469617202018  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 16.73	mae: 13.23	mape: 91.61%	acc@10: 48.0%	acc@20: 77.15%	acc@30: 92.22%	
[2024-01-09 23:07:32] INFO (nni/MainThread) Intermediate result: 16.72853670476897  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.687 | ed:0.981 | hr@1:0.636 | hr@2:0.861 | hr@3:0.906 | acc@1:0.636 | acc@2:0.584 | acc@3:0.544 | Best krc: 0.78 | Best epoch: 15
[2024-01-09 23:07:58] INFO (nni/MainThread) Intermediate result: 0.7710021640410797  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 16.59	mae: 13.13	mape: 90.86%	acc@10: 48.35%	acc@20: 77.53%	acc@30: 92.45%	
[2024-01-09 23:07:58] INFO (nni/MainThread) Intermediate result: 16.588892910618696  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.677 | ed:0.991 | hr@1:0.635 | hr@2:0.865 | hr@3:0.913 | acc@1:0.635 | acc@2:0.582 | acc@3:0.544 | Best krc: 0.78 | Best epoch: 15
[2024-01-09 23:08:24] INFO (nni/MainThread) Intermediate result: 0.7652523382300384  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.43	mae: 13.01	mape: 89.96%	acc@10: 48.81%	acc@20: 77.95%	acc@30: 92.65%	
[2024-01-09 23:08:24] INFO (nni/MainThread) Intermediate result: 16.434409454112007  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.685 | ed:0.991 | hr@1:0.636 | hr@2:0.864 | hr@3:0.909 | acc@1:0.636 | acc@2:0.583 | acc@3:0.542 | Best krc: 0.78 | Best epoch: 15
[2024-01-09 23:08:50] INFO (nni/MainThread) Intermediate result: 0.7668767699288032  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.31	mae: 12.92	mape: 89.44%	acc@10: 49.04%	acc@20: 78.35%	acc@30: 92.87%	
[2024-01-09 23:08:50] INFO (nni/MainThread) Intermediate result: 16.312137594985067  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.69 | ed:0.979 | hr@1:0.639 | hr@2:0.861 | hr@3:0.907 | acc@1:0.639 | acc@2:0.585 | acc@3:0.546 | Best krc: 0.78 | Best epoch: 15
[2024-01-09 23:09:16] INFO (nni/MainThread) Intermediate result: 0.7681179699019666  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.2	mae: 12.83	mape: 88.77%	acc@10: 49.28%	acc@20: 78.62%	acc@30: 93.05%	
[2024-01-09 23:09:16] INFO (nni/MainThread) Intermediate result: 16.199239059178236  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.681 | ed:0.975 | hr@1:0.638 | hr@2:0.865 | hr@3:0.906 | acc@1:0.638 | acc@2:0.587 | acc@3:0.544 | Best krc: 0.78 | Best epoch: 15
[2024-01-09 23:09:42] INFO (nni/MainThread) Intermediate result: 0.7699715035001435  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.09	mae: 12.75	mape: 88.25%	acc@10: 49.53%	acc@20: 78.96%	acc@30: 93.2%	
[2024-01-09 23:09:42] INFO (nni/MainThread) Intermediate result: 16.093149506641392  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.668 | ed:0.963 | hr@1:0.64 | hr@2:0.866 | hr@3:0.911 | acc@1:0.64 | acc@2:0.59 | acc@3:0.553 | Best krc: 0.78 | Best epoch: 15
[2024-01-09 23:10:08] INFO (nni/MainThread) Intermediate result: 0.7729713312485503  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.01	mae: 12.68	mape: 87.81%	acc@10: 49.71%	acc@20: 79.11%	acc@30: 93.4%	
[2024-01-09 23:10:08] INFO (nni/MainThread) Intermediate result: 16.005929459438963  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.668 | ed:0.962 | hr@1:0.641 | hr@2:0.864 | hr@3:0.911 | acc@1:0.641 | acc@2:0.589 | acc@3:0.555 | Best krc: 0.78 | Best epoch: 15
[2024-01-09 23:10:35] INFO (nni/MainThread) Intermediate result: 0.773758180797971  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 15.93	mae: 12.63	mape: 87.49%	acc@10: 49.74%	acc@20: 79.34%	acc@30: 93.5%	
[2024-01-09 23:10:35] INFO (nni/MainThread) Intermediate result: 15.931482763726715  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.673 | ed:0.976 | hr@1:0.639 | hr@2:0.862 | hr@3:0.912 | acc@1:0.639 | acc@2:0.584 | acc@3:0.551 | Best krc: 0.78 | Best epoch: 15
[2024-01-09 23:11:01] INFO (nni/MainThread) Intermediate result: 0.7708974583045418  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 15.87	mae: 12.58	mape: 87.16%	acc@10: 49.99%	acc@20: 79.56%	acc@30: 93.61%	
[2024-01-09 23:11:01] INFO (nni/MainThread) Intermediate result: 15.865400024634537  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.663 | ed:0.969 | hr@1:0.637 | hr@2:0.863 | hr@3:0.913 | acc@1:0.637 | acc@2:0.582 | acc@3:0.551 | Best krc: 0.78 | Best epoch: 15
[2024-01-09 23:11:28] INFO (nni/MainThread) Intermediate result: 0.772580336148329  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 15.81	mae: 12.53	mape: 86.84%	acc@10: 50.1%	acc@20: 79.66%	acc@30: 93.69%	
[2024-01-09 23:11:28] INFO (nni/MainThread) Intermediate result: 15.806424302533209  (Index 51)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1704837601.50432471704837601.5043368
best model loaded !!!
krc:0.762 | lsd:0.508 | ed:1.018 | hr@1:0.648 | hr@2:0.902 | hr@3:0.936 | acc@1:0.648 | acc@2:0.594 | acc@3:0.549 |

-------------------------------------------------------------
Best epoch for G2R:  15
Best epoch for ETPA:  25
graph2route_pd Evaluation in test: krc:0.762 | lsd:0.508 | ed:1.018 | hr@1:0.648 | hr@2:0.902 | hr@3:0.936 | acc@1:0.648 | acc@2:0.594 | acc@3:0.549 |
RankPETA Evaluation in test: rmse: 12.94	mae: 10.28	mape: 90.22%	acc@10: 57.38%	acc@20: 86.08%	acc@30: 97.89%	
