Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 8888,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.756 | lsd:0.725 | ed:1.026 | hr@1:0.631 | hr@2:0.856 | hr@3:0.904 | acc@1:0.631 | acc@2:0.577 | acc@3:0.532 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-16 09:16:54] INFO (nni/MainThread) Intermediate result: 0.7559780150860169  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 24.65	mae: 18.97	mape: 65.08%	acc@10: 35.56%	acc@20: 62.22%	acc@30: 79.26%	
[2023-12-16 09:16:54] INFO (nni/MainThread) Intermediate result: 24.64701238946746  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.678 | ed:0.993 | hr@1:0.635 | hr@2:0.864 | hr@3:0.908 | acc@1:0.635 | acc@2:0.579 | acc@3:0.54 | Best krc: 0.756 | Best epoch: 0
best model saved
[2023-12-16 09:17:18] INFO (nni/MainThread) Intermediate result: 0.7680095906943305  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 24.84	mae: 18.31	mape: 88.87%	acc@10: 39.07%	acc@20: 65.74%	acc@30: 80.74%	
[2023-12-16 09:17:18] INFO (nni/MainThread) Intermediate result: 24.838649609703673  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.697 | ed:1.02 | hr@1:0.63 | hr@2:0.859 | hr@3:0.905 | acc@1:0.63 | acc@2:0.572 | acc@3:0.528 | Best krc: 0.768 | Best epoch: 1
[2023-12-16 09:17:42] INFO (nni/MainThread) Intermediate result: 0.7623662515398414  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 23.45	mae: 17.41	mape: 96.05%	acc@10: 40.37%	acc@20: 67.78%	acc@30: 82.72%	
[2023-12-16 09:17:42] INFO (nni/MainThread) Intermediate result: 23.449572926826864  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.754 | lsd:0.714 | ed:1.032 | hr@1:0.625 | hr@2:0.857 | hr@3:0.904 | acc@1:0.625 | acc@2:0.569 | acc@3:0.529 | Best krc: 0.768 | Best epoch: 1
[2023-12-16 09:18:05] INFO (nni/MainThread) Intermediate result: 0.7535534141480797  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 22.21	mae: 16.76	mape: 98.9%	acc@10: 40.37%	acc@20: 69.35%	acc@30: 84.07%	
[2023-12-16 09:18:05] INFO (nni/MainThread) Intermediate result: 22.20830976682863  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.686 | ed:0.994 | hr@1:0.623 | hr@2:0.863 | hr@3:0.906 | acc@1:0.623 | acc@2:0.571 | acc@3:0.532 | Best krc: 0.768 | Best epoch: 1
[2023-12-16 09:18:29] INFO (nni/MainThread) Intermediate result: 0.7663587574387749  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 21.57	mae: 16.53	mape: 102.5%	acc@10: 39.26%	acc@20: 69.41%	acc@30: 84.74%	
[2023-12-16 09:18:29] INFO (nni/MainThread) Intermediate result: 21.572641557402356  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.711 | ed:1.028 | hr@1:0.624 | hr@2:0.859 | hr@3:0.905 | acc@1:0.624 | acc@2:0.565 | acc@3:0.523 | Best krc: 0.768 | Best epoch: 1
[2023-12-16 09:18:53] INFO (nni/MainThread) Intermediate result: 0.758796466614569  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 20.95	mae: 16.21	mape: 103.45%	acc@10: 39.32%	acc@20: 70.43%	acc@30: 85.62%	
[2023-12-16 09:18:53] INFO (nni/MainThread) Intermediate result: 20.950012533346445  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.676 | ed:0.983 | hr@1:0.63 | hr@2:0.863 | hr@3:0.908 | acc@1:0.63 | acc@2:0.576 | acc@3:0.538 | Best krc: 0.768 | Best epoch: 1
best model saved
[2023-12-16 09:19:17] INFO (nni/MainThread) Intermediate result: 0.7680104724179934  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 20.45	mae: 15.93	mape: 103.72%	acc@10: 39.37%	acc@20: 71.01%	acc@30: 86.3%	
[2023-12-16 09:19:17] INFO (nni/MainThread) Intermediate result: 20.449397077886825  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.693 | ed:0.982 | hr@1:0.637 | hr@2:0.864 | hr@3:0.907 | acc@1:0.637 | acc@2:0.579 | acc@3:0.543 | Best krc: 0.768 | Best epoch: 6
[2023-12-16 09:19:41] INFO (nni/MainThread) Intermediate result: 0.7676787608575979  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 19.66	mae: 15.36	mape: 100.79%	acc@10: 40.79%	acc@20: 72.22%	acc@30: 87.69%	
[2023-12-16 09:19:41] INFO (nni/MainThread) Intermediate result: 19.659082453372296  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.676 | ed:0.978 | hr@1:0.633 | hr@2:0.862 | hr@3:0.908 | acc@1:0.633 | acc@2:0.578 | acc@3:0.542 | Best krc: 0.768 | Best epoch: 6
best model saved
[2023-12-16 09:20:06] INFO (nni/MainThread) Intermediate result: 0.7691888613095433  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 18.93	mae: 14.79	mape: 97.49%	acc@10: 42.59%	acc@20: 73.99%	acc@30: 88.81%	
[2023-12-16 09:20:06] INFO (nni/MainThread) Intermediate result: 18.928675747226393  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.765 | lsd:0.683 | ed:1.001 | hr@1:0.631 | hr@2:0.864 | hr@3:0.913 | acc@1:0.631 | acc@2:0.57 | acc@3:0.536 | Best krc: 0.769 | Best epoch: 8
[2023-12-16 09:20:30] INFO (nni/MainThread) Intermediate result: 0.765281435110906  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 18.36	mae: 14.37	mape: 95.33%	acc@10: 43.59%	acc@20: 75.33%	acc@30: 89.74%	
[2023-12-16 09:20:30] INFO (nni/MainThread) Intermediate result: 18.362844605990333  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.663 | ed:0.943 | hr@1:0.644 | hr@2:0.868 | hr@3:0.913 | acc@1:0.644 | acc@2:0.591 | acc@3:0.557 | Best krc: 0.769 | Best epoch: 8
best model saved
[2023-12-16 09:20:55] INFO (nni/MainThread) Intermediate result: 0.7783923391706514  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 17.91	mae: 14.02	mape: 93.51%	acc@10: 44.71%	acc@20: 76.4%	acc@30: 90.47%	
[2023-12-16 09:20:55] INFO (nni/MainThread) Intermediate result: 17.90565925195881  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.659 | ed:0.972 | hr@1:0.634 | hr@2:0.866 | hr@3:0.912 | acc@1:0.634 | acc@2:0.581 | acc@3:0.548 | Best krc: 0.778 | Best epoch: 10
[2023-12-16 09:21:18] INFO (nni/MainThread) Intermediate result: 0.7741965090893818  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 17.53	mae: 13.73	mape: 92.0%	acc@10: 45.56%	acc@20: 77.19%	acc@30: 91.05%	
[2023-12-16 09:21:18] INFO (nni/MainThread) Intermediate result: 17.530267584500855  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.668 | ed:0.98 | hr@1:0.639 | hr@2:0.865 | hr@3:0.911 | acc@1:0.639 | acc@2:0.584 | acc@3:0.545 | Best krc: 0.778 | Best epoch: 10
[2023-12-16 09:21:42] INFO (nni/MainThread) Intermediate result: 0.7704195161912696  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 17.22	mae: 13.49	mape: 90.66%	acc@10: 46.32%	acc@20: 77.98%	acc@30: 91.48%	
[2023-12-16 09:21:42] INFO (nni/MainThread) Intermediate result: 17.2163924153745  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.643 | ed:0.959 | hr@1:0.642 | hr@2:0.867 | hr@3:0.915 | acc@1:0.642 | acc@2:0.584 | acc@3:0.55 | Best krc: 0.778 | Best epoch: 10
best model saved
[2023-12-16 09:22:06] INFO (nni/MainThread) Intermediate result: 0.7790492789530831  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 16.99	mae: 13.31	mape: 89.92%	acc@10: 47.09%	acc@20: 78.41%	acc@30: 91.85%	
[2023-12-16 09:22:06] INFO (nni/MainThread) Intermediate result: 16.986780141571572  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.646 | ed:0.947 | hr@1:0.641 | hr@2:0.866 | hr@3:0.914 | acc@1:0.641 | acc@2:0.588 | acc@3:0.553 | Best krc: 0.779 | Best epoch: 13
best model saved
[2023-12-16 09:22:31] INFO (nni/MainThread) Intermediate result: 0.7793576152911528  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 16.87	mae: 13.23	mape: 90.01%	acc@10: 47.04%	acc@20: 78.52%	acc@30: 92.05%	
[2023-12-16 09:22:31] INFO (nni/MainThread) Intermediate result: 16.866911719218177  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.656 | ed:0.966 | hr@1:0.637 | hr@2:0.865 | hr@3:0.912 | acc@1:0.637 | acc@2:0.582 | acc@3:0.545 | Best krc: 0.779 | Best epoch: 14
[2023-12-16 09:22:55] INFO (nni/MainThread) Intermediate result: 0.7736640434497888  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 16.65	mae: 13.05	mape: 88.7%	acc@10: 47.75%	acc@20: 79.0%	acc@30: 92.34%	
[2023-12-16 09:22:55] INFO (nni/MainThread) Intermediate result: 16.646486235109965  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.665 | ed:0.978 | hr@1:0.64 | hr@2:0.864 | hr@3:0.913 | acc@1:0.64 | acc@2:0.582 | acc@3:0.547 | Best krc: 0.779 | Best epoch: 14
[2023-12-16 09:23:19] INFO (nni/MainThread) Intermediate result: 0.7739904391063113  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 16.5	mae: 12.94	mape: 88.22%	acc@10: 48.17%	acc@20: 79.37%	acc@30: 92.51%	
[2023-12-16 09:23:19] INFO (nni/MainThread) Intermediate result: 16.504589299131293  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.654 | ed:0.983 | hr@1:0.636 | hr@2:0.87 | hr@3:0.912 | acc@1:0.636 | acc@2:0.582 | acc@3:0.541 | Best krc: 0.779 | Best epoch: 14
[2023-12-16 09:23:43] INFO (nni/MainThread) Intermediate result: 0.772750542142759  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 16.34	mae: 12.83	mape: 87.59%	acc@10: 48.6%	acc@20: 79.71%	acc@30: 92.74%	
[2023-12-16 09:23:43] INFO (nni/MainThread) Intermediate result: 16.343898925324385  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.656 | ed:0.966 | hr@1:0.645 | hr@2:0.865 | hr@3:0.913 | acc@1:0.645 | acc@2:0.587 | acc@3:0.55 | Best krc: 0.779 | Best epoch: 14
[2023-12-16 09:24:07] INFO (nni/MainThread) Intermediate result: 0.7745998259946664  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 16.18	mae: 12.7	mape: 86.78%	acc@10: 49.01%	acc@20: 80.04%	acc@30: 93.0%	
[2023-12-16 09:24:07] INFO (nni/MainThread) Intermediate result: 16.17898904531411  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.661 | ed:0.972 | hr@1:0.644 | hr@2:0.867 | hr@3:0.911 | acc@1:0.644 | acc@2:0.59 | acc@3:0.551 | Best krc: 0.779 | Best epoch: 14
[2023-12-16 09:24:31] INFO (nni/MainThread) Intermediate result: 0.773026204552221  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.04	mae: 12.58	mape: 85.92%	acc@10: 49.37%	acc@20: 80.33%	acc@30: 93.24%	
[2023-12-16 09:24:31] INFO (nni/MainThread) Intermediate result: 16.035323740481797  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.716 | ed:1.02 | hr@1:0.627 | hr@2:0.857 | hr@3:0.905 | acc@1:0.627 | acc@2:0.575 | acc@3:0.532 | Best krc: 0.779 | Best epoch: 14
[2023-12-16 09:24:56] INFO (nni/MainThread) Intermediate result: 0.7591756094073541  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 15.92	mae: 12.48	mape: 84.85%	acc@10: 49.81%	acc@20: 80.49%	acc@30: 93.39%	
[2023-12-16 09:24:56] INFO (nni/MainThread) Intermediate result: 15.921196442275683  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.651 | ed:0.962 | hr@1:0.64 | hr@2:0.866 | hr@3:0.913 | acc@1:0.64 | acc@2:0.586 | acc@3:0.55 | Best krc: 0.779 | Best epoch: 14
[2023-12-16 09:25:20] INFO (nni/MainThread) Intermediate result: 0.7751193734927885  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 15.84	mae: 12.42	mape: 84.51%	acc@10: 50.03%	acc@20: 80.64%	acc@30: 93.47%	
[2023-12-16 09:25:20] INFO (nni/MainThread) Intermediate result: 15.843343549038384  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.667 | ed:0.965 | hr@1:0.65 | hr@2:0.867 | hr@3:0.911 | acc@1:0.65 | acc@2:0.597 | acc@3:0.554 | Best krc: 0.779 | Best epoch: 14
[2023-12-16 09:25:43] INFO (nni/MainThread) Intermediate result: 0.7761864218794697  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 15.75	mae: 12.34	mape: 83.83%	acc@10: 50.34%	acc@20: 80.82%	acc@30: 93.56%	
[2023-12-16 09:25:43] INFO (nni/MainThread) Intermediate result: 15.754064941212006  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.673 | ed:0.989 | hr@1:0.641 | hr@2:0.863 | hr@3:0.909 | acc@1:0.641 | acc@2:0.585 | acc@3:0.541 | Best krc: 0.779 | Best epoch: 14
[2023-12-16 09:26:08] INFO (nni/MainThread) Intermediate result: 0.7689760643411715  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 15.66	mae: 12.25	mape: 82.95%	acc@10: 50.6%	acc@20: 81.08%	acc@30: 93.64%	
[2023-12-16 09:26:08] INFO (nni/MainThread) Intermediate result: 15.659209081535483  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.675 | ed:1.001 | hr@1:0.63 | hr@2:0.865 | hr@3:0.909 | acc@1:0.63 | acc@2:0.579 | acc@3:0.537 | Best krc: 0.779 | Best epoch: 14
[2023-12-16 09:26:33] INFO (nni/MainThread) Intermediate result: 0.7608739871442101  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 15.59	mae: 12.21	mape: 82.75%	acc@10: 50.79%	acc@20: 81.21%	acc@30: 93.75%	
[2023-12-16 09:26:33] INFO (nni/MainThread) Intermediate result: 15.59396366376902  (Index 49)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702714590.2520781702714590.2520924
best model loaded !!!
krc:0.77 | lsd:0.498 | ed:0.989 | hr@1:0.65 | hr@2:0.9 | hr@3:0.937 | acc@1:0.65 | acc@2:0.6 | acc@3:0.55 |

-------------------------------------------------------------
Best epoch for G2R:  14
Best epoch for ETPA:  24
graph2route_pd Evaluation in test: krc:0.77 | lsd:0.498 | ed:0.989 | hr@1:0.65 | hr@2:0.9 | hr@3:0.937 | acc@1:0.65 | acc@2:0.6 | acc@3:0.55 |
RankPETA Evaluation in test: rmse: 13.2	mae: 10.01	mape: 86.85%	acc@10: 59.92%	acc@20: 88.61%	acc@30: 96.2%	
