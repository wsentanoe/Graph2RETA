Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 10,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 2,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 2022,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gatv2',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.708 | ed:1.048 | hr@1:0.625 | hr@2:0.86 | hr@3:0.909 | acc@1:0.625 | acc@2:0.564 | acc@3:0.525 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-18 10:54:06] INFO (nni/MainThread) Intermediate result: 0.7585221819589987  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 26.17	mae: 20.55	mape: 65.74%	acc@10: 30.0%	acc@20: 57.78%	acc@30: 76.67%	
[2023-12-18 10:54:06] INFO (nni/MainThread) Intermediate result: 26.16634153257231  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.683 | ed:1.013 | hr@1:0.633 | hr@2:0.864 | hr@3:0.908 | acc@1:0.633 | acc@2:0.577 | acc@3:0.533 | Best krc: 0.759 | Best epoch: 0
best model saved
[2023-12-18 10:54:33] INFO (nni/MainThread) Intermediate result: 0.7666491454423242  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 25.87	mae: 19.64	mape: 101.72%	acc@10: 34.07%	acc@20: 61.11%	acc@30: 79.63%	
[2023-12-18 10:54:33] INFO (nni/MainThread) Intermediate result: 25.869725694744275  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.697 | ed:1.006 | hr@1:0.629 | hr@2:0.863 | hr@3:0.909 | acc@1:0.629 | acc@2:0.575 | acc@3:0.535 | Best krc: 0.767 | Best epoch: 1
[2023-12-18 10:54:59] INFO (nni/MainThread) Intermediate result: 0.7635416551901028  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 24.86	mae: 19.03	mape: 113.24%	acc@10: 34.07%	acc@20: 62.72%	acc@30: 81.23%	
[2023-12-18 10:54:59] INFO (nni/MainThread) Intermediate result: 24.861222541062766  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.676 | ed:1.019 | hr@1:0.63 | hr@2:0.868 | hr@3:0.908 | acc@1:0.63 | acc@2:0.57 | acc@3:0.528 | Best krc: 0.767 | Best epoch: 1
best model saved
[2023-12-18 10:55:26] INFO (nni/MainThread) Intermediate result: 0.7670988471600629  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 23.4	mae: 18.15	mape: 114.61%	acc@10: 35.0%	acc@20: 65.0%	acc@30: 83.06%	
[2023-12-18 10:55:26] INFO (nni/MainThread) Intermediate result: 23.395992195277998  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.668 | ed:0.961 | hr@1:0.639 | hr@2:0.865 | hr@3:0.911 | acc@1:0.639 | acc@2:0.584 | acc@3:0.545 | Best krc: 0.767 | Best epoch: 3
best model saved
[2023-12-18 10:55:53] INFO (nni/MainThread) Intermediate result: 0.7723030736935416  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 22.27	mae: 17.48	mape: 114.09%	acc@10: 35.33%	acc@20: 66.3%	acc@30: 84.67%	
[2023-12-18 10:55:53] INFO (nni/MainThread) Intermediate result: 22.2739045373726  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.658 | ed:0.98 | hr@1:0.635 | hr@2:0.865 | hr@3:0.907 | acc@1:0.635 | acc@2:0.579 | acc@3:0.544 | Best krc: 0.772 | Best epoch: 4
best model saved
[2023-12-18 10:56:20] INFO (nni/MainThread) Intermediate result: 0.7727791381398725  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 21.47	mae: 16.93	mape: 113.56%	acc@10: 36.23%	acc@20: 67.04%	acc@30: 85.74%	
[2023-12-18 10:56:20] INFO (nni/MainThread) Intermediate result: 21.470173304246714  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.761 | lsd:0.729 | ed:1.019 | hr@1:0.643 | hr@2:0.848 | hr@3:0.897 | acc@1:0.643 | acc@2:0.575 | acc@3:0.53 | Best krc: 0.773 | Best epoch: 5
[2023-12-18 10:56:46] INFO (nni/MainThread) Intermediate result: 0.7613532400327329  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 20.71	mae: 16.37	mape: 111.26%	acc@10: 37.51%	acc@20: 68.47%	acc@30: 86.88%	
[2023-12-18 10:56:46] INFO (nni/MainThread) Intermediate result: 20.712871564061306  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.689 | ed:0.999 | hr@1:0.647 | hr@2:0.858 | hr@3:0.907 | acc@1:0.647 | acc@2:0.586 | acc@3:0.542 | Best krc: 0.773 | Best epoch: 5
[2023-12-18 10:57:11] INFO (nni/MainThread) Intermediate result: 0.7700145348505645  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 20.07	mae: 15.9	mape: 109.08%	acc@10: 38.8%	acc@20: 69.77%	acc@30: 88.01%	
[2023-12-18 10:57:12] INFO (nni/MainThread) Intermediate result: 20.072847184443233  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.669 | ed:0.968 | hr@1:0.643 | hr@2:0.863 | hr@3:0.911 | acc@1:0.643 | acc@2:0.585 | acc@3:0.551 | Best krc: 0.773 | Best epoch: 5
best model saved
[2023-12-18 10:57:38] INFO (nni/MainThread) Intermediate result: 0.774660964551651  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 19.86	mae: 15.7	mape: 109.22%	acc@10: 39.38%	acc@20: 70.33%	acc@30: 88.15%	
[2023-12-18 10:57:38] INFO (nni/MainThread) Intermediate result: 19.855658249665705  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.657 | ed:0.963 | hr@1:0.648 | hr@2:0.861 | hr@3:0.908 | acc@1:0.648 | acc@2:0.589 | acc@3:0.553 | Best krc: 0.775 | Best epoch: 8
best model saved
[2023-12-18 10:58:05] INFO (nni/MainThread) Intermediate result: 0.7815516446823836  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 19.4	mae: 15.38	mape: 107.73%	acc@10: 40.04%	acc@20: 71.15%	acc@30: 89.04%	
[2023-12-18 10:58:05] INFO (nni/MainThread) Intermediate result: 19.404814850678726  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.702 | ed:1.0 | hr@1:0.649 | hr@2:0.863 | hr@3:0.906 | acc@1:0.649 | acc@2:0.582 | acc@3:0.539 | Best krc: 0.782 | Best epoch: 9
[2023-12-18 10:58:31] INFO (nni/MainThread) Intermediate result: 0.7761628903736468  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 18.99	mae: 15.04	mape: 105.77%	acc@10: 41.08%	acc@20: 72.19%	acc@30: 89.7%	
[2023-12-18 10:58:31] INFO (nni/MainThread) Intermediate result: 18.985513775639514  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.645 | ed:0.962 | hr@1:0.648 | hr@2:0.864 | hr@3:0.912 | acc@1:0.648 | acc@2:0.586 | acc@3:0.548 | Best krc: 0.782 | Best epoch: 9
[2023-12-18 10:58:57] INFO (nni/MainThread) Intermediate result: 0.7764648669764543  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 18.65	mae: 14.76	mape: 104.07%	acc@10: 41.98%	acc@20: 72.99%	acc@30: 90.25%	
[2023-12-18 10:58:57] INFO (nni/MainThread) Intermediate result: 18.648934045719322  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.786 | lsd:0.627 | ed:0.953 | hr@1:0.656 | hr@2:0.869 | hr@3:0.912 | acc@1:0.656 | acc@2:0.596 | acc@3:0.556 | Best krc: 0.782 | Best epoch: 9
best model saved
[2023-12-18 10:59:24] INFO (nni/MainThread) Intermediate result: 0.7857728758472093  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 18.32	mae: 14.51	mape: 102.47%	acc@10: 42.48%	acc@20: 73.99%	acc@30: 90.77%	
[2023-12-18 10:59:24] INFO (nni/MainThread) Intermediate result: 18.31594496138365  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.787 | lsd:0.626 | ed:0.943 | hr@1:0.655 | hr@2:0.868 | hr@3:0.914 | acc@1:0.655 | acc@2:0.597 | acc@3:0.558 | Best krc: 0.786 | Best epoch: 12
best model saved
[2023-12-18 10:59:52] INFO (nni/MainThread) Intermediate result: 0.7869691111492597  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 18.02	mae: 14.28	mape: 100.77%	acc@10: 43.17%	acc@20: 74.87%	acc@30: 91.14%	
[2023-12-18 10:59:52] INFO (nni/MainThread) Intermediate result: 18.022643166406006  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.671 | ed:0.993 | hr@1:0.644 | hr@2:0.866 | hr@3:0.91 | acc@1:0.644 | acc@2:0.586 | acc@3:0.545 | Best krc: 0.787 | Best epoch: 13
[2023-12-18 11:00:18] INFO (nni/MainThread) Intermediate result: 0.7755661721555906  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.8	mae: 14.11	mape: 99.52%	acc@10: 43.63%	acc@20: 75.36%	acc@30: 91.51%	
[2023-12-18 11:00:18] INFO (nni/MainThread) Intermediate result: 17.79816101132442  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.695 | ed:1.017 | hr@1:0.634 | hr@2:0.864 | hr@3:0.906 | acc@1:0.634 | acc@2:0.575 | acc@3:0.526 | Best krc: 0.787 | Best epoch: 13
[2023-12-18 11:00:44] INFO (nni/MainThread) Intermediate result: 0.7637026181320018  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 17.55	mae: 13.92	mape: 97.67%	acc@10: 44.33%	acc@20: 76.06%	acc@30: 91.81%	
[2023-12-18 11:00:44] INFO (nni/MainThread) Intermediate result: 17.551186211865872  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.743 | ed:1.008 | hr@1:0.636 | hr@2:0.857 | hr@3:0.904 | acc@1:0.636 | acc@2:0.58 | acc@3:0.532 | Best krc: 0.787 | Best epoch: 13
[2023-12-18 11:01:12] INFO (nni/MainThread) Intermediate result: 0.7617130412058264  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 17.35	mae: 13.75	mape: 96.01%	acc@10: 44.88%	acc@20: 76.6%	acc@30: 92.05%	
[2023-12-18 11:01:12] INFO (nni/MainThread) Intermediate result: 17.35138085215607  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.629 | ed:0.964 | hr@1:0.645 | hr@2:0.868 | hr@3:0.915 | acc@1:0.645 | acc@2:0.584 | acc@3:0.55 | Best krc: 0.787 | Best epoch: 13
[2023-12-18 11:01:38] INFO (nni/MainThread) Intermediate result: 0.7796662308686794  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 17.18	mae: 13.6	mape: 94.49%	acc@10: 45.49%	acc@20: 77.04%	acc@30: 92.22%	
[2023-12-18 11:01:38] INFO (nni/MainThread) Intermediate result: 17.183675109598056  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.646 | ed:0.955 | hr@1:0.65 | hr@2:0.868 | hr@3:0.912 | acc@1:0.65 | acc@2:0.593 | acc@3:0.552 | Best krc: 0.787 | Best epoch: 13
[2023-12-18 11:02:05] INFO (nni/MainThread) Intermediate result: 0.7790260370409038  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 17.01	mae: 13.46	mape: 93.18%	acc@10: 45.93%	acc@20: 77.49%	acc@30: 92.46%	
[2023-12-18 11:02:05] INFO (nni/MainThread) Intermediate result: 17.008301196563824  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.673 | ed:1.002 | hr@1:0.621 | hr@2:0.862 | hr@3:0.911 | acc@1:0.621 | acc@2:0.565 | acc@3:0.533 | Best krc: 0.787 | Best epoch: 13
[2023-12-18 11:02:31] INFO (nni/MainThread) Intermediate result: 0.7658491001298173  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 16.87	mae: 13.35	mape: 92.22%	acc@10: 46.3%	acc@20: 77.83%	acc@30: 92.59%	
[2023-12-18 11:02:31] INFO (nni/MainThread) Intermediate result: 16.872592754601722  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.659 | ed:0.975 | hr@1:0.633 | hr@2:0.865 | hr@3:0.913 | acc@1:0.633 | acc@2:0.575 | acc@3:0.545 | Best krc: 0.787 | Best epoch: 13
[2023-12-18 11:02:57] INFO (nni/MainThread) Intermediate result: 0.7716341188488106  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 16.73	mae: 13.23	mape: 90.99%	acc@10: 46.7%	acc@20: 78.2%	acc@30: 92.75%	
[2023-12-18 11:02:57] INFO (nni/MainThread) Intermediate result: 16.732591791260102  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.666 | ed:0.995 | hr@1:0.642 | hr@2:0.866 | hr@3:0.912 | acc@1:0.642 | acc@2:0.583 | acc@3:0.544 | Best krc: 0.787 | Best epoch: 13
[2023-12-18 11:03:24] INFO (nni/MainThread) Intermediate result: 0.7695669777436283  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.64	mae: 13.14	mape: 89.73%	acc@10: 47.14%	acc@20: 78.43%	acc@30: 92.85%	
[2023-12-18 11:03:24] INFO (nni/MainThread) Intermediate result: 16.63527802964599  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.64 | ed:0.96 | hr@1:0.652 | hr@2:0.866 | hr@3:0.912 | acc@1:0.652 | acc@2:0.593 | acc@3:0.557 | Best krc: 0.787 | Best epoch: 13
[2023-12-18 11:03:50] INFO (nni/MainThread) Intermediate result: 0.7799341849101358  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.53	mae: 13.05	mape: 88.75%	acc@10: 47.39%	acc@20: 78.78%	acc@30: 93.0%	
[2023-12-18 11:03:50] INFO (nni/MainThread) Intermediate result: 16.5277090385191  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.651 | ed:0.962 | hr@1:0.648 | hr@2:0.869 | hr@3:0.915 | acc@1:0.648 | acc@2:0.592 | acc@3:0.554 | Best krc: 0.787 | Best epoch: 13
[2023-12-18 11:04:17] INFO (nni/MainThread) Intermediate result: 0.7785627344525463  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 16.45	mae: 12.97	mape: 87.75%	acc@10: 47.69%	acc@20: 78.95%	acc@30: 93.1%	
[2023-12-18 11:04:17] INFO (nni/MainThread) Intermediate result: 16.44833802259233  (Index 47)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1702893219.1128641702893219.1128767
best model loaded !!!
krc:0.775 | lsd:0.475 | ed:0.98 | hr@1:0.663 | hr@2:0.904 | hr@3:0.938 | acc@1:0.663 | acc@2:0.609 | acc@3:0.56 |

-------------------------------------------------------------
Best epoch for G2R:  13
Best epoch for ETPA:  23
graph2route_pd Evaluation in test: krc:0.775 | lsd:0.475 | ed:0.98 | hr@1:0.663 | hr@2:0.904 | hr@3:0.938 | acc@1:0.663 | acc@2:0.609 | acc@3:0.56 |
RankPETA Evaluation in test: rmse: 11.92	mae: 9.3	mape: 70.04%	acc@10: 62.03%	acc@20: 92.41%	acc@30: 97.47%	
