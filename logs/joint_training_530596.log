Device:  cuda
{'alpha_loss': 0.5,
 'batch_size': 64,
 'dataset': 'food_pd',
 'datatype': 'order',
 'device': device(type='cuda'),
 'early_stop': 20,
 'edge_fea_dim': 5,
 'embedding_dim': 32,
 'eval_end_1': 11,
 'eval_end_2': 25,
 'eval_start': 1,
 'gcn_num_layers': 2,
 'hidden_size': 8,
 'is_eval': False,
 'is_test': False,
 'k_min_nodes': 3,
 'k_nearest_neighbors': 'n-1',
 'lr': 0.001,
 'max_task_num': 25,
 'min_task_num': 0,
 'modelArrivalTime': 'RankPETA',
 'modelRoute': 'graph2route_pd',
 'no_cuda': False,
 'node_fea_dim': 8,
 'node_features_test': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_test_full.npy',
 'node_features_train': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_train_full.npy',
 'node_features_val': '/home/sentanoe/joint_training/data/dataset/food_pd/node_features_val_full.npy',
 'num_block': 4,
 'num_epoch': 1000,
 'num_head': 2,
 'num_worker_logistics': 2346,
 'num_worker_pd': 920,
 'pad_value': 26,
 'seed': 8888,
 'sort_mode': 'pnn_idx',
 'spatial_encoder': 'gcn',
 'temporal_encoder': 'gru',
 'test_path': '/home/sentanoe/joint_training/data/dataset/food_pd/test_full.npy',
 'train_mode': 'sort',
 'train_path': '/home/sentanoe/joint_training/data/dataset/food_pd/train_full.npy',
 'val_path': '/home/sentanoe/joint_training/data/dataset/food_pd/val_full.npy',
 'wd': 1e-05,
 'worker_emb_dim': 10,
 'workers': 2}
last_x_size:13;unpick_x_size:12;input_size:53
#train:2521 | #val:1257 | #test:1261
*** Epoch: 0 ***
-----------------G2R RESULT-------------------

val result: krc:0.746 | lsd:0.753 | ed:1.054 | hr@1:0.629 | hr@2:0.845 | hr@3:0.897 | acc@1:0.629 | acc@2:0.56 | acc@3:0.516 | Best krc: -1 | Best epoch: -1
best model saved
[2023-12-01 01:41:18] INFO (nni/MainThread) Intermediate result: 0.7455492318981606  (Index 0)
-----------------ETPA RESULT-------------------
Epoch 0: Validation	rmse: 19.3	mae: 14.32	mape: 57.62%	acc@10: 46.3%	acc@20: 75.19%	acc@30: 88.15%	
[2023-12-01 01:41:18] INFO (nni/MainThread) Intermediate result: 19.300546841953402  (Index 1)
*** Epoch: 1 ***
-----------------G2R RESULT-------------------

val result: krc:0.754 | lsd:0.716 | ed:1.023 | hr@1:0.635 | hr@2:0.854 | hr@3:0.897 | acc@1:0.635 | acc@2:0.578 | acc@3:0.532 | Best krc: 0.746 | Best epoch: 0
best model saved
[2023-12-01 01:41:45] INFO (nni/MainThread) Intermediate result: 0.7540570207295173  (Index 2)
-----------------ETPA RESULT-------------------
Epoch 1: Validation	rmse: 20.76	mae: 15.43	mape: 86.74%	acc@10: 43.52%	acc@20: 74.07%	acc@30: 86.48%	
[2023-12-01 01:41:45] INFO (nni/MainThread) Intermediate result: 20.75522416513912  (Index 3)
*** Epoch: 2 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.709 | ed:0.99 | hr@1:0.641 | hr@2:0.858 | hr@3:0.907 | acc@1:0.641 | acc@2:0.584 | acc@3:0.547 | Best krc: 0.754 | Best epoch: 1
best model saved
[2023-12-01 01:42:11] INFO (nni/MainThread) Intermediate result: 0.7657986024404912  (Index 4)
-----------------ETPA RESULT-------------------
Epoch 2: Validation	rmse: 21.11	mae: 15.85	mape: 102.13%	acc@10: 42.72%	acc@20: 72.22%	acc@30: 85.68%	
[2023-12-01 01:42:11] INFO (nni/MainThread) Intermediate result: 21.109896262655273  (Index 5)
*** Epoch: 3 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.707 | ed:0.999 | hr@1:0.634 | hr@2:0.859 | hr@3:0.906 | acc@1:0.634 | acc@2:0.58 | acc@3:0.539 | Best krc: 0.766 | Best epoch: 2
[2023-12-01 01:42:36] INFO (nni/MainThread) Intermediate result: 0.7624297903265983  (Index 6)
-----------------ETPA RESULT-------------------
Epoch 3: Validation	rmse: 21.9	mae: 16.34	mape: 111.01%	acc@10: 42.69%	acc@20: 71.39%	acc@30: 84.26%	
[2023-12-01 01:42:36] INFO (nni/MainThread) Intermediate result: 21.901994060492306  (Index 7)
*** Epoch: 4 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.732 | ed:1.007 | hr@1:0.634 | hr@2:0.857 | hr@3:0.904 | acc@1:0.634 | acc@2:0.578 | acc@3:0.536 | Best krc: 0.766 | Best epoch: 2
[2023-12-01 01:43:01] INFO (nni/MainThread) Intermediate result: 0.7597215914662352  (Index 8)
-----------------ETPA RESULT-------------------
Epoch 4: Validation	rmse: 21.24	mae: 16.07	mape: 111.86%	acc@10: 42.3%	acc@20: 70.96%	acc@30: 85.41%	
[2023-12-01 01:43:01] INFO (nni/MainThread) Intermediate result: 21.242131354389272  (Index 9)
*** Epoch: 5 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.707 | ed:0.999 | hr@1:0.629 | hr@2:0.862 | hr@3:0.909 | acc@1:0.629 | acc@2:0.576 | acc@3:0.54 | Best krc: 0.766 | Best epoch: 2
[2023-12-01 01:43:26] INFO (nni/MainThread) Intermediate result: 0.7638482863231443  (Index 10)
-----------------ETPA RESULT-------------------
Epoch 5: Validation	rmse: 21.03	mae: 16.08	mape: 114.61%	acc@10: 41.67%	acc@20: 70.12%	acc@30: 85.56%	
[2023-12-01 01:43:26] INFO (nni/MainThread) Intermediate result: 21.025948721446692  (Index 11)
*** Epoch: 6 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.673 | ed:0.982 | hr@1:0.642 | hr@2:0.866 | hr@3:0.909 | acc@1:0.642 | acc@2:0.588 | acc@3:0.546 | Best krc: 0.766 | Best epoch: 2
best model saved
[2023-12-01 01:43:52] INFO (nni/MainThread) Intermediate result: 0.7687238677531637  (Index 12)
-----------------ETPA RESULT-------------------
Epoch 6: Validation	rmse: 20.61	mae: 15.87	mape: 114.74%	acc@10: 41.43%	acc@20: 69.95%	acc@30: 86.24%	
[2023-12-01 01:43:52] INFO (nni/MainThread) Intermediate result: 20.609245980462987  (Index 13)
*** Epoch: 7 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.668 | ed:0.977 | hr@1:0.641 | hr@2:0.865 | hr@3:0.91 | acc@1:0.641 | acc@2:0.586 | acc@3:0.55 | Best krc: 0.769 | Best epoch: 6
best model saved
[2023-12-01 01:44:18] INFO (nni/MainThread) Intermediate result: 0.7739774064216566  (Index 14)
-----------------ETPA RESULT-------------------
Epoch 7: Validation	rmse: 20.2	mae: 15.65	mape: 114.14%	acc@10: 41.39%	acc@20: 70.19%	acc@30: 87.04%	
[2023-12-01 01:44:18] INFO (nni/MainThread) Intermediate result: 20.203273922492592  (Index 15)
*** Epoch: 8 ***
-----------------G2R RESULT-------------------

val result: krc:0.754 | lsd:0.752 | ed:1.029 | hr@1:0.625 | hr@2:0.855 | hr@3:0.902 | acc@1:0.625 | acc@2:0.568 | acc@3:0.526 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:44:43] INFO (nni/MainThread) Intermediate result: 0.7544654263937167  (Index 16)
-----------------ETPA RESULT-------------------
Epoch 8: Validation	rmse: 19.78	mae: 15.39	mape: 112.79%	acc@10: 41.52%	acc@20: 70.58%	acc@30: 88.02%	
[2023-12-01 01:44:43] INFO (nni/MainThread) Intermediate result: 19.775812523722266  (Index 17)
*** Epoch: 9 ***
-----------------G2R RESULT-------------------

val result: krc:0.752 | lsd:0.734 | ed:1.052 | hr@1:0.622 | hr@2:0.854 | hr@3:0.901 | acc@1:0.622 | acc@2:0.564 | acc@3:0.522 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:45:08] INFO (nni/MainThread) Intermediate result: 0.7518858051695829  (Index 18)
-----------------ETPA RESULT-------------------
Epoch 9: Validation	rmse: 19.4	mae: 15.16	mape: 111.72%	acc@10: 41.78%	acc@20: 71.0%	acc@30: 88.93%	
[2023-12-01 01:45:08] INFO (nni/MainThread) Intermediate result: 19.400175204586898  (Index 19)
*** Epoch: 10 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.705 | ed:1.02 | hr@1:0.624 | hr@2:0.863 | hr@3:0.91 | acc@1:0.624 | acc@2:0.569 | acc@3:0.533 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:45:34] INFO (nni/MainThread) Intermediate result: 0.7595516562984861  (Index 20)
-----------------ETPA RESULT-------------------
Epoch 10: Validation	rmse: 19.02	mae: 14.88	mape: 109.67%	acc@10: 42.56%	acc@20: 71.78%	acc@30: 89.43%	
[2023-12-01 01:45:34] INFO (nni/MainThread) Intermediate result: 19.015726812023345  (Index 21)
*** Epoch: 11 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.693 | ed:0.993 | hr@1:0.635 | hr@2:0.861 | hr@3:0.907 | acc@1:0.635 | acc@2:0.581 | acc@3:0.543 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:46:00] INFO (nni/MainThread) Intermediate result: 0.7679621539612796  (Index 22)
-----------------ETPA RESULT-------------------
Epoch 11: Validation	rmse: 18.68	mae: 14.66	mape: 108.09%	acc@10: 42.87%	acc@20: 72.44%	acc@30: 89.97%	
[2023-12-01 01:46:00] INFO (nni/MainThread) Intermediate result: 18.678970114376263  (Index 23)
*** Epoch: 12 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.739 | ed:1.015 | hr@1:0.641 | hr@2:0.858 | hr@3:0.902 | acc@1:0.641 | acc@2:0.583 | acc@3:0.536 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:46:25] INFO (nni/MainThread) Intermediate result: 0.7617776794777231  (Index 24)
-----------------ETPA RESULT-------------------
Epoch 12: Validation	rmse: 18.41	mae: 14.48	mape: 107.09%	acc@10: 43.05%	acc@20: 72.93%	acc@30: 90.46%	
[2023-12-01 01:46:25] INFO (nni/MainThread) Intermediate result: 18.40846484394204  (Index 25)
*** Epoch: 13 ***
-----------------G2R RESULT-------------------

val result: krc:0.763 | lsd:0.709 | ed:1.009 | hr@1:0.634 | hr@2:0.862 | hr@3:0.907 | acc@1:0.634 | acc@2:0.578 | acc@3:0.538 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:46:51] INFO (nni/MainThread) Intermediate result: 0.7628939820806895  (Index 26)
-----------------ETPA RESULT-------------------
Epoch 13: Validation	rmse: 18.16	mae: 14.32	mape: 105.94%	acc@10: 43.25%	acc@20: 73.39%	acc@30: 90.95%	
[2023-12-01 01:46:51] INFO (nni/MainThread) Intermediate result: 18.15725746714539  (Index 27)
*** Epoch: 14 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.682 | ed:0.989 | hr@1:0.638 | hr@2:0.863 | hr@3:0.909 | acc@1:0.638 | acc@2:0.578 | acc@3:0.54 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:47:17] INFO (nni/MainThread) Intermediate result: 0.7728364323816882  (Index 28)
-----------------ETPA RESULT-------------------
Epoch 14: Validation	rmse: 17.87	mae: 14.1	mape: 103.57%	acc@10: 44.07%	acc@20: 74.25%	acc@30: 91.31%	
[2023-12-01 01:47:17] INFO (nni/MainThread) Intermediate result: 17.873127515692335  (Index 29)
*** Epoch: 15 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.691 | ed:0.994 | hr@1:0.641 | hr@2:0.861 | hr@3:0.907 | acc@1:0.641 | acc@2:0.585 | acc@3:0.541 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:47:42] INFO (nni/MainThread) Intermediate result: 0.7669547984283445  (Index 30)
-----------------ETPA RESULT-------------------
Epoch 15: Validation	rmse: 17.68	mae: 13.97	mape: 102.67%	acc@10: 44.35%	acc@20: 74.68%	acc@30: 91.64%	
[2023-12-01 01:47:42] INFO (nni/MainThread) Intermediate result: 17.68265640433873  (Index 31)
*** Epoch: 16 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.707 | ed:1.001 | hr@1:0.629 | hr@2:0.859 | hr@3:0.908 | acc@1:0.629 | acc@2:0.572 | acc@3:0.532 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:48:08] INFO (nni/MainThread) Intermediate result: 0.7637423458499104  (Index 32)
-----------------ETPA RESULT-------------------
Epoch 16: Validation	rmse: 17.51	mae: 13.84	mape: 101.72%	acc@10: 44.71%	acc@20: 75.1%	acc@30: 91.94%	
[2023-12-01 01:48:08] INFO (nni/MainThread) Intermediate result: 17.510267318798682  (Index 33)
*** Epoch: 17 ***
-----------------G2R RESULT-------------------

val result: krc:0.759 | lsd:0.753 | ed:1.028 | hr@1:0.634 | hr@2:0.85 | hr@3:0.9 | acc@1:0.634 | acc@2:0.571 | acc@3:0.531 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:48:34] INFO (nni/MainThread) Intermediate result: 0.7593547636835789  (Index 34)
-----------------ETPA RESULT-------------------
Epoch 17: Validation	rmse: 17.37	mae: 13.75	mape: 101.0%	acc@10: 44.9%	acc@20: 75.35%	acc@30: 92.18%	
[2023-12-01 01:48:34] INFO (nni/MainThread) Intermediate result: 17.365160313648293  (Index 35)
*** Epoch: 18 ***
-----------------G2R RESULT-------------------

val result: krc:0.762 | lsd:0.727 | ed:1.001 | hr@1:0.638 | hr@2:0.855 | hr@3:0.904 | acc@1:0.638 | acc@2:0.578 | acc@3:0.536 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:48:59] INFO (nni/MainThread) Intermediate result: 0.7619164216890496  (Index 36)
-----------------ETPA RESULT-------------------
Epoch 18: Validation	rmse: 17.31	mae: 13.72	mape: 101.09%	acc@10: 44.76%	acc@20: 75.36%	acc@30: 92.3%	
[2023-12-01 01:48:59] INFO (nni/MainThread) Intermediate result: 17.313653023812723  (Index 37)
*** Epoch: 19 ***
-----------------G2R RESULT-------------------

val result: krc:0.76 | lsd:0.705 | ed:1.016 | hr@1:0.631 | hr@2:0.859 | hr@3:0.906 | acc@1:0.631 | acc@2:0.573 | acc@3:0.532 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:49:25] INFO (nni/MainThread) Intermediate result: 0.7604837776678615  (Index 38)
-----------------ETPA RESULT-------------------
Epoch 19: Validation	rmse: 17.19	mae: 13.63	mape: 100.33%	acc@10: 45.11%	acc@20: 75.7%	acc@30: 92.5%	
[2023-12-01 01:49:25] INFO (nni/MainThread) Intermediate result: 17.19187568831312  (Index 39)
*** Epoch: 20 ***
-----------------G2R RESULT-------------------

val result: krc:0.766 | lsd:0.7 | ed:0.988 | hr@1:0.633 | hr@2:0.858 | hr@3:0.908 | acc@1:0.633 | acc@2:0.575 | acc@3:0.538 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:49:50] INFO (nni/MainThread) Intermediate result: 0.7655028189352632  (Index 40)
-----------------ETPA RESULT-------------------
Epoch 20: Validation	rmse: 17.05	mae: 13.53	mape: 99.35%	acc@10: 45.4%	acc@20: 76.17%	acc@30: 92.68%	
[2023-12-01 01:49:50] INFO (nni/MainThread) Intermediate result: 17.050653060662377  (Index 41)
*** Epoch: 21 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.672 | ed:0.958 | hr@1:0.644 | hr@2:0.862 | hr@3:0.908 | acc@1:0.644 | acc@2:0.586 | acc@3:0.55 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:50:16] INFO (nni/MainThread) Intermediate result: 0.7734208090570136  (Index 42)
-----------------ETPA RESULT-------------------
Epoch 21: Validation	rmse: 16.96	mae: 13.45	mape: 98.71%	acc@10: 45.72%	acc@20: 76.48%	acc@30: 92.73%	
[2023-12-01 01:50:16] INFO (nni/MainThread) Intermediate result: 16.96062510827981  (Index 43)
*** Epoch: 22 ***
-----------------G2R RESULT-------------------

val result: krc:0.774 | lsd:0.673 | ed:0.974 | hr@1:0.637 | hr@2:0.863 | hr@3:0.909 | acc@1:0.637 | acc@2:0.582 | acc@3:0.547 | Best krc: 0.774 | Best epoch: 7
[2023-12-01 01:50:41] INFO (nni/MainThread) Intermediate result: 0.7736067563264765  (Index 44)
-----------------ETPA RESULT-------------------
Epoch 22: Validation	rmse: 16.85	mae: 13.36	mape: 97.87%	acc@10: 46.07%	acc@20: 76.78%	acc@30: 92.88%	
[2023-12-01 01:50:41] INFO (nni/MainThread) Intermediate result: 16.847215477659475  (Index 45)
*** Epoch: 23 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.666 | ed:0.952 | hr@1:0.646 | hr@2:0.862 | hr@3:0.908 | acc@1:0.646 | acc@2:0.589 | acc@3:0.551 | Best krc: 0.774 | Best epoch: 7
best model saved
[2023-12-01 01:51:08] INFO (nni/MainThread) Intermediate result: 0.777297048770595  (Index 46)
-----------------ETPA RESULT-------------------
Epoch 23: Validation	rmse: 16.77	mae: 13.31	mape: 97.52%	acc@10: 46.17%	acc@20: 76.93%	acc@30: 93.06%	
[2023-12-01 01:51:08] INFO (nni/MainThread) Intermediate result: 16.773858732553762  (Index 47)
*** Epoch: 24 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.664 | ed:0.955 | hr@1:0.642 | hr@2:0.862 | hr@3:0.91 | acc@1:0.642 | acc@2:0.586 | acc@3:0.551 | Best krc: 0.777 | Best epoch: 23
best model saved
[2023-12-01 01:51:35] INFO (nni/MainThread) Intermediate result: 0.7777516124258582  (Index 48)
-----------------ETPA RESULT-------------------
Epoch 24: Validation	rmse: 16.7	mae: 13.25	mape: 97.01%	acc@10: 46.43%	acc@20: 77.11%	acc@30: 93.17%	
[2023-12-01 01:51:35] INFO (nni/MainThread) Intermediate result: 16.700519925165892  (Index 49)
*** Epoch: 25 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.653 | ed:0.948 | hr@1:0.645 | hr@2:0.864 | hr@3:0.912 | acc@1:0.645 | acc@2:0.587 | acc@3:0.551 | Best krc: 0.778 | Best epoch: 24
[2023-12-01 01:52:01] INFO (nni/MainThread) Intermediate result: 0.7753989358711704  (Index 50)
-----------------ETPA RESULT-------------------
Epoch 25: Validation	rmse: 16.68	mae: 13.25	mape: 97.06%	acc@10: 46.35%	acc@20: 77.11%	acc@30: 93.22%	
[2023-12-01 01:52:01] INFO (nni/MainThread) Intermediate result: 16.67602187316765  (Index 51)
*** Epoch: 26 ***
-----------------G2R RESULT-------------------

val result: krc:0.773 | lsd:0.677 | ed:0.961 | hr@1:0.64 | hr@2:0.862 | hr@3:0.91 | acc@1:0.64 | acc@2:0.585 | acc@3:0.55 | Best krc: 0.778 | Best epoch: 24
[2023-12-01 01:52:26] INFO (nni/MainThread) Intermediate result: 0.7733906139852794  (Index 52)
-----------------ETPA RESULT-------------------
Epoch 26: Validation	rmse: 16.63	mae: 13.21	mape: 96.85%	acc@10: 46.46%	acc@20: 77.24%	acc@30: 93.26%	
[2023-12-01 01:52:26] INFO (nni/MainThread) Intermediate result: 16.630956239560152  (Index 53)
*** Epoch: 27 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.688 | ed:0.974 | hr@1:0.638 | hr@2:0.864 | hr@3:0.909 | acc@1:0.638 | acc@2:0.585 | acc@3:0.548 | Best krc: 0.778 | Best epoch: 24
[2023-12-01 01:52:52] INFO (nni/MainThread) Intermediate result: 0.7689245684435889  (Index 54)
-----------------ETPA RESULT-------------------
Epoch 27: Validation	rmse: 16.62	mae: 13.21	mape: 96.87%	acc@10: 46.49%	acc@20: 77.26%	acc@30: 93.25%	
[2023-12-01 01:52:52] INFO (nni/MainThread) Intermediate result: 16.62191876905538  (Index 55)
*** Epoch: 28 ***
-----------------G2R RESULT-------------------

val result: krc:0.769 | lsd:0.686 | ed:0.981 | hr@1:0.634 | hr@2:0.86 | hr@3:0.913 | acc@1:0.634 | acc@2:0.576 | acc@3:0.542 | Best krc: 0.778 | Best epoch: 24
[2023-12-01 01:53:17] INFO (nni/MainThread) Intermediate result: 0.7688491326969682  (Index 56)
-----------------ETPA RESULT-------------------
Epoch 28: Validation	rmse: 16.59	mae: 13.19	mape: 96.79%	acc@10: 46.48%	acc@20: 77.33%	acc@30: 93.33%	
[2023-12-01 01:53:17] INFO (nni/MainThread) Intermediate result: 16.59192724811101  (Index 57)
*** Epoch: 29 ***
-----------------G2R RESULT-------------------

val result: krc:0.764 | lsd:0.697 | ed:1.001 | hr@1:0.635 | hr@2:0.858 | hr@3:0.906 | acc@1:0.635 | acc@2:0.574 | acc@3:0.534 | Best krc: 0.778 | Best epoch: 24
[2023-12-01 01:53:43] INFO (nni/MainThread) Intermediate result: 0.764169152844273  (Index 58)
-----------------ETPA RESULT-------------------
Epoch 29: Validation	rmse: 16.55	mae: 13.16	mape: 96.54%	acc@10: 46.56%	acc@20: 77.43%	acc@30: 93.46%	
[2023-12-01 01:53:43] INFO (nni/MainThread) Intermediate result: 16.54614524835593  (Index 59)
*** Epoch: 30 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.685 | ed:0.965 | hr@1:0.638 | hr@2:0.867 | hr@3:0.909 | acc@1:0.638 | acc@2:0.587 | acc@3:0.548 | Best krc: 0.778 | Best epoch: 24
[2023-12-01 01:54:10] INFO (nni/MainThread) Intermediate result: 0.7723229741157157  (Index 60)
-----------------ETPA RESULT-------------------
Epoch 30: Validation	rmse: 16.46	mae: 13.09	mape: 95.78%	acc@10: 46.81%	acc@20: 77.75%	acc@30: 93.54%	
[2023-12-01 01:54:10] INFO (nni/MainThread) Intermediate result: 16.462315128766427  (Index 61)
*** Epoch: 31 ***
-----------------G2R RESULT-------------------

val result: krc:0.767 | lsd:0.673 | ed:0.994 | hr@1:0.634 | hr@2:0.862 | hr@3:0.908 | acc@1:0.634 | acc@2:0.575 | acc@3:0.536 | Best krc: 0.778 | Best epoch: 24
[2023-12-01 01:54:36] INFO (nni/MainThread) Intermediate result: 0.7667223081215211  (Index 62)
-----------------ETPA RESULT-------------------
Epoch 31: Validation	rmse: 16.43	mae: 13.07	mape: 95.7%	acc@10: 46.76%	acc@20: 77.77%	acc@30: 93.61%	
[2023-12-01 01:54:36] INFO (nni/MainThread) Intermediate result: 16.432308933785357  (Index 63)
*** Epoch: 32 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.652 | ed:0.969 | hr@1:0.633 | hr@2:0.867 | hr@3:0.916 | acc@1:0.633 | acc@2:0.58 | acc@3:0.546 | Best krc: 0.778 | Best epoch: 24
[2023-12-01 01:55:03] INFO (nni/MainThread) Intermediate result: 0.7754622992838998  (Index 64)
-----------------ETPA RESULT-------------------
Epoch 32: Validation	rmse: 16.36	mae: 13.01	mape: 94.87%	acc@10: 47.05%	acc@20: 77.98%	acc@30: 93.68%	
[2023-12-01 01:55:03] INFO (nni/MainThread) Intermediate result: 16.361230977747887  (Index 65)
*** Epoch: 33 ***
-----------------G2R RESULT-------------------

val result: krc:0.783 | lsd:0.633 | ed:0.942 | hr@1:0.651 | hr@2:0.871 | hr@3:0.914 | acc@1:0.651 | acc@2:0.597 | acc@3:0.558 | Best krc: 0.778 | Best epoch: 24
best model saved
[2023-12-01 01:55:30] INFO (nni/MainThread) Intermediate result: 0.7830912613597353  (Index 66)
-----------------ETPA RESULT-------------------
Epoch 33: Validation	rmse: 16.31	mae: 12.97	mape: 94.56%	acc@10: 47.18%	acc@20: 78.14%	acc@30: 93.78%	
[2023-12-01 01:55:30] INFO (nni/MainThread) Intermediate result: 16.30889124825785  (Index 67)
*** Epoch: 34 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.64 | ed:0.934 | hr@1:0.648 | hr@2:0.869 | hr@3:0.913 | acc@1:0.648 | acc@2:0.594 | acc@3:0.559 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 01:55:57] INFO (nni/MainThread) Intermediate result: 0.7824347930163408  (Index 68)
-----------------ETPA RESULT-------------------
Epoch 34: Validation	rmse: 16.25	mae: 12.93	mape: 94.16%	acc@10: 47.38%	acc@20: 78.26%	acc@30: 93.86%	
[2023-12-01 01:55:57] INFO (nni/MainThread) Intermediate result: 16.253123893221876  (Index 69)
*** Epoch: 35 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.667 | ed:0.961 | hr@1:0.641 | hr@2:0.868 | hr@3:0.911 | acc@1:0.641 | acc@2:0.586 | acc@3:0.55 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 01:56:23] INFO (nni/MainThread) Intermediate result: 0.7755261622861097  (Index 70)
-----------------ETPA RESULT-------------------
Epoch 35: Validation	rmse: 16.24	mae: 12.94	mape: 94.27%	acc@10: 47.27%	acc@20: 78.25%	acc@30: 93.9%	
[2023-12-01 01:56:23] INFO (nni/MainThread) Intermediate result: 16.24252257370461  (Index 71)
*** Epoch: 36 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.666 | ed:0.966 | hr@1:0.643 | hr@2:0.867 | hr@3:0.912 | acc@1:0.643 | acc@2:0.585 | acc@3:0.552 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 01:56:50] INFO (nni/MainThread) Intermediate result: 0.7749220673575725  (Index 72)
-----------------ETPA RESULT-------------------
Epoch 36: Validation	rmse: 16.2	mae: 12.91	mape: 93.99%	acc@10: 47.37%	acc@20: 78.4%	acc@30: 93.99%	
[2023-12-01 01:56:50] INFO (nni/MainThread) Intermediate result: 16.1954000216891  (Index 73)
*** Epoch: 37 ***
-----------------G2R RESULT-------------------

val result: krc:0.775 | lsd:0.669 | ed:0.975 | hr@1:0.642 | hr@2:0.866 | hr@3:0.911 | acc@1:0.642 | acc@2:0.585 | acc@3:0.55 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 01:57:17] INFO (nni/MainThread) Intermediate result: 0.7750408612586138  (Index 74)
-----------------ETPA RESULT-------------------
Epoch 37: Validation	rmse: 16.17	mae: 12.89	mape: 93.88%	acc@10: 47.34%	acc@20: 78.46%	acc@30: 94.07%	
[2023-12-01 01:57:17] INFO (nni/MainThread) Intermediate result: 16.165370708643113  (Index 75)
*** Epoch: 38 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.7 | ed:0.993 | hr@1:0.634 | hr@2:0.866 | hr@3:0.911 | acc@1:0.634 | acc@2:0.578 | acc@3:0.54 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 01:57:44] INFO (nni/MainThread) Intermediate result: 0.7703263317517799  (Index 76)
-----------------ETPA RESULT-------------------
Epoch 38: Validation	rmse: 16.13	mae: 12.87	mape: 93.79%	acc@10: 47.36%	acc@20: 78.49%	acc@30: 94.14%	
[2023-12-01 01:57:44] INFO (nni/MainThread) Intermediate result: 16.132016649542532  (Index 77)
*** Epoch: 39 ***
-----------------G2R RESULT-------------------

val result: krc:0.776 | lsd:0.657 | ed:0.968 | hr@1:0.642 | hr@2:0.868 | hr@3:0.914 | acc@1:0.642 | acc@2:0.588 | acc@3:0.553 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 01:58:10] INFO (nni/MainThread) Intermediate result: 0.7755151104866891  (Index 78)
-----------------ETPA RESULT-------------------
Epoch 39: Validation	rmse: 16.1	mae: 12.85	mape: 93.62%	acc@10: 47.43%	acc@20: 78.53%	acc@30: 94.18%	
[2023-12-01 01:58:10] INFO (nni/MainThread) Intermediate result: 16.102375602969957  (Index 79)
*** Epoch: 40 ***
-----------------G2R RESULT-------------------

val result: krc:0.768 | lsd:0.671 | ed:0.971 | hr@1:0.637 | hr@2:0.864 | hr@3:0.913 | acc@1:0.637 | acc@2:0.582 | acc@3:0.547 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 01:58:37] INFO (nni/MainThread) Intermediate result: 0.7681975376159897  (Index 80)
-----------------ETPA RESULT-------------------
Epoch 40: Validation	rmse: 16.09	mae: 12.85	mape: 93.7%	acc@10: 47.4%	acc@20: 78.5%	acc@30: 94.2%	
[2023-12-01 01:58:37] INFO (nni/MainThread) Intermediate result: 16.092126693436956  (Index 81)
*** Epoch: 41 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.634 | ed:0.933 | hr@1:0.649 | hr@2:0.87 | hr@3:0.915 | acc@1:0.649 | acc@2:0.596 | acc@3:0.561 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 01:59:05] INFO (nni/MainThread) Intermediate result: 0.7823695868820486  (Index 82)
-----------------ETPA RESULT-------------------
Epoch 41: Validation	rmse: 16.04	mae: 12.81	mape: 93.29%	acc@10: 47.62%	acc@20: 78.65%	acc@30: 94.26%	
[2023-12-01 01:59:05] INFO (nni/MainThread) Intermediate result: 16.03766107899277  (Index 83)
*** Epoch: 42 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.652 | ed:0.949 | hr@1:0.647 | hr@2:0.867 | hr@3:0.914 | acc@1:0.647 | acc@2:0.591 | acc@3:0.557 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 01:59:32] INFO (nni/MainThread) Intermediate result: 0.780214692108002  (Index 84)
-----------------ETPA RESULT-------------------
Epoch 42: Validation	rmse: 16.02	mae: 12.8	mape: 93.25%	acc@10: 47.59%	acc@20: 78.68%	acc@30: 94.32%	
[2023-12-01 01:59:32] INFO (nni/MainThread) Intermediate result: 16.01696731175651  (Index 85)
*** Epoch: 43 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.653 | ed:0.964 | hr@1:0.64 | hr@2:0.866 | hr@3:0.917 | acc@1:0.64 | acc@2:0.583 | acc@3:0.549 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 01:59:58] INFO (nni/MainThread) Intermediate result: 0.7782642362091423  (Index 86)
-----------------ETPA RESULT-------------------
Epoch 43: Validation	rmse: 15.99	mae: 12.78	mape: 92.93%	acc@10: 47.68%	acc@20: 78.81%	acc@30: 94.36%	
[2023-12-01 01:59:58] INFO (nni/MainThread) Intermediate result: 15.987749095182169  (Index 87)
*** Epoch: 44 ***
-----------------G2R RESULT-------------------

val result: krc:0.777 | lsd:0.647 | ed:0.966 | hr@1:0.639 | hr@2:0.87 | hr@3:0.914 | acc@1:0.639 | acc@2:0.586 | acc@3:0.553 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 02:00:25] INFO (nni/MainThread) Intermediate result: 0.7768180181735057  (Index 88)
-----------------ETPA RESULT-------------------
Epoch 44: Validation	rmse: 15.95	mae: 12.75	mape: 92.7%	acc@10: 47.74%	acc@20: 78.91%	acc@30: 94.41%	
[2023-12-01 02:00:25] INFO (nni/MainThread) Intermediate result: 15.951970359535062  (Index 89)
*** Epoch: 45 ***
-----------------G2R RESULT-------------------

val result: krc:0.77 | lsd:0.661 | ed:0.978 | hr@1:0.637 | hr@2:0.866 | hr@3:0.914 | acc@1:0.637 | acc@2:0.579 | acc@3:0.544 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 02:00:52] INFO (nni/MainThread) Intermediate result: 0.769630681873795  (Index 90)
-----------------ETPA RESULT-------------------
Epoch 45: Validation	rmse: 15.91	mae: 12.73	mape: 92.46%	acc@10: 47.79%	acc@20: 78.98%	acc@30: 94.49%	
[2023-12-01 02:00:52] INFO (nni/MainThread) Intermediate result: 15.91381905238395  (Index 91)
*** Epoch: 46 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.638 | ed:0.929 | hr@1:0.654 | hr@2:0.867 | hr@3:0.915 | acc@1:0.654 | acc@2:0.597 | acc@3:0.566 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 02:01:19] INFO (nni/MainThread) Intermediate result: 0.7819423818986566  (Index 92)
-----------------ETPA RESULT-------------------
Epoch 46: Validation	rmse: 15.87	mae: 12.7	mape: 92.16%	acc@10: 47.93%	acc@20: 79.13%	acc@30: 94.56%	
[2023-12-01 02:01:19] INFO (nni/MainThread) Intermediate result: 15.871775487609945  (Index 93)
*** Epoch: 47 ***
-----------------G2R RESULT-------------------

val result: krc:0.779 | lsd:0.649 | ed:0.953 | hr@1:0.648 | hr@2:0.868 | hr@3:0.912 | acc@1:0.648 | acc@2:0.592 | acc@3:0.556 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 02:01:46] INFO (nni/MainThread) Intermediate result: 0.7791787007790505  (Index 94)
-----------------ETPA RESULT-------------------
Epoch 47: Validation	rmse: 15.84	mae: 12.68	mape: 91.96%	acc@10: 48.05%	acc@20: 79.21%	acc@30: 94.61%	
[2023-12-01 02:01:46] INFO (nni/MainThread) Intermediate result: 15.842632441706098  (Index 95)
*** Epoch: 48 ***
-----------------G2R RESULT-------------------

val result: krc:0.772 | lsd:0.657 | ed:0.991 | hr@1:0.645 | hr@2:0.868 | hr@3:0.912 | acc@1:0.645 | acc@2:0.584 | acc@3:0.546 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 02:02:13] INFO (nni/MainThread) Intermediate result: 0.7721357710776163  (Index 96)
-----------------ETPA RESULT-------------------
Epoch 48: Validation	rmse: 15.85	mae: 12.69	mape: 92.14%	acc@10: 47.92%	acc@20: 79.15%	acc@30: 94.63%	
[2023-12-01 02:02:13] INFO (nni/MainThread) Intermediate result: 15.848794075866417  (Index 97)
*** Epoch: 49 ***
-----------------G2R RESULT-------------------

val result: krc:0.771 | lsd:0.672 | ed:0.969 | hr@1:0.642 | hr@2:0.868 | hr@3:0.911 | acc@1:0.642 | acc@2:0.592 | acc@3:0.556 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 02:02:40] INFO (nni/MainThread) Intermediate result: 0.7711350406059633  (Index 98)
-----------------ETPA RESULT-------------------
Epoch 49: Validation	rmse: 15.83	mae: 12.68	mape: 92.07%	acc@10: 47.92%	acc@20: 79.2%	acc@30: 94.67%	
[2023-12-01 02:02:40] INFO (nni/MainThread) Intermediate result: 15.82926350387372  (Index 99)
*** Epoch: 50 ***
-----------------G2R RESULT-------------------

val result: krc:0.78 | lsd:0.648 | ed:0.952 | hr@1:0.649 | hr@2:0.865 | hr@3:0.913 | acc@1:0.649 | acc@2:0.593 | acc@3:0.559 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 02:03:07] INFO (nni/MainThread) Intermediate result: 0.7797393476011754  (Index 100)
-----------------ETPA RESULT-------------------
Epoch 50: Validation	rmse: 15.79	mae: 12.64	mape: 91.7%	acc@10: 48.03%	acc@20: 79.32%	acc@30: 94.71%	
[2023-12-01 02:03:07] INFO (nni/MainThread) Intermediate result: 15.786859847430541  (Index 101)
*** Epoch: 51 ***
-----------------G2R RESULT-------------------

val result: krc:0.783 | lsd:0.648 | ed:0.943 | hr@1:0.649 | hr@2:0.871 | hr@3:0.915 | acc@1:0.649 | acc@2:0.596 | acc@3:0.563 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 02:03:35] INFO (nni/MainThread) Intermediate result: 0.7830793627820299  (Index 102)
-----------------ETPA RESULT-------------------
Epoch 51: Validation	rmse: 15.78	mae: 12.64	mape: 91.64%	acc@10: 48.06%	acc@20: 79.34%	acc@30: 94.72%	
[2023-12-01 02:03:35] INFO (nni/MainThread) Intermediate result: 15.77656476955323  (Index 103)
*** Epoch: 52 ***
-----------------G2R RESULT-------------------

val result: krc:0.778 | lsd:0.65 | ed:0.965 | hr@1:0.644 | hr@2:0.867 | hr@3:0.915 | acc@1:0.644 | acc@2:0.588 | acc@3:0.555 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 02:04:02] INFO (nni/MainThread) Intermediate result: 0.7782650228037197  (Index 104)
-----------------ETPA RESULT-------------------
Epoch 52: Validation	rmse: 15.75	mae: 12.62	mape: 91.51%	acc@10: 48.11%	acc@20: 79.41%	acc@30: 94.78%	
[2023-12-01 02:04:02] INFO (nni/MainThread) Intermediate result: 15.746858830797981  (Index 105)
*** Epoch: 53 ***
-----------------G2R RESULT-------------------

val result: krc:0.782 | lsd:0.643 | ed:0.948 | hr@1:0.651 | hr@2:0.868 | hr@3:0.916 | acc@1:0.651 | acc@2:0.591 | acc@3:0.56 | Best krc: 0.783 | Best epoch: 33
[2023-12-01 02:04:30] INFO (nni/MainThread) Intermediate result: 0.7818727674696191  (Index 106)
-----------------ETPA RESULT-------------------
Epoch 53: Validation	rmse: 15.75	mae: 12.62	mape: 91.59%	acc@10: 48.09%	acc@20: 79.4%	acc@30: 94.75%	
[2023-12-01 02:04:30] INFO (nni/MainThread) Intermediate result: 15.748612561481233  (Index 107)
loaded model path: /home/sentanoe/joint_training/data/dataset/food_pd/sort_model/hidden_size-8.gcnru-pd_1701391252.65284821701391252.6528628
best model loaded !!!
krc:0.775 | lsd:0.493 | ed:0.979 | hr@1:0.658 | hr@2:0.904 | hr@3:0.937 | acc@1:0.658 | acc@2:0.605 | acc@3:0.555 |

-------------------------------------------------------------
Best epoch for G2R:  33
Best epoch for ETPA:  52
graph2route_pd Evaluation in test: krc:0.775 | lsd:0.493 | ed:0.979 | hr@1:0.658 | hr@2:0.904 | hr@3:0.937 | acc@1:0.658 | acc@2:0.605 | acc@3:0.555 |
RankPETA Evaluation in test: rmse: 19.77	mae: 16.02	mape: 143.48%	acc@10: 35.44%	acc@20: 64.56%	acc@30: 89.03%	
